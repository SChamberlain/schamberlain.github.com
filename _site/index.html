<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <title>
    
    Recology, R/etc.
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">

  <link rel="stylesheet" href="/public/css/bootstrap/css/bootstrap.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon.ico">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0f layout-reverse">

    <header class="masthead">
      <div class="masthead-inner">
        <h1>Recology</h1>
        <!-- <h1> <a href="http://recology.info/">Recology</a></h1> -->
        <p class="lead">R/etc.</p>

        <div class="colophon">
          <ul class="colophon-links">
            <li>
              <a href="/"><i class="fa fa-home fa-lg"></i></a>&nbsp;
              <a href="/about"><i class="fa fa-info-circle fa-lg"></i></a>&nbsp;
              <a href="/archives"><i class="fa fa-archive fa-lg"></i></a>&nbsp;
              <a href="/rresources"><i class="fa fa-book fa-lg"></i></a>&nbsp;
              <a href="http://rforcats.net/" rel><i class="fa fa-graduation-cap fa-lg"></i></a>&nbsp;
              <a href="/feed.xml"><i class="fa fa-rss fa-lg"></i></a>&nbsp;
              <a href="https://twitter.com/sckottie"><i class="fa fa-twitter fa-lg"></i></a>&nbsp;
              <a href="/fork"><i class="fa fa-spinner fa-lg"></i></a>
            </li>
          </ul>
          <!-- <small><a href="https://github.com/mdo/hyde">Hyde</a> from <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</small> -->
        </div>
      </div>
    </header>

    <div class="content container">
      <div class="posts">
  <a style="float:right;" href="/archives" data-toggle="tooltip" data-placement="bottom" title="Archives"><i class="fa fa-archive fa-lg"></i></a>
  <a style="float:right;" href="/tags"><i class="fa fa-tags fa-lg"></i></a>&nbsp;
  
  <div class="post">
    <h1>
      <a href="/2016/01/request-hello-world/">
        request - a high level HTTP client for R
      </a>
    </h1>

    <span class="post-date">05 Jan 2016</span>

    <p><code>request</code> is DSL for http requests for R, and is inspired by the CLI tool <a href="https://github.com/jakubroztocil/httpie">httpie</a>. It&#39;s built on <code>httr</code>.</p>

<p>The following were driving principles for this package:</p>

<ul>
<li>The web is increasingly a JSON world, so we assume <code>applications/json</code> by default, but give back other types if not</li>
<li>The workflow follows logically, or at least should, from, <em>hey, I got this url</em>, to <em>i need to add some options</em>, to <em>execute request</em> - and functions support piping so that you can execute functions in this order</li>
<li>Whenever possible, we transform output to data.frame&#39;s - facilitating downstream manipulation via <code>dplyr</code>, etc.</li>
<li>We do <code>GET</code> requests by default. Specify a different type if you don&#39;t want <code>GET</code>. Given <code>GET</code> by default, this client is optimized for consumption of data, rather than creating new things on servers</li>
<li>You can use non-standard evaluation to easily pass in query parameters without worrying about <code>&amp;</code>&#39;s, URL escaping, etc. (see <code>api_query()</code>)</li>
<li>Same for body params (see <code>api_body()</code>)</li>
</ul>

<p>The following is a brief demo of some of the package functionality:</p>

<h2>Install</h2>

<p>From CRAN</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">install.packages<span class="p">(</span><span class="s">&quot;request&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Or from GitHub</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">devtools<span class="o">::</span>install_github<span class="p">(</span><span class="s">&quot;sckott/request&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">&quot;request&quot;</span><span class="p">)</span>
</code></pre></div>
<h2>Execute on last pipe</h2>

<p>When using pipes (<code>%&gt;%</code>) in <code>request</code>, we autodetect last piped command, and execute <code>http()</code> if it&#39;s the last. If not the last, the output gets passed to the next command, and so on. This feature (and <code>magrittr</code>) were done by Stefan Milton Bache.</p>

<p>This feature is really nice because a) it&#39;s one less thing you need to do, and b) you only need to care about the request itself.</p>

<p>You can escape auto-execution if you use the function <code>peep()</code>, which prints out a summary of the request you&#39;ve created, but does not execute an HTTP request.</p>

<h2>HTTP Requests</h2>

<p>A high level function <code>http()</code> wraps a lower level <code>R6</code> object <code>RequestIterator</code>, which holds a series of variables and functions to execute <code>GET</code> and <code>POST</code> requests, and will hold other HTTP verbs as well. In addition, it can hold state, which will allow us to do paging internally for you (see below). You have direct access to the <code>R6</code> object if you call <code>http_client()</code> instead of <code>http()</code>.</p>

<h2>NSE and SE</h2>

<p>Most if not all functions in <code>request</code> support non-standard evaluation (NSE) as well as standard evaluation (SE). If a function supports both, there&#39;s a version without an underscore for NSE, while a version with an underscore is for SE. For example, here, we make a HTTP request by passing a base URL, then a series of paths that get combined together. First the NSE version</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_path<span class="p">(</span>repos<span class="p">,</span> ropensci<span class="p">,</span> rgbif<span class="p">,</span> issues<span class="p">)</span>
</code></pre></div>
<p>Then the SE version</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_path_<span class="p">(</span><span class="s">&#39;repos&#39;</span><span class="p">,</span> <span class="s">&#39;ropensci&#39;</span><span class="p">,</span> <span class="s">&#39;rgbif&#39;</span><span class="p">,</span> <span class="s">&#39;issues&#39;</span><span class="p">)</span>
</code></pre></div>
<h2>Building API routes</h2>

<p>The first thing you&#39;ll want to do is lay out the base URL for your request. The function <code>api()</code> is your friend.</p>

<p><code>api()</code> works with full or partial URLs:</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: https://api.github.com/</span>
api<span class="p">(</span><span class="s">&#39;http://api.gbif.org/v1&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://api.gbif.org/v1</span>
api<span class="p">(</span><span class="s">&#39;api.gbif.org/v1&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: api.gbif.org/v1</span>
</code></pre></div>
<p>And works with ports, full or partial</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;http://localhost:9200&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://localhost:9200</span>
api<span class="p">(</span><span class="s">&#39;localhost:9200&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://localhost:9200</span>
api<span class="p">(</span><span class="s">&#39;:9200&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://localhost:9200</span>
api<span class="p">(</span><span class="s">&#39;9200&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://localhost:9200</span>
api<span class="p">(</span><span class="s">&#39;9200/stuff&#39;</span><span class="p">)</span>
<span class="c1">#&gt; URL: http://localhost:9200/stuff</span>
</code></pre></div>
<h2>Make HTTP requests</h2>

<p>The above examples with <code>api()</code> are not passed through a pipe, so only define a URL, but don&#39;t do an HTTP request. To make an HTTP request, you can either pipe a url or partial url to e.g., <code>api()</code>, or call <code>http()</code> at the end of a string of function calls:</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="s">&#39;https://api.github.com/&#39;</span> <span class="o">%&gt;%</span> api<span class="p">()</span>
<span class="c1">#&gt; $current_user_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/user&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $current_user_authorizations_html_url</span>
<span class="c1">#&gt; [1] &quot;https://github.com/settings/connections/applications{/client_id}&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $authorizations_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/authorizations&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $code_search_url</span>
<span class="kc">...</span>
</code></pre></div>
<p>Or</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span> http<span class="p">()</span>
<span class="c1">#&gt; $current_user_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/user&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $current_user_authorizations_html_url</span>
<span class="c1">#&gt; [1] &quot;https://github.com/settings/connections/applications{/client_id}&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $authorizations_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/authorizations&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $code_search_url</span>
<span class="kc">...</span>
</code></pre></div>
<p><code>http()</code> is called at the end of a chain of piped commands, so no need to invoke it. However, you can if you like.</p>

<h2>Templating</h2>
<div class="highlight"><pre><code class="language-r" data-lang="r">repo_info <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>username <span class="o">=</span> <span class="s">&#39;craigcitro&#39;</span><span class="p">,</span> repo <span class="o">=</span> <span class="s">&#39;r-travis&#39;</span><span class="p">)</span>
api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_template<span class="p">(</span>template <span class="o">=</span> <span class="s">&#39;repos///issues&#39;</span><span class="p">,</span> data <span class="o">=</span> repo_info<span class="p">)</span>
<span class="c1">#&gt; [[1]]</span>
<span class="c1">#&gt; [[1]]$url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/repos/craigcitro/r-travis/issues/164&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[1]]$labels_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/repos/craigcitro/r-travis/issues/164/labels{/name}&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[1]]$comments_url</span>
<span class="c1">#&gt; [1] &quot;https://api.github.com/repos/craigcitro/r-travis/issues/164/comments&quot;</span>
<span class="c1">#&gt; ...</span>
</code></pre></div>
<h2>Set paths</h2>

<p><code>api_path()</code> adds paths to the base URL</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;https://api.github.com/&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_path<span class="p">(</span>repos<span class="p">,</span> ropensci<span class="p">,</span> rgbif<span class="p">,</span> issues<span class="p">)</span> <span class="o">%&gt;%</span>
  peep
<span class="c1">#&gt; &lt;http request&gt; </span>
<span class="c1">#&gt;   url: https://api.github.com/</span>
<span class="c1">#&gt;   paths: repos/ropensci/rgbif/issues</span>
<span class="c1">#&gt;   query: </span>
<span class="c1">#&gt;   body: </span>
<span class="c1">#&gt;   paging: </span>
<span class="c1">#&gt;   headers: </span>
<span class="c1">#&gt;   rate limit: </span>
<span class="c1">#&gt;   retry (n/delay (s)): /</span>
<span class="c1">#&gt;   error handler: </span>
<span class="c1">#&gt;   config:</span>
</code></pre></div>
<h2>Query</h2>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&quot;http://api.plos.org/search&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_query<span class="p">(</span>q <span class="o">=</span> ecology<span class="p">,</span> wt <span class="o">=</span> json<span class="p">,</span> fl <span class="o">=</span> journal<span class="p">)</span> <span class="o">%&gt;%</span>
  peep
<span class="c1">#&gt; &lt;http request&gt; </span>
<span class="c1">#&gt;   url: http://api.plos.org/search</span>
<span class="c1">#&gt;   paths: </span>
<span class="c1">#&gt;   query: q=ecology, wt=json, fl=journal</span>
<span class="c1">#&gt;   body: </span>
<span class="c1">#&gt;   paging: </span>
<span class="c1">#&gt;   headers: </span>
<span class="c1">#&gt;   rate limit: </span>
<span class="c1">#&gt;   retry (n/delay (s)): /</span>
<span class="c1">#&gt;   error handler: </span>
<span class="c1">#&gt;   config:</span>
</code></pre></div>
<h2>Headers</h2>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;http://httpbin.org/headers&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_headers<span class="p">(</span><span class="sb">`X-FARGO-SEASON`</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="sb">`X-NARCOS-SEASON`</span> <span class="o">=</span> <span class="m">5</span><span class="p">)</span> <span class="o">%&gt;%</span>
  peep
<span class="c1">#&gt; &lt;http request&gt; </span>
<span class="c1">#&gt;   url: http://httpbin.org/headers</span>
<span class="c1">#&gt;   paths: </span>
<span class="c1">#&gt;   query: </span>
<span class="c1">#&gt;   body: </span>
<span class="c1">#&gt;   paging: </span>
<span class="c1">#&gt;   headers: </span>
<span class="c1">#&gt;     X-FARGO-SEASON: 3</span>
<span class="c1">#&gt;     X-NARCOS-SEASON: 5</span>
<span class="c1">#&gt;   rate limit: </span>
<span class="c1">#&gt;   retry (n/delay (s)): /</span>
<span class="c1">#&gt;   error handler: </span>
<span class="c1">#&gt;   config:</span>
</code></pre></div>
<h2>curl configuration</h2>

<p><code>httr</code> is exported in <code>request</code>, so you can use <code>httr</code> functions like <code>verbose()</code> to get verbose curl output</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">api<span class="p">(</span><span class="s">&#39;http://httpbin.org/headers&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  api_config<span class="p">(</span>verbose<span class="p">())</span>
<span class="c1">#&gt; -&gt; GET /headers HTTP/1.1</span>
<span class="c1">#&gt; -&gt; Host: httpbin.org</span>
<span class="c1">#&gt; -&gt; User-Agent: curl/7.43.0 curl/0.9.4 httr/1.0.0 request/0.1.0</span>
<span class="c1">#&gt; -&gt; Accept-Encoding: gzip, deflate</span>
<span class="c1">#&gt; -&gt; Accept: application/json, text/xml, application/xml, */*</span>
<span class="c1">#&gt; -&gt;</span>
<span class="c1">#&gt; &lt;- HTTP/1.1 200 OK</span>
<span class="c1">#&gt; &lt;- Server: nginx</span>
<span class="c1">#&gt; &lt;- Date: Sun, 03 Jan 2016 16:56:29 GMT</span>
<span class="c1">#&gt; &lt;- Content-Type: application/json</span>
<span class="c1">#&gt; &lt;- Content-Length: 227</span>
<span class="c1">#&gt; &lt;- Connection: keep-alive</span>
<span class="c1">#&gt; &lt;- Access-Control-Allow-Origin: *</span>
<span class="c1">#&gt; &lt;- Access-Control-Allow-Credentials: true</span>
<span class="c1">#&gt; &lt;-</span>
<span class="c1">#&gt; $headers</span>
<span class="c1">#&gt; $headers$Accept</span>
<span class="c1">#&gt; [1] &quot;application/json, text/xml, application/xml, */*&quot;</span>
<span class="c1">#&gt; ...</span>
</code></pre></div>
<h2>Coming soon</h2>

<p>There&#39;s a number of interesting features that should be coming soon to <code>request</code>.</p>

<ul>
<li>Paging - a paging helper will make it easy to do paing, and will attempt to handle any parameters used for paging. Some user input will be required, like what parameter names are, and how many records you want returned  <a href="https://github.com/sckott/request/issues/2">sckott/request#2</a></li>
<li>Retry - a retry helper will make it easy to retry http requests on any failure, and execute a user defined function on failure <a href="https://github.com/sckott/request/issues/6">sckott/request#6</a></li>
<li>Rate limit - a rate limit helper will add info to a set of many requests - still in early design stages <a href="https://github.com/sckott/request/issues/5">sckott/request#5</a></li>
<li>Caching - a caching helper - may use in the background the in development <a href="https://github.com/ropensci/vcr">vcr R client</a> when on CRAN or perhaps <a href="https://github.com/richfitz/storr">storr</a>  <a href="https://github.com/sckott/request/issues/4">sckott/request#4</a></li>
</ul>

  </div>
  
  <div class="post">
    <h1>
      <a href="/2015/12/binomen-taxonomy-tools/">
        binomen - Tools for slicing and dicing taxonomic names
      </a>
    </h1>

    <span class="post-date">08 Dec 2015</span>

    <p>The first version of <code>binomen</code> is now up on <a href="https://cran.rstudio.com/web/packages/binomen">CRAN</a>. It provides various taxonomic classes for defining a single taxon, multiple taxa, and a taxonomic data.frame. It is designed as a companion to <a href="https://github.com/ropensci/taxize">taxize</a>, where you can get taxonomic data on taxonomic names from the web.</p>

<p>The classes (S3):</p>

<ul>
<li><code>taxon</code></li>
<li><code>taxonref</code></li>
<li><code>taxonrefs</code></li>
<li><code>binomial</code></li>
<li><code>grouping</code> (i.e., classification - used different term to avoid conflict with classification in <code>taxize</code>)</li>
</ul>

<p>For example, the <code>binomial</code> class is defined by a genus, epithet, authority, and optional full species name and canonical version.</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">binomial<span class="p">(</span><span class="s">&quot;Poa&quot;</span><span class="p">,</span> <span class="s">&quot;annua&quot;</span><span class="p">,</span> authority<span class="o">=</span><span class="s">&quot;L.&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&lt;</span>binomial<span class="o">&gt;</span>
  genus<span class="o">:</span> Poa
  epithet<span class="o">:</span> annua
  canonical<span class="o">:</span>
  species<span class="o">:</span>
  authority<span class="o">:</span> L.
</code></pre></div>
<p>The package has a suite of functions to work on these taxonomic classes:</p>

<ul>
<li><code>gethier()</code> - get hierarchy from a <code>taxon</code> class</li>
<li><code>scatter()</code> - make each row in taxonomic data.frame (<code>taxondf</code>) a separate <code>taxon</code> object within a single <code>taxa</code> object</li>
<li><code>assemble()</code> - make a <code>taxa</code> object into a <code>taxondf</code> data.frame</li>
<li><code>pick()</code> - pick out one or more taxonomic groups</li>
<li><code>pop()</code> - pop out (drop) one or more taxonomic groups</li>
<li><code>span()</code> - pick a range between two taxonomic groups (inclusive)</li>
<li><code>strain()</code> - filter by taxonomic groups, like dplyr&#39;s filter</li>
<li><code>name()</code> - get the taxon name for each <code>taxonref</code> object</li>
<li><code>uri()</code> - get the reference uri for each <code>taxonref</code> object</li>
<li><code>rank()</code> - get the taxonomic rank for each <code>taxonref</code> object</li>
<li><code>id()</code> - get the reference uri for each <code>taxonref</code> object</li>
</ul>

<p>The approach in this package I suppose is sort of like <code>split-apply-combine</code> from <code>plyr</code>/<code>dplyr</code>, whereas this is aims to make it easy to do with taxonomic names.</p>

<h2>Install</h2>

<p>For examples below, you&#39;ll need the development version:</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">install.packages<span class="p">(</span><span class="s">&quot;binomen&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">&quot;binomen&quot;</span><span class="p">)</span>
</code></pre></div>
<h2>Make a taxon</h2>

<p>Make a taxon object</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="p">(</span>obj <span class="o">&lt;-</span> make_taxon<span class="p">(</span>genus<span class="o">=</span><span class="s">&quot;Poa&quot;</span><span class="p">,</span> epithet<span class="o">=</span><span class="s">&quot;annua&quot;</span><span class="p">,</span> authority<span class="o">=</span><span class="s">&quot;L.&quot;</span><span class="p">,</span>
  family<span class="o">=</span><span class="s">&#39;Poaceae&#39;</span><span class="p">,</span> clazz<span class="o">=</span><span class="s">&#39;Poales&#39;</span><span class="p">,</span> kingdom<span class="o">=</span><span class="s">&#39;Plantae&#39;</span><span class="p">,</span> variety<span class="o">=</span><span class="s">&#39;annua&#39;</span><span class="p">))</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     kingdom: Plantae</span>
<span class="c1">#&gt;     clazz: Poales</span>
<span class="c1">#&gt;     family: Poaceae</span>
<span class="c1">#&gt;     genus: Poa</span>
<span class="c1">#&gt;     species: Poa annua</span>
<span class="c1">#&gt;     variety: annua</span>
</code></pre></div>
<p>Index to various parts of the object</p>

<p>The binomial</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj<span class="o">$</span>binomial
<span class="c1">#&gt; &lt;binomial&gt;</span>
<span class="c1">#&gt;   genus: Poa</span>
<span class="c1">#&gt;   epithet: annua</span>
<span class="c1">#&gt;   canonical: Poa annua</span>
<span class="c1">#&gt;   species: Poa annua L.</span>
<span class="c1">#&gt;   authority: L.</span>
</code></pre></div>
<p>The authority</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj<span class="o">$</span>binomial<span class="o">$</span>authority
<span class="c1">#&gt; [1] &quot;L.&quot;</span>
</code></pre></div>
<p>The classification</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj<span class="o">$</span>grouping
<span class="c1">#&gt; &lt;grouping&gt;</span>
<span class="c1">#&gt;   kingdom: Plantae</span>
<span class="c1">#&gt;   clazz: Poales</span>
<span class="c1">#&gt;   family: Poaceae</span>
<span class="c1">#&gt;   genus: Poa</span>
<span class="c1">#&gt;   species: Poa annua</span>
<span class="c1">#&gt;   variety: annua</span>
</code></pre></div>
<p>The family</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj<span class="o">$</span>grouping<span class="o">$</span>family
<span class="c1">#&gt; &lt;taxonref&gt;</span>
<span class="c1">#&gt;   rank: family</span>
<span class="c1">#&gt;   name: Poaceae</span>
<span class="c1">#&gt;   id: none</span>
<span class="c1">#&gt;   uri: none</span>
</code></pre></div>
<h2>Subset taxon objects</h2>

<p>Get one or more ranks via <code>pick()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj <span class="o">%&gt;%</span> pick<span class="p">(</span>family<span class="p">)</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     family: Poaceae</span>
obj <span class="o">%&gt;%</span> pick<span class="p">(</span>family<span class="p">,</span> genus<span class="p">)</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     family: Poaceae</span>
<span class="c1">#&gt;     genus: Poa</span>
</code></pre></div>
<p>Drop one or more ranks via <code>pop()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj <span class="o">%&gt;%</span> pop<span class="p">(</span>family<span class="p">)</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     kingdom: Plantae</span>
<span class="c1">#&gt;     clazz: Poales</span>
<span class="c1">#&gt;     genus: Poa</span>
<span class="c1">#&gt;     species: Poa annua</span>
<span class="c1">#&gt;     variety: annua</span>
obj <span class="o">%&gt;%</span> pop<span class="p">(</span>family<span class="p">,</span> genus<span class="p">)</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     kingdom: Plantae</span>
<span class="c1">#&gt;     clazz: Poales</span>
<span class="c1">#&gt;     species: Poa annua</span>
<span class="c1">#&gt;     variety: annua</span>
</code></pre></div>
<p>Get a range of ranks via <code>span()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">obj <span class="o">%&gt;%</span> span<span class="p">(</span>kingdom<span class="p">,</span> family<span class="p">)</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa annua</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     kingdom: Plantae</span>
<span class="c1">#&gt;     clazz: Poales</span>
<span class="c1">#&gt;     family: Poaceae</span>
</code></pre></div>
<p>Extract classification as a <code>data.frame</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">gethier<span class="p">(</span>obj<span class="p">)</span>
<span class="c1">#&gt;      rank      name</span>
<span class="c1">#&gt; 1 kingdom   Plantae</span>
<span class="c1">#&gt; 2   clazz    Poales</span>
<span class="c1">#&gt; 3  family   Poaceae</span>
<span class="c1">#&gt; 4   genus       Poa</span>
<span class="c1">#&gt; 5 species Poa annua</span>
<span class="c1">#&gt; 6 variety     annua</span>
</code></pre></div>
<h2>Taxonomic data.frame&#39;s</h2>

<p>Make one</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>order <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Asterales&#39;</span><span class="p">,</span><span class="s">&#39;Asterales&#39;</span><span class="p">,</span><span class="s">&#39;Fagales&#39;</span><span class="p">,</span><span class="s">&#39;Poales&#39;</span><span class="p">,</span><span class="s">&#39;Poales&#39;</span><span class="p">,</span><span class="s">&#39;Poales&#39;</span><span class="p">),</span>
  family <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Asteraceae&#39;</span><span class="p">,</span><span class="s">&#39;Asteraceae&#39;</span><span class="p">,</span><span class="s">&#39;Fagaceae&#39;</span><span class="p">,</span><span class="s">&#39;Poaceae&#39;</span><span class="p">,</span><span class="s">&#39;Poaceae&#39;</span><span class="p">,</span><span class="s">&#39;Poaceae&#39;</span><span class="p">),</span>
  genus <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Helianthus&#39;</span><span class="p">,</span><span class="s">&#39;Helianthus&#39;</span><span class="p">,</span><span class="s">&#39;Quercus&#39;</span><span class="p">,</span><span class="s">&#39;Poa&#39;</span><span class="p">,</span><span class="s">&#39;Festuca&#39;</span><span class="p">,</span><span class="s">&#39;Holodiscus&#39;</span><span class="p">),</span>
  stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="p">(</span>df2 <span class="o">&lt;-</span> taxon_df<span class="p">(</span>df<span class="p">))</span>
<span class="c1">#&gt;       order     family      genus</span>
<span class="c1">#&gt; 1 Asterales Asteraceae Helianthus</span>
<span class="c1">#&gt; 2 Asterales Asteraceae Helianthus</span>
<span class="c1">#&gt; 3   Fagales   Fagaceae    Quercus</span>
<span class="c1">#&gt; 4    Poales    Poaceae        Poa</span>
<span class="c1">#&gt; 5    Poales    Poaceae    Festuca</span>
<span class="c1">#&gt; 6    Poales    Poaceae Holodiscus</span>
</code></pre></div>
<p>Parse - get rank order via <code>pick()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">df2 <span class="o">%&gt;%</span> pick<span class="p">(</span><span class="kp">order</span><span class="p">)</span>
<span class="c1">#&gt;       order</span>
<span class="c1">#&gt; 1 Asterales</span>
<span class="c1">#&gt; 2 Asterales</span>
<span class="c1">#&gt; 3   Fagales</span>
<span class="c1">#&gt; 4    Poales</span>
<span class="c1">#&gt; 5    Poales</span>
<span class="c1">#&gt; 6    Poales</span>
</code></pre></div>
<p>get ranks order, family, and genus via <code>pick()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">df2 <span class="o">%&gt;%</span> pick<span class="p">(</span><span class="kp">order</span><span class="p">,</span> family<span class="p">,</span> genus<span class="p">)</span>
<span class="c1">#&gt;       order     family      genus</span>
<span class="c1">#&gt; 1 Asterales Asteraceae Helianthus</span>
<span class="c1">#&gt; 2 Asterales Asteraceae Helianthus</span>
<span class="c1">#&gt; 3   Fagales   Fagaceae    Quercus</span>
<span class="c1">#&gt; 4    Poales    Poaceae        Poa</span>
<span class="c1">#&gt; 5    Poales    Poaceae    Festuca</span>
<span class="c1">#&gt; 6    Poales    Poaceae Holodiscus</span>
</code></pre></div>
<p>get range of names via <code>span()</code>, from rank <code>X</code> to rank <code>Y</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">df2 <span class="o">%&gt;%</span> span<span class="p">(</span>family<span class="p">,</span> genus<span class="p">)</span>
<span class="c1">#&gt;       family      genus</span>
<span class="c1">#&gt; 1 Asteraceae Helianthus</span>
<span class="c1">#&gt; 2 Asteraceae Helianthus</span>
<span class="c1">#&gt; 3   Fagaceae    Quercus</span>
<span class="c1">#&gt; 4    Poaceae        Poa</span>
<span class="c1">#&gt; 5    Poaceae    Festuca</span>
<span class="c1">#&gt; 6    Poaceae Holodiscus</span>
</code></pre></div>
<p>Separate each row into a <code>taxon</code> class (many <code>taxon</code> objects are a <code>taxa</code> class)</p>
<div class="highlight"><pre><code class="language-r" data-lang="r">scatter<span class="p">(</span>df2<span class="p">)</span>
<span class="c1">#&gt; [[1]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Helianthus none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Asterales</span>
<span class="c1">#&gt;     family: Asteraceae</span>
<span class="c1">#&gt;     genus: Helianthus</span>
<span class="c1">#&gt;     species: Helianthus none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[2]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Helianthus none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Asterales</span>
<span class="c1">#&gt;     family: Asteraceae</span>
<span class="c1">#&gt;     genus: Helianthus</span>
<span class="c1">#&gt;     species: Helianthus none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[3]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Quercus none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Fagales</span>
<span class="c1">#&gt;     family: Fagaceae</span>
<span class="c1">#&gt;     genus: Quercus</span>
<span class="c1">#&gt;     species: Quercus none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[4]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Poa none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Poales</span>
<span class="c1">#&gt;     family: Poaceae</span>
<span class="c1">#&gt;     genus: Poa</span>
<span class="c1">#&gt;     species: Poa none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[5]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Festuca none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Poales</span>
<span class="c1">#&gt;     family: Poaceae</span>
<span class="c1">#&gt;     genus: Festuca</span>
<span class="c1">#&gt;     species: Festuca none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; [[6]]</span>
<span class="c1">#&gt; &lt;taxon&gt;</span>
<span class="c1">#&gt;   binomial: Holodiscus none</span>
<span class="c1">#&gt;   grouping: </span>
<span class="c1">#&gt;     order: Poales</span>
<span class="c1">#&gt;     family: Poaceae</span>
<span class="c1">#&gt;     genus: Holodiscus</span>
<span class="c1">#&gt;     species: Holodiscus none</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; attr(,&quot;class&quot;)</span>
<span class="c1">#&gt; [1] &quot;taxa&quot;</span>
</code></pre></div>
<p>And you can re-assemble a data.frame from the output of <code>scatter()</code> with <code>assemble()</code></p>
<div class="highlight"><pre><code class="language-r" data-lang="r">out <span class="o">&lt;-</span> scatter<span class="p">(</span>df2<span class="p">)</span>
assemble<span class="p">(</span>out<span class="p">)</span>
<span class="c1">#&gt;       order     family      genus         species</span>
<span class="c1">#&gt; 1 Asterales Asteraceae Helianthus Helianthus none</span>
<span class="c1">#&gt; 2 Asterales Asteraceae Helianthus Helianthus none</span>
<span class="c1">#&gt; 3   Fagales   Fagaceae    Quercus    Quercus none</span>
<span class="c1">#&gt; 4    Poales    Poaceae        Poa        Poa none</span>
<span class="c1">#&gt; 5    Poales    Poaceae    Festuca    Festuca none</span>
<span class="c1">#&gt; 6    Poales    Poaceae Holodiscus Holodiscus none</span>
</code></pre></div>
<h2>Thoughts?</h2>

<p>I&#39;m really curious what people think of <code>binomen</code>. I&#39;m not sure how useful this will be in the wild. Try it. Let me know. Thanks much :)</p>

  </div>
  
  <div class="post">
    <h1>
      <a href="/2015/11/crossref-clients/">
        Crossref programmatic clients
      </a>
    </h1>

    <span class="post-date">30 Nov 2015</span>

    <p>I gave two talks recently at the annual <a href="http://www.crossref.org/annualmeeting/agenda.html">Crossref meeting</a>, one of which was a somewhat technical overview of programmatic clients for Crossref APIs. Check out the talk <a href="https://crossref.wistia.com/medias/8rh0jm5eda">here</a>. I talked about the motivation for working with Crossref data by writing code/etc. rather than going the GUI route, then went over the various clients, with brief examples.</p>

<p>We (rOpenSci) have been working on the R client <a href="https://github.com/ropensci/rcrossref">rcrossref</a> for a while now, but I&#39;m also working on the Python and Ruby clients for Crossref. In addition, the Ruby client has a CLI client inside. The Javascript client is worked on independently by <a href="https://science.ai/">ScienceAI</a>.</p>

<p>The R, Ruby, and Python clients are useable but not feature complete yet, and would benefit from lots of users surfacing bugs and highlighting nice to have features.</p>

<p>The main Crossref API used in all the clients is documented at <a href="https://github.com/CrossRef/rest-api-doc/blob/master/rest_api.md">api.crossref.org</a>.</p>

<p>I&#39;ve tried to make the APIs similar-ish across clients. Functions in each client match the main Crossref search API (api.crossref.org) routes:</p>

<ul>
<li><code>/works</code></li>
<li><code>/members</code></li>
<li><code>/funders</code></li>
<li><code>/journals</code></li>
<li><code>/types</code></li>
<li><code>/licenses</code></li>
</ul>

<p>Other methods in all three clients:</p>

<ul>
<li>Get DOI minting agency

<ul>
<li>Uses api.crossref.org API</li>
</ul></li>
<li>Get random DOIs

<ul>
<li>Uses api.crossref.org API</li>
</ul></li>
<li>Content negotiation

<ul>
<li>Documented at <a href="http://www.crosscite.org/cn">http://www.crosscite.org/cn</a></li>
</ul></li>
<li>Get full text

<ul>
<li>other clients in each language will focus on this use case</li>
</ul></li>
<li>Get citation count

<ul>
<li>Uses service at <a href="http://www.crossref.org/openurl">http://www.crossref.org/openurl</a> - though this functionality may be in the api.crossref.org API at some point</li>
</ul></li>
</ul>

<p>The following shows how to install, and then examples from each client for a few use cases.</p>

<h2>Installation</h2>

<h3>Python</h3>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">pip install habanero
</code></pre></div>
<h3>Ruby</h3>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">gem install serrano
</code></pre></div>
<h3>R</h3>

<p>Inside R:</p>
<div class="highlight"><pre><code class="language-R" data-lang="R">install.packages<span class="p">(</span><span class="s">&quot;rcrossref&quot;</span><span class="p">)</span>
</code></pre></div>
<h3>Javascript</h3>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">npm install crossref
</code></pre></div>
<p>I won&#39;t do any examples with the js library, as I don&#39;t maintain it.</p>

<h2>Use case: get ORCID IDs for authors</h2>

<p>Python</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">habanero</span> <span class="kn">import</span> <span class="n">Crossref</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">Crossref</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">works</span><span class="p">(</span><span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;has_orcid&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span> <span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">z</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;ORCID&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;author&#39;</span><span class="p">]</span> <span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;message&#39;</span><span class="p">][</span><span class="s">&#39;items&#39;</span><span class="p">]</span> <span class="p">]</span>
<span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">res2</span><span class="p">))</span>
</code></pre></div><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="p">[</span><span class="s">u&#39;http://orcid.org/0000-0003-4087-8021&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0002-2076-5452&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4087-8021&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0002-2076-5452&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-1710-1580&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-1710-1580&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4637-238X&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4637-238X&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4637-238X&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4637-238X&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-4637-238X&#39;</span><span class="p">,</span>
 <span class="s">u&#39;http://orcid.org/0000-0003-2510-4271&#39;</span><span class="p">]</span>
</code></pre></div>
<p>Ruby</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;serrano&#39;</span>
<span class="n">res</span> <span class="o">=</span> <span class="no">Serrano</span><span class="o">.</span><span class="n">works</span><span class="p">(</span><span class="ss">filter</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;has_orcid&#39;</span><span class="p">:</span> <span class="kp">true</span><span class="p">},</span> <span class="ss">limit</span><span class="p">:</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">res</span><span class="o">[</span><span class="s1">&#39;message&#39;</span><span class="o">][</span><span class="s1">&#39;items&#39;</span><span class="o">].</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="o">[</span><span class="s1">&#39;author&#39;</span><span class="o">].</span><span class="n">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">z</span><span class="o">|</span> <span class="n">z</span><span class="o">[</span><span class="s1">&#39;ORCID&#39;</span><span class="o">]</span> <span class="p">}</span> <span class="p">}</span>
<span class="n">res2</span><span class="o">.</span><span class="n">flatten</span><span class="o">.</span><span class="n">compact</span>
</code></pre></div><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span><span class="p">,</span>
 <span class="s2">&quot;http://orcid.org/0000-0003-2510-4271&quot;</span><span class="o">]</span>
</code></pre></div>
<p>R</p>
<div class="highlight"><pre><code class="language-R" data-lang="R"><span class="kn">library</span><span class="p">(</span><span class="s">&quot;rcrossref&quot;</span><span class="p">)</span>
res <span class="o">&lt;-</span> cr_works<span class="p">(</span>filter<span class="o">=</span><span class="kt">c</span><span class="p">(</span>has_orcid<span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span> limit <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
orcids <span class="o">&lt;-</span> <span class="kp">unlist</span><span class="p">(</span><span class="kp">lapply</span><span class="p">(</span>res<span class="o">$</span>data<span class="o">$</span>author<span class="p">,</span> <span class="kr">function</span><span class="p">(</span>z<span class="p">)</span> z<span class="o">$</span>ORCID<span class="p">))</span>
<span class="kp">Filter</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="o">!</span><span class="kp">is.na</span><span class="p">(</span>x<span class="p">),</span> orcids<span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-R" data-lang="R"> <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span>
 <span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span>
 <span class="p">[</span><span class="m">3</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span>
 <span class="p">[</span><span class="m">4</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span>
 <span class="p">[</span><span class="m">5</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span>
 <span class="p">[</span><span class="m">6</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span>
 <span class="p">[</span><span class="m">7</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
 <span class="p">[</span><span class="m">8</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
 <span class="p">[</span><span class="m">9</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="p">[</span><span class="m">10</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="p">[</span><span class="m">11</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="p">[</span><span class="m">12</span><span class="p">]</span> <span class="s">&quot;http://orcid.org/0000-0003-2510-4271&quot;</span>
</code></pre></div>
<p>CLI</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">serrano works --filter<span class="o">=</span>has_orcid:true --json --limit<span class="o">=</span><span class="m">12</span> <span class="p">|</span> jq <span class="s1">&#39;.message.items[].author[].ORCID | select(. != null)&#39;</span>
</code></pre></div><div class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="s2">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4087-8021&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-1710-1580&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-4637-238X&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0003-2510-4271&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0001-9408-8207&quot;</span>
<span class="s2">&quot;http://orcid.org/0000-0002-2076-5452&quot;</span>
</code></pre></div>
<h2>Use case: content negotation</h2>

<p>Python</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">habanero</span> <span class="kn">import</span> <span class="n">cn</span>
<span class="n">cn</span><span class="o">.</span><span class="n">content_negotiation</span><span class="p">(</span><span class="n">ids</span> <span class="o">=</span> <span class="s">&#39;10.1126/science.169.3946.635&#39;</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s">&quot;text&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="s">u&#39;Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635</span><span class="se">\xe2\x80\x93</span><span class="s">641. doi:10.1126/science.169.3946.635</span><span class="se">\n</span><span class="s">&#39;</span>
</code></pre></div>
<p>Ruby</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;serrano&#39;</span>
<span class="no">Serrano</span><span class="o">.</span><span class="n">content_negotiation</span><span class="p">(</span><span class="ss">ids</span><span class="p">:</span> <span class="s1">&#39;10.1126/science.169.3946.635&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635</span><span class="se">\xE2\x80\x93</span><span class="s2">641. doi:10.1126/science.169.3946.635</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">]</span>
</code></pre></div>
<p>R</p>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">&quot;rcrossref&quot;</span><span class="p">)</span>
cr_cn<span class="p">(</span>dois<span class="o">=</span><span class="s">&quot;10.1126/science.169.3946.635&quot;</span><span class="p">,</span> <span class="s">&quot;text&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635–641. doi:10.1126/science.169.3946.635&quot;</span>
</code></pre></div>
<p>CLI</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">serrano contneg 10.1890/13-0590.1 --format<span class="o">=</span>text
</code></pre></div><div class="highlight"><pre><code class="language-sh" data-lang="sh">Murtaugh, P. A. <span class="o">(</span>2014<span class="o">)</span>.  In defense of P values . Ecology, 95<span class="o">(</span>3<span class="o">)</span>, 611–617. doi:10.1890/13-0590.1
</code></pre></div>
<h2>More</h2>

<p>There are definitely issues with data in the Crossref search API, some of which I cover in my talks. However, it is still the best place to go for scholarly metadata.</p>

<p>Let us know of other use cases - there are others not covered here for brevity sake.</p>

<p>There are lots of examples in the docs for each client. If you can think of any doc improvements file an issue.</p>

<p>If you find any bugs, please do file an issue.</p>

  </div>
  
</div>

<!-- Pagination links -->
<div class="pagination">
  
    <a href="/page2" class="older">Older</a>
  
  
    <span class="previous">Newer</span>
  
</div>

    </div>

    <!-- for bootstrap tooltips -->
    <script type="text/javascript">
      $("[data-toggle=\"tooltip\"]").tooltip();
    </script>

  </body>

  <footer>
  <!-- Disqus code -->
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'recology'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>

  <!-- google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-63197374-1', 'auto');
    ga('send', 'pageview');
  </script>
</footer>

</html>
