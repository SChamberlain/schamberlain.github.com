<!DOCTYPE html>

<html>
  <head>

    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">

    <title>Recology: An exploration of using R for ecology, evolution, and open science.</title>

    <script type="text/javascript" src="http://use.typekit.com/jjw2jrj.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <link type="text/css" rel="stylesheet" href="/stylesheets/reset.css">
    <link type="text/css" rel="stylesheet" href="/stylesheets/screen.css">
    <link type="text/css" rel="stylesheet" href="/stylesheets/code.css">
    <link rel="alternate" type="application/atom+xml"
      title="User Obsessed Feed" href="http://feeds.feedburner.com/userobsessed" />

    <link rel="apple-touch-icon" href="/images/iOS-114.png" />
    <link rel="apple-touch-icon-precomposed" href="/images/iOS-57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" media="screen and (resolution: 132dpi)" href="/images/iOS-72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" media="screen and (resolution: 326dpi)" href="/images/iOS-114.png" />

    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />



  </head>
  <body class="default">

    <section id="main">

      <section id="masthead" class="group">
        <header class="group">
          <p><a href="/">Recology</a></p>
          <h1>An exploration of using R for ecology, evolution, and open science.</h1>
          <img src="/images/uo-logo.png">
        </header>
      </section>

      <section id="focus" class="group">

        <section id="content" class="group">
          <section id="posts">
  <ol>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/02/16/farmer-s-markets-data/">Farmer's markets data</a></h2>
  </header>
  
    I combined USDA data on farmer's markets in the US with population census data to get an idea of the disparity in farmers markets by state, and then also expressed per capita.<br /><br />Download USDA data <a href="http://www.ams.usda.gov/AMSv1.0/getfile?dDocName=STELPRDC5087258&amp;acct=frmrdirmkt">here</a>. The formatted file I used below is <a href="http://schamber.files.wordpress.com/2011/02/farmmarkets.xls">here</a> (in excel format, although I read into R as csv file). The census data is read from url as below.<br /><br />California has a ton of absolute number of farmer's markets, but Vermont takes the cake by far with number of markets per capita. Iowa comes in a distant second behind Vermont in markets per capita.<br /><br /><br /><br />The code:<br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;">######## Farmer's Markets #############</span><br /><a href="http://inside-r.org/r-doc/base/setwd"><span style="color: #003399; font-weight: bold;">setwd</span></a><span style="color: #009900;">(</span><span style="color: blue;">"/Mac/R_stuff/Blog_etc/USDAFarmersMarkets"</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># Set to your working directory, this is where you want to call files from and write files to</span><br /><a href="http://inside-r.org/r-doc/utils/install.packages"><span style="color: #003399; font-weight: bold;">install.packages</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"ggplot2"</span><span style="color: #339933;">,</span> <span style="color: blue;">"RCurl"</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span>  <span style="color: #666666; font-style: italic;"># install all packags required below</span><br /><a href="http://inside-r.org/r-doc/base/require"><span style="color: #003399; font-weight: bold;">require</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># plyr is libraried along with ggplot2, as ggplot2 uses plyr (as well as package reshape) functions</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># read market data</span><br />markets &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">"farmmarkets.csv"</span><span style="color: #009900;">)</span><br />markets$state &lt;- <a href="http://inside-r.org/r-doc/base/as.factor"><span style="color: #003399; font-weight: bold;">as.factor</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: blue;">"Wyoming "</span><span style="color: #339933;">,</span> <span style="color: blue;">"Wyoming"</span><span style="color: #339933;">,</span> markets$LocAddState<span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># there was a typo for Wyoming</span><br />markets &lt;- <a href="http://inside-r.org/r-doc/stats/na.omit"><span style="color: #003399; font-weight: bold;">na.omit</span></a><span style="color: #009900;">(</span>markets<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/str"><span style="color: #003399; font-weight: bold;">str</span></a><span style="color: #009900;">(</span>markets<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># read population census data</span><br />popcen &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">"http://www.census.gov/popest/national/files/NST_EST2009_ALLDATA.csv"</span><span style="color: #009900;">)</span><br />popcen &lt;- popcen<span style="color: #009900;">[</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">17</span><span style="color: #009900;">)</span><span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/utils/str"><span style="color: #003399; font-weight: bold;">str</span></a><span style="color: #009900;">(</span>popcen<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># summarize</span><br />markets_ &lt;- ddply<span style="color: #009900;">(</span>markets<span style="color: #339933;">,</span> .<span style="color: #009900;">(</span>state<span style="color: #009900;">)</span><span style="color: #339933;">,</span> summarise<span style="color: #339933;">,</span><br /> markets_n = <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>LocAddState<span style="color: #009900;">)</span> <br /><span style="color: #009900;">)</span><br />&nbsp;<br />markets_pop_ &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>markets_<span style="color: #339933;">,</span> popcen<span style="color: #009900;">[</span><span style="color: #339933;">,</span>-<span style="color: #cc66cc;">1</span><span style="color: #009900;">]</span><span style="color: #339933;">,</span> by.x = <span style="color: blue;">"state"</span><span style="color: #339933;">,</span> by.y = <span style="color: blue;">"NAME"</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># merge two data sets</span><br />markets_pop_$marketspercap &lt;- markets_pop_$markets_n/markets_pop_$POPESTIMATE2009 <span style="color: #666666; font-style: italic;"># create column of markets per capita</span><br />markets_pop_$markets_n_st &lt;- markets_pop_$markets_n/max<span style="color: #009900;">(</span>markets_pop_$markets_n<span style="color: #009900;">)</span><br />markets_pop_$marketspercap_st &lt;- markets_pop_$marketspercap/max<span style="color: #009900;">(</span>markets_pop_$marketspercap<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># plot</span><br /><a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>melt<span style="color: #009900;">(</span>markets_pop_<span style="color: #009900;">[</span><span style="color: #339933;">,</span>-<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span>:<span style="color: #cc66cc;">5</span><span style="color: #009900;">)</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>x = state<span style="color: #339933;">,</span> y = value<span style="color: #339933;">,</span> fill = variable<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br /> geom_bar<span style="color: #009900;">(</span>position = <span style="color: blue;">"dodge"</span><span style="color: #009900;">)</span> +<br /> coord_flip<span style="color: #009900;">(</span><span style="color: #009900;">)</span><br />ggsave<span style="color: #009900;">(</span><span style="color: blue;">"fmarkets_barplot.jpeg"</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br />Note: the x-axis here is standardized value of number of markets (markets_n_st) and number of markets per capita (marketspercap_st).<br /><a href="http://4.bp.blogspot.com/-ceVMLE6yfbk/TVyE31U6LTI/AAAAAAAAEaM/PM2LCHnLPMM/s1600/fmarkets_barplot.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="452" src="http://4.bp.blogspot.com/-ceVMLE6yfbk/TVyE31U6LTI/AAAAAAAAEaM/PM2LCHnLPMM/s640/fmarkets_barplot.jpeg" style="cursor: move;" width="640" /></a><br /><br /><br /><div style="overflow-x: auto; overflow-y: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span style="color: #666666; font-style: italic;"># maps</span><br />try_require<span style="color: #009900;">(</span><span style="color: blue;">"maps"</span><span style="color: #009900;">)</span><br />states &lt;- map_data<span style="color: #009900;">(</span><span style="color: blue;">"state"</span><span style="color: #009900;">)</span><br />markets_pop_$statelow &lt;- <a href="http://inside-r.org/r-doc/base/tolower"><span style="color: #003399; font-weight: bold;">tolower</span></a><span style="color: #009900;">(</span>markets_pop_$state<span style="color: #009900;">)</span><br />survey_sum_map &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>states<span style="color: #339933;">,</span> markets_pop_<span style="color: #339933;">,</span> by.x = <span style="color: blue;">"region"</span><span style="color: #339933;">,</span> by.y = <span style="color: blue;">"statelow"</span><span style="color: #009900;">)</span><br />survey_sum_map &lt;- survey_sum_map<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span>survey_sum_map$order<span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: #009900;">]</span><br /><a href="http://inside-r.org/r-doc/utils/str"><span style="color: #003399; font-weight: bold;">str</span></a><span style="color: #009900;">(</span>survey_sum_map<span style="color: #009900;">)</span><br />&nbsp;<br />qplot<span style="color: #009900;">(</span>long<span style="color: #339933;">,</span> lat<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = survey_sum_map<span style="color: #339933;">,</span> group = group<span style="color: #339933;">,</span> fill = markets_n<span style="color: #339933;">,</span> geom = <span style="color: blue;">"polygon"</span><span style="color: #339933;">,</span> main = <span style="color: blue;">"Total farmer's markets"</span><span style="color: #009900;">)</span> + <br /> scale_fill_gradient<span style="color: #009900;">(</span>low=<span style="color: blue;">"green"</span><span style="color: #339933;">,</span> high=<span style="color: blue;">"black"</span><span style="color: #009900;">)</span><br />ggsave<span style="color: #009900;">(</span><span style="color: blue;">"fmarkets_map_green.jpeg"</span><span style="color: #009900;">)</span> </pre></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></div><div><br /></div><br /><br /><br /><a href="http://2.bp.blogspot.com/-I-Hqg4GtJs0/TVyE3I7BmYI/AAAAAAAAEaI/xNqBq4BqemI/s1600/fmarkets_map_green.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="452" src="http://2.bp.blogspot.com/-I-Hqg4GtJs0/TVyE3I7BmYI/AAAAAAAAEaI/xNqBq4BqemI/s640/fmarkets_map_green.jpeg" style="cursor: move;" width="640" /></a><br /><br /><br /><div style="overflow-x: auto; overflow-y: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"></pre><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"></pre><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">qplot<span style="color: #009900;">(</span>long<span style="color: #339933;">,</span> lat<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = survey_sum_map<span style="color: #339933;">,</span> group = group<span style="color: #339933;">,</span> fill = marketspercap<span style="color: #339933;">,</span> geom = <span style="color: blue;">"polygon"</span><span style="color: #339933;">,</span> main = <span style="color: blue;">"Farmer's markets per person"</span><span style="color: #009900;">)</span> +<br /> scale_fill_gradient<span style="color: #009900;">(</span>low=<span style="color: blue;">"green"</span><span style="color: #339933;">,</span> high=<span style="color: blue;">"black"</span><span style="color: #009900;">)</span><br />&nbsp;<br />ggsave<span style="color: #009900;">(</span><span style="color: blue;">"fmarkerspercap_map_green.jpeg"</span><span style="color: #009900;">)</span> </pre></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></div><div><br /></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-g8zapywmu7M/TVyE2qNzFnI/AAAAAAAAEaE/yrjk5txjFgo/s1600/fmarkerspercap_map_green.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="453" src="http://4.bp.blogspot.com/-g8zapywmu7M/TVyE2qNzFnI/AAAAAAAAEaE/yrjk5txjFgo/s640/fmarkerspercap_map_green.jpeg" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-I-Hqg4GtJs0/TVyE3I7BmYI/AAAAAAAAEaI/xNqBq4BqemI/s1600/fmarkets_map_green.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a></div><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"></pre></div></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ceVMLE6yfbk/TVyE31U6LTI/AAAAAAAAEaM/PM2LCHnLPMM/s1600/fmarkets_barplot.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a></div>

  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-02-16T12:00:00-06:00">Wednesday, February 16</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F02%2F16%2Ffarmer-s-markets-data%2F&amp;title=Farmer's%20markets%20data" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/02/15/would-the-fall-of-fannie-mae-and-freddie-mac-be-a-boon-for-the-environment-/">Would the fall of Fannie Mae and Freddie Mac be a boon for the environment?</a></h2>
  </header>
  
    
  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-02-15T12:00:00-06:00">Tuesday, February 15</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F02%2F15%2Fwould-the-fall-of-fannie-mae-and-freddie-mac-be-a-boon-for-the-environment-%2F&amp;title=Would%20the%20fall%20of%20Fannie%20Mae%20and%20Freddie%20Mac%20be%20a%20boon%20for%20the%20environment%3F" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/02/10/obesity-/">Obesity...</a></h2>
  </header>
  
    A dataset provided by Professor Majid Ezzati at Imperial College London (download excel file <a href="http://www1.imperial.ac.uk/resources/DA4B27F4-7040-4855-B6C0-5B065949E93C/sbptcbmimeans.xls">here</a>), and reported on&nbsp;<a href="http://www.washingtonpost.com/wp-srv/special/health/weight-of-the-world-bmi/">here</a>, reports a huge database of three metrics of obesity across the globe over the past ~30 years. I have blogged about google visualization and googlevis package here; they provide a googlevis plot <a href="http://www5.imperial.ac.uk/medicine/metabolic_risks/bubble_plots.html">here</a>.<br /><br />I played around with the dataset a bit, and here are some of my graphical thoughts:

  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-02-10T12:00:00-06:00">Thursday, February 10</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F02%2F10%2Fobesity-%2F&amp;title=Obesity..." rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/02/09/troubling-news-for-the-teaching-of-evolution/">Troubling news for the teaching of evolution</a></h2>
  </header>
  
    [UPDATE: i remade the maps in green, hope that helps...]<br /><br />A recent survey reported in <a href="http://www.sciencemag.org.silk.library.umass.edu/content/331/6016/404.full">Science</a>&nbsp;("Defeating Creationism in the Courtroom, but not in the Classroom") found that biology teachers in high school do not often accept the basis of their discipline, as do teachers in other disciplines, and thus may not teach evolution appropriately.&nbsp;Read more here:&nbsp;<a href="http://www.nytimes.com/2011/02/08/science/08creationism.html?emc=eta1">New York Times</a>.<br /><br />I took a little time to play with the data provided online along with the Science article. The data is available on the Science website along with the article, and the dataset I read into R is unchanged from the original. The states abbreviations file is <a href="http://schamber.files.wordpress.com/2011/02/states_abbreviations.xls">here</a>&nbsp;(as a .xls). Here goes:<br /><br />I only played with two survey questions: q1b (no. of hours ecology is taught per year), and q1d (no. of hours evolution is taught per year). I looked at ecology and evolution as this blog is about ecology and evolution. It seems that some states that teach a lot of ecology teach&nbsp;a lot of evolution, but I found no correlation between the two without extreme outliers. I&nbsp;couldn’t help but notice my home state, TX, is near the bottom of the list on both counts - go TX! The teaching of evolution on the map produced below is less predictable than I would have though just based on my assumptions about political will in each state.<br /><br /><div style="overflow: auto;"><div class="geshifilter"><div class="separator" style="clear: both; text-align: center;"><br /></div><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;"># Analyses of Conditionality Data set of all variables, except for latitude, etc.</span><br /><a href="http://inside-r.org/r-doc/base/setwd"><span style="color: #003399; font-weight: bold;">setwd</span></a><span style="color: #009900;">(</span><span style="color: blue;">"/Mac/R_stuff/Blog_etc/EvolutionTeaching/"</span><span style="color: #009900;">)</span> <span style="color: #666666; font-style: italic;"># Set working directory</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/packages/cran/ggplot2">ggplot2</a><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># read in data, and prepare new columns</span><br /><a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a> &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">"berkmandata.csv"</span><span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/utils/str"><span style="color: #003399; font-weight: bold;">str</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a><span style="color: #009900;">) # (I do realize that survey is a data object in the MASS package)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># Assign actual hours to survey answers </span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a>$q1b<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1.5</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">13</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">18</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />ecol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">7</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> ecol<span style="color: #009900;">)</span><br />&nbsp;<br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a>$q1d<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1.5</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">13</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">18</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />evol &lt;- <a href="http://inside-r.org/r-doc/base/gsub"><span style="color: #003399; font-weight: bold;">gsub</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">7</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> evol<span style="color: #009900;">)</span><br />&nbsp;<br /><a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a>$ecol &lt;- <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">(</span>ecol<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a>$evol &lt;- <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">(</span>evol<span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># ddply it</span><br />survey_sum &lt;- ddply<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/MASS/survey"><span style="color: #003399; font-weight: bold;">survey</span></a><span style="color: #339933;">,</span> .<span style="color: #009900;">(</span>st_posta<span style="color: #009900;">)</span><span style="color: #339933;">,</span> summarise<span style="color: #339933;">,</span><br /> mean_ecol_hrs = <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span>ecol<span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">)</span><span style="color: #339933;">,</span><br /> mean_evol_hrs = <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">(</span>evol<span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">)</span><span style="color: #339933;">,</span><br /> se_ecol_hrs = <a href="http://inside-r.org/r-doc/stats/sd"><span style="color: #003399; font-weight: bold;">sd</span></a><span style="color: #009900;">(</span>ecol<span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">)</span>/sqrt<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>ecol<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br /> se_evol_hrs = <a href="http://inside-r.org/r-doc/stats/sd"><span style="color: #003399; font-weight: bold;">sd</span></a><span style="color: #009900;">(</span>evol<span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">)</span>/sqrt<span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>evol<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span><br /> num_teachers = <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">(</span>st_posta<span style="color: #009900;">)</span><br /><span style="color: #009900;">)</span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># plotting</span><br />limits_ecol &lt;- aes<span style="color: #009900;">(</span>ymax = mean_ecol_hrs + se_ecol_hrs<span style="color: #339933;">,</span> ymin = mean_ecol_hrs - se_ecol_hrs<span style="color: #009900;">)</span><br />limits_evol &lt;- aes<span style="color: #009900;">(</span>ymax = mean_evol_hrs + se_evol_hrs<span style="color: #339933;">,</span> ymin = mean_evol_hrs - se_evol_hrs<span style="color: #009900;">)</span><br />&nbsp;<br /><a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>survey_sum<span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>x = <a href="http://inside-r.org/r-doc/stats/reorder"><span style="color: #003399; font-weight: bold;">reorder</span></a><span style="color: #009900;">(</span>st_posta<span style="color: #339933;">,</span> mean_ecol_hrs<span style="color: #009900;">)</span><span style="color: #339933;">,</span> y = mean_ecol_hrs<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br /> geom_point<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br /> geom_errorbar<span style="color: #009900;">(</span>limits_ecol<span style="color: #009900;">)</span> +<br /> geom_text<span style="color: #009900;">(</span>aes<span style="color: #009900;">(</span>label = num_teachers<span style="color: #009900;">)</span><span style="color: #339933;">,</span> vjust = <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> hjust = -<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> size = <span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> +<br /> coord_flip<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br /> labs<span style="color: #009900;">(</span>x = <span style="color: blue;">"State"</span><span style="color: #339933;">,</span> y = <span style="color: blue;">"Mean hours of ecology taught <span style="color: #000099; font-weight: bold;">\n</span> per year (+/- 1 se)"</span><span style="color: #009900;">)</span><br /></pre><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #009900;">####SMALL NUMBERS BY BARS ARE NUMBER OF TEACHERS THAT RESPONDED TO THE SURVEY</span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R" style="font-family: monospace;"><a href="http://1.bp.blogspot.com/_fANWq796z-w/TVKfu6zmnJI/AAAAAAAAEZw/b49TxhUjMmk/s1600/survey_ecol.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/_fANWq796z-w/TVKfu6zmnJI/AAAAAAAAEZw/b49TxhUjMmk/s640/survey_ecol.jpeg" width="392" /></a><span class="Apple-style-span" style="font-family: Times; white-space: normal;"></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_fANWq796z-w/TVKfu6zmnJI/AAAAAAAAEZw/b49TxhUjMmk/s1600/survey_ecol.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><pre class="r geshifilter-R" style="font-family: monospace;">&nbsp;<br /><a href="http://inside-r.org/packages/cran/ggplot">ggplot</a><span style="color: #009900;">(</span>survey_sum<span style="color: #339933;">,</span> aes<span style="color: #009900;">(</span>x = <a href="http://inside-r.org/r-doc/stats/reorder"><span style="color: #003399; font-weight: bold;">reorder</span></a><span style="color: #009900;">(</span>st_posta<span style="color: #339933;">,</span> mean_evol_hrs<span style="color: #009900;">)</span><span style="color: #339933;">,</span> y = mean_evol_hrs<span style="color: #009900;">)</span><span style="color: #009900;">)</span> +<br /> geom_point<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br /> geom_errorbar<span style="color: #009900;">(</span>limits_evol<span style="color: #009900;">)</span> +<br /> geom_text<span style="color: #009900;">(</span>aes<span style="color: #009900;">(</span>label = num_teachers<span style="color: #009900;">)</span><span style="color: #339933;">,</span> vjust = <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> hjust = -<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> size = <span style="color: #cc66cc;">3</span><span style="color: #009900;">)</span> +<br /> coord_flip<span style="color: #009900;">(</span><span style="color: #009900;">)</span> +<br /> labs<span style="color: #009900;">(</span>x = <span style="color: blue;">"State"</span><span style="color: #339933;">,</span> y = <span style="color: blue;">"Mean hours of evolution taught <span style="color: #000099; font-weight: bold;">\n</span> per year (+/- 1 se)"</span><span style="color: #009900;">)</span><br />&nbsp;<span class="Apple-style-span" style="color: #009900;">####SMALL NUMBERS BY BARS ARE NUMBER OF TEACHERS THAT RESPONDED TO THE SURVEY</span><br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="http://4.bp.blogspot.com/_fANWq796z-w/TVKfuQSN7sI/AAAAAAAAEZs/o1EIVgS7lkA/s1600/survey_evol.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/_fANWq796z-w/TVKfuQSN7sI/AAAAAAAAEZs/o1EIVgS7lkA/s640/survey_evol.jpeg" width="392" /></a></span><br />&nbsp;<br /><span style="color: #666666; font-style: italic;"># map</span><br />try_require<span style="color: #009900;">(</span><span style="color: blue;">"maps"</span><span style="color: #009900;">)</span><br />states &lt;- map_data<span style="color: #009900;">(</span><span style="color: blue;">"state"</span><span style="color: #009900;">)</span><br />statenames &lt;- <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">(</span><span style="color: blue;">"/Mac/R_stuff/Code/states_abbreviations.csv"</span><span style="color: #009900;">)</span><br />survey_sum_ &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>survey_sum<span style="color: #339933;">,</span> statenames<span style="color: #339933;">,</span> by.x = <span style="color: blue;">"st_posta"</span><span style="color: #339933;">,</span> by.y = <span style="color: blue;">"state_abbrev"</span><span style="color: #009900;">)</span><br />survey_sum_map &lt;- <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">(</span>states<span style="color: #339933;">,</span> survey_sum_<span style="color: #339933;">,</span> by.x = <span style="color: blue;">"region"</span><span style="color: #339933;">,</span> by.y = <span style="color: blue;">"state"</span><span style="color: #009900;">)</span><br />survey_sum_map &lt;- survey_sum_map<span style="color: #009900;">[</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">(</span>survey_sum_map$order<span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: #009900;">]</span><br />&nbsp;<br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">qplot<span style="color: #009900;">(</span>long<span style="color: #339933;">,</span> lat<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = survey_sum_map<span style="color: #339933;">,</span> group = group<span style="color: #339933;">,</span> fill = mean_ecol_hrs<span style="color: #339933;">,</span> geom = <span style="color: blue;">"polygon"</span><span style="color: #009900;">)</span> + scale_fill_gradient<span style="color: #009900;">(</span>low=<span style="color: blue;">"black"</span><span style="color: #339933;">,</span> high=<span style="color: blue;">"green"</span><span style="color: #009900;">)</span></pre></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R"><span style="color: #009900;"></span><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><a href="http://3.bp.blogspot.com/-cNO2YWHX0Hk/TVQP5B7VxmI/AAAAAAAAEZ8/GBYKNR5vUBs/s1600/survey_ecol_map_green.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="458" src="http://3.bp.blogspot.com/-cNO2YWHX0Hk/TVQP5B7VxmI/AAAAAAAAEZ8/GBYKNR5vUBs/s640/survey_ecol_map_green.jpeg" width="640" /></a></span><br /><span class="Apple-style-span"><br /></span></pre><div class="separator" style="clear: both; text-align: center;"><br /></div><pre class="r geshifilter-R">&nbsp;<br /><br /><span class="Apple-style-span" style="font-family: Times; white-space: normal;"><pre class="r geshifilter-R" style="font-family: monospace; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">qplot<span style="color: #009900;">(</span>long<span style="color: #339933;">,</span> lat<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a> = survey_sum_map<span style="color: #339933;">,</span> group = group<span style="color: #339933;">,</span> fill = mean_evol_hrs<span style="color: #339933;">,</span> geom = <span style="color: blue;">"polygon"</span><span style="color: #009900;">)</span> + scale_fill_gradient<span style="color: #009900;">(</span>low=<span style="color: blue;">"black"</span><span style="color: #339933;">,</span> high=<span style="color: blue;">"green"</span><span style="color: #009900;">)</span></pre></span></pre><pre class="r geshifilter-R"><span style="color: #009900; font-family: monospace;"><span class="Apple-style-span" style="color: black; font-family: Times; white-space: normal;"><a href="http://2.bp.blogspot.com/-eLaIU-xsE78/TVQP5ol2gBI/AAAAAAAAEaA/vmGvlFhLmfE/s1600/survey_evol_map_green.jpeg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="458" src="http://2.bp.blogspot.com/-eLaIU-xsE78/TVQP5ol2gBI/AAAAAAAAEaA/vmGvlFhLmfE/s640/survey_evol_map_green.jpeg" style="cursor: move;" width="640" /></a></span></span></pre><pre class="r geshifilter-R"><pre class="r geshifilter-R" style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: Times;"><span class="Apple-style-span" style="white-space: normal;"><br /></span></span></pre></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre><pre class="r geshifilter-R"><span class="Apple-style-span" style="font-family: Times;"><span class="Apple-style-span" style="white-space: normal;"><br /></span></span></pre><pre class="r geshifilter-R" style="font-family: monospace;"></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a>

  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-02-09T12:00:00-06:00">Wednesday, February  9</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F02%2F09%2Ftroubling-news-for-the-teaching-of-evolution%2F&amp;title=Troubling%20news%20for%20the%20teaching%20of%20evolution" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/02/01/plants-are-less-sex-deprived-when-next-to-closely-related-neighbors/">Plants are less sex deprived when next to closely related neighbors</a></h2>
  </header>
  
    A new early online paper in <a href="http://www.amjbot.org/cgi/content/abstract/ajb.1000329v1">American Journal of Botany</a> by Risa Sargent and colleagues suggests that plants are less sex deprived (pollen limited) in vernal pools that have more closely related plant species.<br /><br />Vernal pools are (at least in my experience) small (to quite large) depressions that fill up with water with winter rains, and dry out completely in&nbsp;the summer. Vernal pool adapted plants flower in rings down the pool as the water dries up. Aquatic invertebrates and some herps can last through the summer by burrowing in the soil.<br /><br />The study did hand pollination experiments with a focal species,&nbsp;<i>Lasthenia fremontii</i>. They examined the relationship between these pollen limitation experiments and the relatedness of <i>L. fremontii</i> to the rest of the plant community in each pool.<br /><br />Plant species richness was not related to pollen limitation. Thus, at least in their study with vernal pools in California, relatedness to your plant neighbors has a greater impact than plant richness.<br /><br />The great thing about vernal pools is that they are truly terrestrial islands of habitat, surrounded by inhospitable habitat for pool species. Many vernal pools are created artificially for habitat conservation easements (e.g., <a href="http://www.vollmarconsulting.com/projects/caltrans-madera-pools/index.html">here</a>). Perhaps someone can experimentally manipulate phylogenetic diversity in artificially created pools to really get at the causal links.<br /><br /><br /><br /><br /><br /><br />p.s. Ok, this post is not terribly R related, except for that this paper used R for some of their statistics.

  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-02-01T12:00:00-06:00">Tuesday, February  1</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F02%2F01%2Fplants-are-less-sex-deprived-when-next-to-closely-related-neighbors%2F&amp;title=Plants%20are%20less%20sex%20deprived%20when%20next%20to%20closely%20related%20neighbors" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/01/30/good-riddance-to-excel-pivot-tables/">Good riddance to Excel pivot tables</a></h2>
  </header>
  
    Excel pivot tables have been how I have reorganized data...up until now. These are just a couple of examples why R is superior to Excel for reorganizing data:<br /><br />UPDATE: I fixed the code to use 'dcast' instead of 'cast'. And library(ggplot2) instead of library(plyr) [plyr is called along with ggplot2]. Thanks Bob!<br /><br />Also, see another post on this topic:<br />-<a href="http://news.mrdwab.com/2010/08/08/using-the-reshape-packagein-r/">http://news.mrdwab.com/2010/08/08/using-the-reshape-packagein-r/</a><br /><br /><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family: monospace;"><span style="color: #666666; font-style: italic;">################ Good riddance to pivot tables ############</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(</span>reshape2<span style="color: #009900;">)</span><br /><a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">(<span class="Apple-style-span" style="color: black;">ggplot2</span>)</span>&nbsp;<br />dataset &lt;- <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">(</span>var1 = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"a"</span><span style="color: #339933;">,</span><span style="color: blue;">"b"</span><span style="color: #339933;">,</span><span style="color: blue;">"c"</span><span style="color: #339933;">,</span><span style="color: blue;">"d"</span><span style="color: #339933;">,</span><span style="color: blue;">"e"</span><span style="color: #339933;">,</span><span style="color: blue;">"f"</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> each = <span style="color: #cc66cc;">4</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br /> var2 = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"level1"</span><span style="color: #339933;">,</span><span style="color: blue;">"level1"</span><span style="color: #339933;">,</span><span style="color: blue;">"level2"</span><span style="color: #339933;">,</span><span style="color: blue;">"level2"</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">6</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <br /> var3 = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">(</span><span style="color: blue;">"h"</span><span style="color: #339933;">,</span><span style="color: blue;">"m"</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">12</span><span style="color: #009900;">)</span><span style="color: #339933;">,</span> meas = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">(</span><span style="color: #cc66cc;">1</span>:<span style="color: #cc66cc;">12</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a><br /><br /><br /><div style="overflow: auto;"><div class="geshifilter"><pre class="r geshifilter-R"><span style="color: #666666; font-family: monospace; font-style: italic;"># simply pivot table</span><br />dcast<span style="color: #009900; font-family: monospace;">(</span>dataset<span style="color: #339933; font-family: monospace;">,</span> var1 <span style="font-family: monospace;">~</span> var2 <span style="font-family: monospace;">+</span> var3<span style="color: #009900; font-family: monospace;">)</span><br />Using meas as value column.  Use the value argument to cast to override this choice<br />  var1 level1_h level1_m level2_h level2_m<br />1    a        1        2        3        4<br />2    b        5        6        7        8<br />3    c        9       10       11       12<br />4    d        1        2        3        4<br />5    e        5        6        7        8<br />6    f        9       10       11       12</pre><pre class="r geshifilter-R" style="font-family: monospace;">&nbsp;<br /><span style="color: #666666; font-style: italic;"># mean by var1 and var2</span><br />dcast<span style="color: #009900;">(</span>dataset<span style="color: #339933;">,</span> var1 ~ var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">)</span></pre><pre class="r geshifilter-R">Using meas as value column.  Use the value argument to cast to override this choice<br />  var1 level1 level2<br />1    a    1.5    3.5<br />2    b    5.5    7.5<br />3    c    9.5   11.5<br />4    d    1.5    3.5<br />5    e    5.5    7.5<br />6    f    9.5   11.5<br /><br />&nbsp;<br /><span style="color: #666666; font-family: monospace; font-style: italic;"># mean by var1 and var3</span><br />dcast<span style="color: #009900; font-family: monospace;">(</span>dataset<span style="color: #339933; font-family: monospace;">,</span> var1 <span style="font-family: monospace;">~</span> var3<span style="color: #339933; font-family: monospace;">,</span> <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900; font-family: monospace;">)</span><br />Using meas as value column.  Use the value argument to cast to override this choice<br />  var1  h  m<br />1    a  2  3<br />2    b  6  7<br />3    c 10 11<br />4    d  2  3<br />5    e  6  7<br />6    f 10 11</pre><pre class="r geshifilter-R">&nbsp;<br /><span style="color: #666666; font-family: monospace; font-style: italic;"># mean by var1, var2 and var3 (version 1)</span><br />dcast<span style="color: #009900; font-family: monospace;">(</span>dataset<span style="color: #339933; font-family: monospace;">,</span> var1 <span style="font-family: monospace;">~</span> var2 <span style="font-family: monospace;">+</span> var3<span style="color: #339933; font-family: monospace;">,</span> <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900; font-family: monospace;">)</span></pre><pre class="r geshifilter-R"><span style="color: #009900; font-family: monospace;"></span>Using meas as value column.  Use the value argument to cast to override this choice<br />  var1 level1_h level1_m level2_h level2_m<br />1    a        1        2        3        4<br />2    b        5        6        7        8<br />3    c        9       10       11       12<br />4    d        1        2        3        4<br />5    e        5        6        7        8<br />6    f        9       10       11       12<br />&nbsp;<br /><span style="color: #666666; font-family: monospace; font-style: italic;"># mean by var1, var2 and var3 (version 2)</span><br />dcast<span style="color: #009900; font-family: monospace;">(</span>dataset<span style="color: #339933; font-family: monospace;">,</span> var1 <span style="font-family: monospace;">+</span> var2 <span style="font-family: monospace;">~</span> var3<span style="color: #339933; font-family: monospace;">,</span> <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900; font-family: monospace;">)</span></pre><pre class="r geshifilter-R">Using meas as value column.  Use the value argument to cast to override this choice<br />   var1   var2  h  m<br />1     a level1  1  2<br />2     a level2  3  4<br />3     b level1  5  6<br />4     b level2  7  8<br />5     c level1  9 10<br />6     c level2 11 12<br />7     d level1  1  2<br />8     d level2  3  4<br />9     e level1  5  6<br />10    e level2  7  8<br />11    f level1  9 10<br />12    f level2 11 12<br /><br />&nbsp;<br /><span style="color: #666666; font-family: monospace; font-style: italic;"># use package plyr to create flexible data frames...</span><br />dataset_plyr <span style="font-family: monospace;">&lt;-</span> ddply<span style="color: #009900; font-family: monospace;">(</span>dataset<span style="color: #339933; font-family: monospace;">,</span> .<span style="color: #009900; font-family: monospace;">(</span>var1<span style="color: #339933; font-family: monospace;">,</span> var2<span style="color: #009900; font-family: monospace;">)</span><span style="color: #339933; font-family: monospace;">,</span> summarise<span style="color: #339933; font-family: monospace;">,</span> <br /> <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a> = <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900; font-family: monospace;">(</span>meas<span style="color: #009900; font-family: monospace;">)</span><span style="color: #339933; font-family: monospace;">,</span> <br /> se = <a href="http://inside-r.org/r-doc/stats/sd" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">sd</span></a><span style="color: #009900; font-family: monospace;">(</span>meas<span style="color: #009900; font-family: monospace;">)</span><span style="color: #339933; font-family: monospace;">,</span><br /> CV = <a href="http://inside-r.org/r-doc/stats/sd" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">sd</span></a><span style="color: #009900; font-family: monospace;">(</span>meas<span style="color: #009900; font-family: monospace;">)</span><span style="font-family: monospace;">/</span>mean<span style="color: #009900; font-family: monospace;">(</span>meas<span style="color: #009900; font-family: monospace;">)</span><br /><span style="color: #009900; font-family: monospace;">)</span><br />&gt; dataset_plyr<br />   var1   var2 mean        se         CV<br />1     a level1  1.5 0.7071068 0.47140452<br />2     a level2  3.5 0.7071068 0.20203051<br />3     b level1  5.5 0.7071068 0.12856487<br />4     b level2  7.5 0.7071068 0.09428090<br />5     c level1  9.5 0.7071068 0.07443229<br />6     c level2 11.5 0.7071068 0.06148755<br />7     d level1  1.5 0.7071068 0.47140452<br />8     d level2  3.5 0.7071068 0.20203051<br />9     e level1  5.5 0.7071068 0.12856487<br />10    e level2  7.5 0.7071068 0.09428090<br />11    f level1  9.5 0.7071068 0.07443229<br />12    f level2 11.5 0.7071068 0.06148755</pre><pre class="r geshifilter-R"></pre><pre class="r geshifilter-R">&nbsp;<br /><span style="color: #666666; font-family: monospace; font-style: italic;"># ...to use for plotting</span><br />qplot<span style="color: #009900; font-family: monospace;">(</span>var1<span style="color: #339933; font-family: monospace;">,</span> <a href="http://inside-r.org/r-doc/base/mean" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #339933; font-family: monospace;">,</span> colour = var2<span style="color: #339933; font-family: monospace;">,</span> size = CV<span style="color: #339933; font-family: monospace;">,</span> <a href="http://inside-r.org/r-doc/utils/data" style="font-family: monospace;"><span style="color: #003399; font-weight: bold;">data</span></a> = dataset_plyr<span style="color: #339933; font-family: monospace;">,</span> geom = <span style="color: blue; font-family: monospace;">"point"</span><span style="color: #009900; font-family: monospace;">)</span></pre><pre class="r geshifilter-R"><span style="color: #009900; font-family: monospace;"><br /></span></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_fANWq796z-w/TUY7U_DgoOI/AAAAAAAAEYs/f3xQFdRk6sI/s1600/pivottable1.jpeg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="381" src="http://2.bp.blogspot.com/_fANWq796z-w/TUY7U_DgoOI/AAAAAAAAEYs/f3xQFdRk6sI/s400/pivottable1.jpeg" width="400" /></a></div><pre class="r geshifilter-R"><span style="color: #009900; font-family: monospace;"><br /></span></pre><pre class="r geshifilter-R"><span style="color: #009900; font-family: monospace;"><br /></span></pre></div></div><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a>

  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-01-30T12:00:00-06:00">Sunday, January 30</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F01%2F30%2Fgood-riddance-to-excel-pivot-tables%2F&amp;title=Good%20riddance%20to%20Excel%20pivot%20tables" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/01/25/london-bike-travel-network/">London bike travel network</a></h2>
  </header>
  
    
  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-01-25T12:00:00-06:00">Tuesday, January 25</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F01%2F25%2Flondon-bike-travel-network%2F&amp;title=London%20bike%20travel%20network" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/01/25/climate-data-etc-/">Climate data, etc.</a></h2>
  </header>
  
    
  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-01-25T12:00:00-06:00">Tuesday, January 25</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F01%2F25%2Fclimate-data-etc-%2F&amp;title=Climate%20data%2C%20etc." rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/01/20/your-city-walmart-and-its-carbon-footprint/">Your city: Walmart and its Carbon Footprint</a></h2>
  </header>
  
    
  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-01-20T12:00:00-06:00">Thursday, January 20</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F01%2F20%2Fyour-city-walmart-and-its-carbon-footprint%2F&amp;title=Your%20city%3A%20Walmart%20and%20its%20Carbon%20Footprint" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
    <li>
      <article class="instapaper_body">
  <header>
    <h2 class="instapaper_title"><a href="/2011/01/19/roadway-congestion/">Roadway congestion</a></h2>
  </header>
  
    
  
  <footer class="group">
    <p>
      
      
      
        
      
      <time pubdate datetime="2011-01-19T12:00:00-06:00">Wednesday, January 19</time>
      
      <a class="icon" href="http://www.instapaper.com/hello2?u=http%3A%2F%2Fschamberlain.github.com%2Frecology%2F%2F2011%2F01%2F19%2Froadway-congestion%2F&amp;title=Roadway%20congestion" rel="alternate" title="Save to Instapaper">Read Later</a>
      
    </p>
  </footer>
</article>


    </li>
    
  </ol>

  
  <nav id="pagination">
    <ol>
      
        
      
      
      <li>
        <a href="/pagelayoutdefaulturl/page9/index.htmlcontent<section id="posts">
  <ol>
    {% for post in paginator.posts %}
    <li>
      {% include post.html %}
    </li>
    {% endfor %}
  </ol>

  {% if paginator.total_pages > 1 %}
  <nav id="pagination">
    <ol>
      {% if paginator.previous_page > 1 %}
        {% capture page_url %}page{{ page }}{% endcapture%}
      {% endif %}
      {% if paginator.previous_page %}
      <li>
        <a href="/{{ page_url }}" title="Go to previous page">
          &laquo;
        </a>
      </li>
      {% endif %}
      <li>
      {% for page in (1..paginator.total_pages) %}
      <li>
        {% if page > 1 %}
          {% capture page_url %}page{{ page }}{% endcapture%}
        {% endif %}
        {% if page == paginator.page %}
          {{ page }}
        {% else %}
          <a href="/{{ page_url }}">{{ page }}</a>
        {% endif %}
      </li>
      {% endfor %}
      {% if paginator.next_page %}
      <li>
        <a href="/page{{ paginator.next_page }}" title="Go to next page">
          &raquo;
        </a>
      </li>
      {% endif %}
    </ol>
  </nav>
  {% endif %}
</section>
" title="Go to previous page">
          &laquo;
        </a>
      </li>
      
      <li>
      
      <li>
        
        
          <a href="/pagelayoutdefaulturl/page9/index.htmlcontent<section id="posts">
  <ol>
    {% for post in paginator.posts %}
    <li>
      {% include post.html %}
    </li>
    {% endfor %}
  </ol>

  {% if paginator.total_pages > 1 %}
  <nav id="pagination">
    <ol>
      {% if paginator.previous_page > 1 %}
        {% capture page_url %}page{{ page }}{% endcapture%}
      {% endif %}
      {% if paginator.previous_page %}
      <li>
        <a href="/{{ page_url }}" title="Go to previous page">
          &laquo;
        </a>
      </li>
      {% endif %}
      <li>
      {% for page in (1..paginator.total_pages) %}
      <li>
        {% if page > 1 %}
          {% capture page_url %}page{{ page }}{% endcapture%}
        {% endif %}
        {% if page == paginator.page %}
          {{ page }}
        {% else %}
          <a href="/{{ page_url }}">{{ page }}</a>
        {% endif %}
      </li>
      {% endfor %}
      {% if paginator.next_page %}
      <li>
        <a href="/page{{ paginator.next_page }}" title="Go to next page">
          &raquo;
        </a>
      </li>
      {% endif %}
    </ol>
  </nav>
  {% endif %}
</section>
">1</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page2">2</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page3">3</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page4">4</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page5">5</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page6">6</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page7">7</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page8">8</a>
        
      </li>
      
      <li>
        
          
        
        
          9
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page10">10</a>
        
      </li>
      
      <li>
        
          
        
        
          <a href="/page11">11</a>
        
      </li>
      
      
      <li>
        <a href="/page10" title="Go to next page">
          &raquo;
        </a>
      </li>
      
    </ol>
  </nav>
  
</section>

        </section>

        <section id="sidebar">

          <section id="meta-col1" class="meta group">
            <aside id="about">
              <header>
                <h3>About</h3>
              </header>
              <p>
                Recology is a blog that explores using R for ecology, evolution, and open science. <a href="/about">See more.</a>
              </p>
            </aside>

            <aside>
              <header>
                <h3>Stay up to date</h3>
              </header>
              <nav>
                <ul>
                  <li class="icon rss"><a href="http://feeds.feedburner.com/XX">RSS</a></li>
                  <li class="icon twitter"><a href="http://twitter.com/recology_">Twitter</a></li>
                  <li class="icon"><a href="/subscribe">More</a></li>
                </ul>
              </nav>
            </aside>

          </section>

          <section id="meta-col2" class="meta group">

            <aside id="bio">
              <header>
                <h3>The Author</h3>
              </header>
              <p>
              My name is Scott Chamberlain. I am a researcher in ecology and evolution.
              </p>
            </aside>

            <aside>
              <nav id="extra">
                <ul>
                  <li><a href="/colophon">Colophon</a></li>
                  <li><a href="/contact">Contact</a></li>
                </ul>
              </nav>
            </aside>

          </section>

        </section>

      </section>

      <section id="footer" class="group">
        <footer class="group">
          <nav id="site">
            <ul>
              <li><a href="/">Home</a></li>
              <li><a href="/about">About</a></li>
              <li><a href="/contact">Contact</a></li>
              <li><a href="/subscribe">Subscribe</a></li>
              <li><a href="/colophon">Colophon</a></li>
            </ul>
          </nav>
          <p class="copyright">
            &copy;2011 &ndash; Scott Chamberlain
          </p>
        </footer>
      </section>

    </section>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-23094691-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>
