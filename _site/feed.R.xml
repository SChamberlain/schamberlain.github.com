<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
	<channel>
		<title>Recology - R</title>
		<description>Posts tagged as 'R'</description>
		<link>http://schamberlain.github.com</link>
		
			<item>
				<title>Open Science Challenge</title>
				<description>&lt;p&gt;&lt;img src=&quot;https://raw.github.com/SChamberlain/schamberlain.github.com/master/img/ropensci_challenge.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;Open Science&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Science is becoming more open in many areas: publishing, data sharing, lab notebooks, and software. There are many benefits to open science. For example, sharing research data alongside your publications leads to increased citation rate (Piwowar &lt;em&gt;et. al.&lt;/em&gt; 2007). In addition, data is becoming easier to share and reuse thanks to efforts like &lt;a href=&quot;http://figshare.com/&quot;&gt;FigShare&lt;/a&gt; and &lt;a href=&quot;http://datadryad.org/&quot;&gt;Dryad&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you don't understand the problem we are currently facing due to lack of open science, watch this video:&lt;/p&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;http://www.youtube.com/embed/N2zK3sAtr-4&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;


&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;I just want Data&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Another way to look at this challenge is to think about how you can get data more easily. Right now you probably go to a website that has an interface to a database. You do a search, and then download a .csv file perhaps. Then you open it in Excel, and do some pivot tables to get the data in the right format. Only then will you bring the data in to R.&lt;/p&gt;

&lt;p&gt;The advantage of using our packages is that they allow you to do that data collection part in a few lines of code. Therefore, you can easily do all those steps in the above paragraph using a few lines of code in one R file. Why does this matter? You can more easily reproduce your own work months later after that summer vacation. In addition, others can reproduce your research more easily.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;The challenge&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;We (&lt;a href=&quot;http://ropensci.org/&quot;&gt;ropensci&lt;/a&gt;) have just kicked off the &lt;a href=&quot;http://ropensci.org/open-science-challenge/&quot;&gt;rOpenSci Open Science Challenge&lt;/a&gt;. If you aren't familiar with rOpenSci, it is a software collective connecting scientists to open science data on the web. Since R is the most popular programming language for life scientists, it made sense to do this in R (instead of Python e.g.).&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;What is the challenge about?&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;At rOpenSci, we create R software to make getting open source text from publications and open source data easy. An important result of this is that we are facilitating open science. Why? Because R is an open source programming language, and all of our software is open source. . This challenge asks you to propose a project using one or more of our packages - or perhaps you want to propose a new dataset to connect to R. The rOpenSci core developer team will help you with any problems using our packages, and attempt to modify packages according to feedback from participants. Do you use one or more of our R packages? If you do, great. If not, check out our packages &lt;a href=&quot;http://ropensci.org/packages/index.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;How to apply&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Just send an email to &lt;a href=&quot;mailto:info@ropensci.org?subject=rOpenSci%20Open%20Science%20Challenge&quot;&gt;info@ropensci.org&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;strong&gt;The deadline&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;January 31, 2013&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_drafts/2013-01-08-open-science-challenge.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_posts/2013-01-08-open-science-challenge.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;, and &lt;a href=&quot;https://github.com/cboettig/knitcitations&quot;&gt;knitcitations&lt;/a&gt; from &lt;a href=&quot;http://www.carlboettiger.info/&quot;&gt;Carl Boettiger&lt;/a&gt;.&lt;/h4&gt;

&lt;hr /&gt;

&lt;h4&gt;References&lt;/h4&gt;

&lt;p&gt;Piwowar HA, Day RS, Fridsma DB and Ioannidis J (2007).
&amp;ldquo;Sharing Detailed Research Data is Associated With Increased Citation Rate.&amp;rdquo;
&lt;EM&gt;Plos One&lt;/EM&gt;, &lt;B&gt;2&lt;/B&gt;.
&lt;a href=&quot;http://dx.doi.org/10.1371/journal.pone.0000308&quot;&gt;http://dx.doi.org/10.1371/journal.pone.0000308&lt;/a&gt;.

</description>
				<published>2013-01-08 00:00:00 -0800</published>
				<link>http://schamberlain.github.com/2013/01/open-science-challenge/</link>
			</item>
		
			<item>
				<title>Is invasive?</title>
				<description>&lt;p&gt;The Global Invasive Species Database (GISD) (see their website for more info &lt;a href=&quot;http://www.issg.org/database/welcome/&quot;&gt;here&lt;/a&gt;) has data on the invasiveness status of many species. From &lt;code&gt;taxize&lt;/code&gt; you can now query the GISD database.&lt;/p&gt;

&lt;p&gt;Introducing the function &lt;code&gt;gisd_isinvasive&lt;/code&gt;. This function was contributed to &lt;code&gt;taxize&lt;/code&gt; by &lt;a href=&quot;http://www.bartomeus.cat/es/ignasi/&quot;&gt;Ignasi Bartomeus&lt;/a&gt;, a postdoc at the Swedish University Agricultural Sciences.&lt;/p&gt;

&lt;p&gt;There are two possible outputs from using &lt;code&gt;gisd_isinvasive&lt;/code&gt;: &quot;Invasive&quot; or &quot;Not in GISD&quot;. If you use &lt;code&gt;simplify=TRUE&lt;/code&gt; in the function you get &quot;Invasive&quot; or &quot;Not in GISD&quot;, but if you use &lt;code&gt;simplify=FALSE&lt;/code&gt; you get verbose description of the invasive species instead of just &quot;Invasive&quot; (and you still just get &quot;Not in GISD&quot;).&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;http://schamberlain.github.com/img/gisd_small.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;Install taxize from GitHub&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;taxize_&amp;#39;, &amp;#39;ropensci&amp;#39;) # install if you don&amp;#39;t already&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# have the GitHub version&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Make a vector of species&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;sp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Carpobrotus edulis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Rosmarinus officinalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Nasua nasua&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Martes melampus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Centaurea solstitialis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Using the function &lt;code&gt;gisd_isinvasive&lt;/code&gt; you can query the GISD database for the invasiveness status of your species, at least according to GISD. Calling &lt;code&gt;gisd_isinvasive&lt;/code&gt; with the second parameter set to default &lt;code&gt;simplify=FALSE&lt;/code&gt;, you get verbose output, with details on the species.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;gisd_isinvasive&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Checking species 1
Checking species 2
Checking species 3
Checking species 4
Checking species 5
Done

                 species
1     Carpobrotus edulis
2 Rosmarinus officinalis
3            Nasua nasua
4        Martes melampus
5 Centaurea solstitialis
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               status
1                                                                                                                                                                                                                                                  You searched for invasive species named Carpobrotus edulis:     1.  Carpobrotus edulis (succulent)        Carpobrotus edulis is a mat-forming succulent native to South Africa which is invasive primarily in coastal habitats in many parts of the world. It was often introduced as an ornamental plant or used for planting along roadsides, from which it has spread to become invasive. Its main impacts are smothering, reduced regeneration of native flora and changes to soil pH and nutrient regimes.\r\nCommon Names: balsamo, Cape fig, figue marine, freeway iceplant, ghaukum, ghoenavy, highway ice plant, higo del Cabo, higo marino, Hottentosvy, hottentot fig, Hottentottenfeige, iceplant, ikhambi-lamabulawo, Kaapsevy, patata frita, perdevy, pigface, rankvy, sea fig, sour fig, suurvy, umgongozi, vyerank\r\nSynonyms: Mesembryanthemum edule L., Mesembryanthemum edulis
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Not in GISD
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            You searched for invasive species named Nasua nasua:1.  Nasua nasua (mammal)             Interim profile, incomplete informationCommon Names: Achuni, Coatí, South American Coati, Tejón
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       You searched for invasive species named Martes melampus:1.  Martes melampus (mammal)             Interim profile, incomplete informationCommon Names: Japanese Marten, Tsushima Island Marten
5 You searched for invasive species named Centaurea solstitialis:     1.  Centaurea solstitialis (herb)        Centaurea solstitialis is a winter annual that can form dense impenetrable stands that displace desirable vegetation in natural areas, rangelands, and other places. It is best adapted to open grasslands with deep, well-drained soils and an annual precipitation range of 25 to 150cm per year. It is intolerant of shade. Although populations can occur at elevations as high as 2,400 m, most large infestations are found below 1,500 m. Human activities are the primary mechanisms for the long distance movement of C. solstitialis seed. The short, stiff, pappus bristles are covered with barbs that readily adhere to clothing, hair, and fur.  The movement of contaminated hay and uncertified seed are also important long distance transportation mechanisms. Wind disperses seeds over short distances.\r\nCommon Names: geeldissel, golden star thistle, sonnwend-Flockenblume, St. Barnaby&amp;#39;s thistle, yellow centaury, yellow cockspur, yellow star thistle\r\nSynonyms: Leucantha solstitialis (L.) A.&amp;amp; D. Löve
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Simpler output, just the invasive status.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;gisd_isinvasive&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; simplify &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Checking species 1
Checking species 2
Checking species 3
Checking species 4
Checking species 5
Done

                 species      status
1     Carpobrotus edulis    Invasive
2 Rosmarinus officinalis Not in GISD
3            Nasua nasua    Invasive
4        Martes melampus    Invasive
5 Centaurea solstitialis    Invasive
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_drafts/2012-12-13-is-invasive.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_posts/2012-12-13-is-invasive.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-12-13 00:00:00 -0800</published>
				<link>http://schamberlain.github.com/2012/12/is-invasive/</link>
			</item>
		
			<item>
				<title>Shiny apps are awesome</title>
				<description>&lt;p&gt;RStudio has a new product called &lt;code&gt;Shiny&lt;/code&gt; that, quoting from their website, &quot;makes it super simple for R users like you to turn analyses into interactive web applications that anyone can use&quot;. &lt;a href=&quot;http://www.rstudio.com/shiny/&quot;&gt;See here&lt;/a&gt; for more information.&lt;/p&gt;

&lt;p&gt;A &lt;code&gt;Shiny&lt;/code&gt; basically consists of two files: a &lt;code&gt;ui.r&lt;/code&gt; file and a &lt;code&gt;server.r&lt;/code&gt; file.  The &lt;code&gt;ui.r&lt;/code&gt; file, as it says, provides the user interface, and the &lt;code&gt;server.r&lt;/code&gt; file provides the the server logic.&lt;/p&gt;

&lt;p&gt;Below is what it looks like in the wild (on a browser).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://schamberlain.github.com/img/shiny_ss.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;It was pretty easy (for &lt;a href=&quot;http://emhart.github.com/&quot;&gt;Ted Hart of rOpenSci&lt;/a&gt;) to build this app to demonstrate output from the &lt;a href=&quot;http://cran.r-project.org/web/packages/rgbif/index.html&quot;&gt;&lt;code&gt;ropensci rgbif&lt;/code&gt; package&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;You may need to install packages first.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;shiny&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;plyr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;rgbif&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;We tried to build in making real time API calls to GBIF's servers, but the calls took too long for web speed.  So we prepare the data first, and then serve it up from saved data in a &lt;code&gt;.rda&lt;/code&gt; file. Let's first prepare the data. --Well, this is what we do on the app itself, but see the next code block for&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rgbif&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
splist &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Accipiter erythronemius&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Junco hyemalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Aix sponsa&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Haliaeetus leucocephalus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Corvus corone&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Threskiornis molucca&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Merops malimbicus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; llply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;splist&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; occurrencelist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; coordinatestatus &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maxresults &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
names&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; splist  &lt;span class=&quot;c1&quot;&gt;# name each data.frame with the species names&lt;/span&gt;
setwd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;~/ShinyApps/rgbif2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# set directory&lt;/span&gt;
save&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; file &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;speciesdata.rda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# save the list of data.frames into an .rda file to serve up&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Here's the server logic&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shiny&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rgbif&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;## Set up server output&lt;/span&gt;
shinyServer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;input&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; output&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    load&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;speciesdata.rda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# define function for server plot output&lt;/span&gt;
    output&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;gbifplot &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; reactivePlot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        species &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; input&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;spec
        df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; out&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;names&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; species&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    output&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;cbt &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; reactiveText&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;The user interface&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;shiny&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define UI for application that plots random distributions&lt;/span&gt;
shinyUI&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pageWithSidebar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;headerPanel&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;rgbif example&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; sidebarPanel&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;checkboxGroupInput&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;spec&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Species to map:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`Sharp shinned hawk (Accipiter erythronemius)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Accipiter erythronemius&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;sb&quot;&gt;`Dark eyed junco (Junco hyemalis)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Junco hyemalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`Wood duck (Aix sponsa)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Aix sponsa&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;sb&quot;&gt;`Bald eagle (Haliaeetus leucocephalus)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Haliaeetus leucocephalus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;sb&quot;&gt;`Carrion crow (Corvus corone)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Corvus corone&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`Australian White Ibis (Threskiornis molucca)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Threskiornis molucca&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
        &lt;span class=&quot;sb&quot;&gt;`Rosy Bee-eater (Merops malimbicus)`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Merops malimbicus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; selected &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Bald eagle (Haliaeetus leucocephalus)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; 
    mainPanel&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;h5&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;A map of your selected species: Please note that GBIF is queried for every selection so loading times vary&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
        plotOutput&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;gbifplot&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;p&gt;This should be all you need. To actually serve up the app in the web, request to be part of their beta-test of Shiny server on the web &lt;a href=&quot;https://rstudio.wufoo.com/forms/shiny-server-beta-program/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Go play with our Shiny app &lt;a href=&quot;http://glimmer.rstudio.com/ropensci/rgbif2/&quot;&gt;here&lt;/a&gt; to see the kind of visualization you can do with the &lt;code&gt;rgbif&lt;/code&gt; package.&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_drafts/2012-12-10-shiny-r.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/scott/blob/gh-pages/_posts/2012-12-10-shiny-r.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-12-10 00:00:00 -0800</published>
				<link>http://schamberlain.github.com/2012/12/shiny-r/</link>
			</item>
		
			<item>
				<title>One R package for all your taxonomic needs</title>
				<description>&lt;p&gt;UPDATE: there were some errors in the tests for &lt;code&gt;taxize&lt;/code&gt;, so the binaries aren't avaiable yet. You can install from source though, see below.&lt;/p&gt;

&lt;p&gt;Getting taxonomic information for the set of species you are studying can be a pain in the ass. You have to manually type, or paste in, your species one-by-one. Or, if you are lucky, there is a web service in which you can upload a list of species. Encyclopedia of Life (EOL) has a service where you can do this &lt;a href=&quot;http://gni.globalnames.org/parsers/new&quot;&gt;here&lt;/a&gt;. But is this reproducible? No.&lt;/p&gt;

&lt;p&gt;Getting your taxonomic information for your species can now be done programatically in R. Do you want to get taxonomic information from ITIS. We got that. Tropicos? We got that too. uBio? No worries, we got that. What about theplantlist.org? Yep, got that. Encyclopedia of Life? Indeed. What about getting sequence data for a taxon? Oh hell yeah, you can get sequences available for a taxon across all genes, or get all records for a taxon for a specific gene.&lt;/p&gt;

&lt;p&gt;Of course this is all possible because these data providers have open APIs so that we can facilitate your computer talking to their database. Fun!&lt;/p&gt;

&lt;p&gt;Why get your taxonomic data programatically? Because it's 1) faster than by hand in web sites/looking up in books, 2) reproducible, especially if you share your code (damnit!), and 3) you can easily mash up your new taxonomic data to get sequences to build a phylogeny, etc.&lt;/p&gt;

&lt;p&gt;I'll give a few examples of using &lt;code&gt;taxize&lt;/code&gt; based around use cases, that is, stuff someone might actually do instead of what particular functions do.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;Install packages.  You can get from CRAN or GitHub.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# install.packages(&amp;quot;ritis&amp;quot;) # uncomment if not already installed&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;taxize_&amp;#39;, &amp;#39;ropensci&amp;#39;) # uncomment if not already installed&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# install.packages(&amp;quot;taxize&amp;quot;, type=&amp;quot;source&amp;quot;) # uncomment if not already installed&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ritis&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Attach family names to a list of species.&lt;/h3&gt;

&lt;h4&gt;I often have a list of species that I studied and simply want to get their family names to, for example, make a table for the paper I'm writing.&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# For one species&lt;/span&gt;
itis_name&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;query &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Poa annua&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; get &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;family&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Poa annua &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;[1] &amp;quot;Poaceae&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# For many species&lt;/span&gt;
species &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Poa annua&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Abies procera&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Helianthus annuus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Coffea arabica&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
famnames &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sapply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;species&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; itis_name&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; get &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;family&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; USE.NAMES &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Poa annua &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Abies procera &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Helianthus annuus &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Coffea arabica &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;data.frame&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;species &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; species&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; famnames&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;            species     family
1         Poa annua    Poaceae
2     Abies procera   Pinaceae
3 Helianthus annuus Asteraceae
4    Coffea arabica  Rubiaceae
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Resolve taxonomic names.&lt;/h3&gt;

&lt;h4&gt;This is a common use case for ecologists/evolutionary biologists, or at least should be. That is, species names you have for your own data, or when using other's data, could be old names - and if you need the newest names for your species list, how can you make this as painless as possible? You can query taxonomic data from many different sources with &lt;code&gt;taxize&lt;/code&gt;.&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# The iPlantCollaborative provides access via API to their taxonomic name&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# resolution service (TNRS)&lt;/span&gt;
mynames &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;shorea robusta&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;pandanus patina&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;oryza sativa&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;durio zibethinus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;rubus ulmifolius&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;asclepias curassavica&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;pistacia lentiscus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
iplant_tnrsmatch&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;retrieve &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;all&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; taxnames &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;helianthus annuus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;acacia&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;gossypium&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; output &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;names&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;       AcceptedName   MatchFam MatchGenus MatchScore    Accept?
1 Helianthus annuus Asteraceae Helianthus          1 No opinion
2            Acacia   Fabaceae     Acacia          1 No opinion
3                                  Acacia          1 No opinion
4         Gossypium  Malvaceae  Gossypium          1 No opinion
     SubmittedNames
1 helianthus annuus
2            acacia
3            acacia
4         gossypium
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# The global names resolver is another attempt at this, hitting many&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# different data sources&lt;/span&gt;
gnr_resolve&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;names &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Helianthus annuus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Homo sapiens&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; returndf &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;   data_source_id    submitted_name       name_string score
1               4 Helianthus annuus Helianthus annuus 0.988
3              10 Helianthus annuus Helianthus annuus 0.988
5              12 Helianthus annuus Helianthus annuus 0.988
8             110 Helianthus annuus Helianthus annuus 0.988
11            159 Helianthus annuus Helianthus annuus 0.988
13            166 Helianthus annuus Helianthus annuus 0.988
15            169 Helianthus annuus Helianthus annuus 0.988
2               4      Homo sapiens      Homo sapiens 0.988
4              10      Homo sapiens      Homo sapiens 0.988
6              12      Homo sapiens      Homo sapiens 0.988
7             107      Homo sapiens      Homo sapiens 0.988
9             122      Homo sapiens      Homo sapiens 0.988
10            123      Homo sapiens      Homo sapiens 0.988
12            159      Homo sapiens      Homo sapiens 0.988
14            168      Homo sapiens      Homo sapiens 0.988
16            169      Homo sapiens      Homo sapiens 0.988
                     title
1                     NCBI
3                 Freebase
5                      EOL
8     Illinois Wildflowers
11                 CU*STAR
13                   nlbif
15           uBio NameBank
2                     NCBI
4                 Freebase
6                      EOL
7                AskNature
9                 BioPedia
10                   AnAge
12                 CU*STAR
14 Index to Organism Names
16           uBio NameBank
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# We can hit the Plantminer API too&lt;/span&gt;
plants &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Myrcia lingua&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Myrcia bella&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Ocotea pulchella&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Miconia&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Coffea arabica var. amarella&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Bleh&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
plantminer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plants&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Myrcia lingua 
Myrcia bella 
Ocotea pulchella 
Miconia 
Coffea arabica var. amarella 
Bleh 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;              fam   genus                    sp             author
1       Myrtaceae  Myrcia                lingua   (O. Berg) Mattos
2       Myrtaceae  Myrcia                 bella           Cambess.
3       Lauraceae  Ocotea             pulchella (Nees &amp;amp; Mart.) Mez
4 Melastomataceae Miconia                    NA        Ruiz &amp;amp; Pav.
5       Rubiaceae  Coffea arabica var. amarella        A. Froehner
6              NA    Bleh                    NA                 NA
            source source.id   status confidence suggestion       database
1              TRO 100227036       NA         NA         NA       Tropicos
2             WCSP    131057 Accepted          H         NA The Plant List
3 WCSP (in review)    989758 Accepted          M         NA The Plant List
4              TRO  40018467       NA         NA         NA       Tropicos
5              TRO 100170231       NA         NA         NA       Tropicos
6               NA        NA       NA         NA       Baea             NA
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# We made a light wrapper around the Taxonstand package to search&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Theplantlist.org too&lt;/span&gt;
splist &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Heliathus annuus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Abies procera&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Poa annua&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Platanus occidentalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Carex abrupta&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Arctostaphylos canescens&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Ocimum basilicum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Vicia faba&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;Quercus kelloggii&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Lactuca serriola&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
tpl_search&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxon &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; splist&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;            Genus      Species Infraspecific Plant.Name.Index
1       Heliathus       annuus                          FALSE
2           Abies      procera                           TRUE
3             Poa        annua                           TRUE
4        Platanus occidentalis                           TRUE
5           Carex      abrupta                           TRUE
6  Arctostaphylos    canescens                           TRUE
7          Ocimum    basilicum                           TRUE
8           Vicia         faba                           TRUE
9         Quercus    kelloggii                           TRUE
10        Lactuca     serriola                           TRUE
   Taxonomic.status      Family      New.Genus  New.Species
1                                    Heliathus       annuus
2          Accepted    Pinaceae          Abies      procera
3          Accepted     Poaceae            Poa        annua
4          Accepted Platanaceae       Platanus occidentalis
5          Accepted  Cyperaceae          Carex      abrupta
6          Accepted   Ericaceae Arctostaphylos    canescens
7          Accepted   Lamiaceae         Ocimum    basilicum
8          Accepted Leguminosae          Vicia         faba
9          Accepted    Fagaceae        Quercus    kelloggii
10         Accepted  Compositae        Lactuca     serriola
   New.Infraspecific Authority  Typo WFormat
1                              FALSE   FALSE
2                       Rehder FALSE   FALSE
3                           L. FALSE   FALSE
4                           L. FALSE   FALSE
5               &amp;lt;NA&amp;gt;     Mack. FALSE   FALSE
6                       Eastw. FALSE   FALSE
7                           L. FALSE   FALSE
8                           L. FALSE   FALSE
9               &amp;lt;NA&amp;gt;     Newb. FALSE   FALSE
10                          L. FALSE   FALSE
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Taxonomic hierarchies&lt;/h3&gt;

&lt;h4&gt;I often want the full taxonomic hierarchy for a set of species. That is, give me the family, order, class, etc. for my list of species. There are two different easy ways to do this with &lt;code&gt;taxize&lt;/code&gt;. The first example uses EOL.&lt;/h4&gt;

&lt;hr /&gt;

&lt;h4&gt;Using EOL.&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;pageid &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; eol_search&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Quercus douglasii&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;id&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# first need to search for the taxon&amp;#39;s page on EOL&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; eol_pages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxonconceptID &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; pageid&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# then we nee to get the taxon ID used by EOL&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Notice that there are multiple different sources you can pull the&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# hierarchy from. Note even that you can get the hierarchy from the ITIS&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# service via this EOL API.&lt;/span&gt;
out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  identifier                 scientificName
1   46203061 Quercus douglasii Hook. &amp;amp; Arn.
2   48373995 Quercus douglasii Hook. &amp;amp; Arn.
                                  nameAccordingTo sourceIdentfier
1  Integrated Taxonomic Information System (ITIS)           19322
2 Species 2000 &amp;amp; ITIS Catalogue of Life: May 2012         9723391
  taxonRank
1   Species
2   Species
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Then the hierarchy!&lt;/span&gt;
eol_hierarchy&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;out&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;nameAccordingTo &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Species 2000 &amp;amp; ITIS Catalogue of Life: May 2012&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;identifier&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  sourceIdentifier  taxonID parentNameUsageID taxonConceptID
1         11017504 48276627                 0            281
2         11017505 48276628          48276627            282
3         11017506 48276629          48276628            283
4         11022500 48373354          48276629           4184
5         11025284 48373677          48373354           4197
  scientificName taxonRank
1        Plantae   kingdom
2  Magnoliophyta    phylum
3  Magnoliopsida     class
4        Fagales     order
5       Fagaceae    family
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;eol_hierarchy&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;out&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;nameAccordingTo &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Integrated Taxonomic Information System (ITIS)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s&quot;&gt;&amp;quot;identifier&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# and from ITIS, slightly different than ITIS output below, which includes taxa all the way down.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;   sourceIdentifier  taxonID parentNameUsageID taxonConceptID
1            202422 46150613                 0            281
2            846492 46159776          46150613        8654492
3            846494 46161961          46159776       28818077
4            846496 46167532          46161961           4494
5            846504 46169010          46167532       28825126
6            846505 46169011          46169010            282
7             18063 46169012          46169011            283
8            846548 46202954          46169012       28859070
9             19273 46202955          46202954           4184
10            19275 46203022          46202955           4197
    scientificName     taxonRank
1          Plantae       kingdom
2   Viridaeplantae    subkingdom
3     Streptophyta  infrakingdom
4     Tracheophyta      division
5  Spermatophytina   subdivision
6     Angiospermae infradivision
7    Magnoliopsida         class
8          Rosanae    superorder
9          Fagales         order
10        Fagaceae        family
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h4&gt;And getting a taxonomic hierarchy using ITIS.&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# First, get the taxonomic serial number (TSN) that ITIS uses&lt;/span&gt;
mytsn &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; get_tsn&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Quercus douglasii&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;sciname&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Quercus douglasii &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get the full taxonomic hierarchy for a taxon from the TSN&lt;/span&gt;
itis&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mytsn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;getfullhierarchyfromtsn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;$`1`
        parentName parentTsn      rankName         taxonName    tsn
1                                  Kingdom           Plantae 202422
2          Plantae    202422    Subkingdom    Viridaeplantae 846492
3   Viridaeplantae    846492  Infrakingdom      Streptophyta 846494
4     Streptophyta    846494      Division      Tracheophyta 846496
5     Tracheophyta    846496   Subdivision   Spermatophytina 846504
6  Spermatophytina    846504 Infradivision      Angiospermae 846505
7     Angiospermae    846505         Class     Magnoliopsida  18063
8    Magnoliopsida     18063    Superorder           Rosanae 846548
9          Rosanae    846548         Order           Fagales  19273
10         Fagales     19273        Family          Fagaceae  19275
11        Fagaceae     19275         Genus           Quercus  19276
12         Quercus     19276       Species Quercus douglasii  19322
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# But this can be even easier!&lt;/span&gt;
classification&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;get_tsn&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Quercus douglasii&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Boom!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;Retrieving data for species &amp;#39; Quercus douglasii &amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;$`1`
        parentName parentTsn      rankName         taxonName    tsn
1                                  Kingdom           Plantae 202422
2          Plantae    202422    Subkingdom    Viridaeplantae 846492
3   Viridaeplantae    846492  Infrakingdom      Streptophyta 846494
4     Streptophyta    846494      Division      Tracheophyta 846496
5     Tracheophyta    846496   Subdivision   Spermatophytina 846504
6  Spermatophytina    846504 Infradivision      Angiospermae 846505
7     Angiospermae    846505         Class     Magnoliopsida  18063
8    Magnoliopsida     18063    Superorder           Rosanae 846548
9          Rosanae    846548         Order           Fagales  19273
10         Fagales     19273        Family          Fagaceae  19275
11        Fagaceae     19275         Genus           Quercus  19276
12         Quercus     19276       Species Quercus douglasii  19322
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# You can also do this easy-peasy route to a taxonomic hierarchy using&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# uBio&lt;/span&gt;
classification&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;get_uid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Ornithorhynchus anatinus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;$`1`
       ScientificName         Rank    UID
1  cellular organisms      no rank 131567
2           Eukaryota superkingdom   2759
3        Opisthokonta      no rank  33154
4             Metazoa      kingdom  33208
5           Eumetazoa      no rank   6072
6           Bilateria      no rank  33213
7           Coelomata      no rank  33316
8       Deuterostomia      no rank  33511
9            Chordata       phylum   7711
10           Craniata    subphylum  89593
11         Vertebrata      no rank   7742
12      Gnathostomata   superclass   7776
13         Teleostomi      no rank 117570
14       Euteleostomi      no rank 117571
15      Sarcopterygii      no rank   8287
16          Tetrapoda      no rank  32523
17            Amniota      no rank  32524
18           Mammalia        class  40674
19        Prototheria      no rank   9254
20        Monotremata        order   9255
21  Ornithorhynchidae       family   9256
22    Ornithorhynchus        genus   9257
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h3&gt;Sequences?&lt;/h3&gt;

&lt;h4&gt;While you are at doing taxonomic stuff, you often wonder &quot;hmmm, I wonder if there are any sequence data available for my species?&quot; So, you can use &lt;code&gt;get_seqs&lt;/code&gt; to search for specific genes for a species, and &lt;code&gt;get_genes_avail&lt;/code&gt; to find out what genes are available for a certain species. These functions search for data on &lt;a href=&quot;http://www.ncbi.nlm.nih.gov/&quot;&gt;NCBI&lt;/a&gt;.&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get sequences (sequence is provied in output, but hiding here for&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# brevity). What&amp;#39;s nice about this is that it gets the longest sequence&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# avaialable for the gene you searched for, and if there isn&amp;#39;t anything&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# available, it lets you get a sequence from a congener if you set&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# getrelated=TRUE. The last column in the output data.frame also tells you&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# what species the sequence is from.&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; get_seqs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxon_name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Acipenser brevirostrum&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; gene &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;5S rRNA&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
    seqrange &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;1:3000&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; getrelated &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; writetodf &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
out&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;names&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;sequence&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;                   taxon                                         gene_desc
1 Acipenser brevirostrum Acipenser brevirostrum 5S rRNA gene, clone BRE92A
     gi_no     acc_no length                 spused
1 60417159 AJ745069.1    121 Acipenser brevirostrum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Search for available sequences&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; get_genes_avail&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxon_name &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Umbra limi&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; seqrange &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;1:2000&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; getrelated &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
out&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;grep&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;RAG1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; out&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;genesavail&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ignore.case &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# does the string &amp;#39;RAG1&amp;#39; exist in any of the gene names&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;        spused length
414 Umbra limi    732
427 Umbra limi    959
434 Umbra limi   1631
                                                                            genesavail
414 isolate UlimA recombinase activating protein 1 (rag1) gene, exon 3 and partial cds
427           recombination-activating protein 1 (RAG1) gene, intron 2 and partial cds
434                        recombination-activating protein 1 (RAG1) gene, partial cds
    predicted
414  JX190826
427  AY459526
434  AY380548
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-12-06-taxize.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-12-06-taxize.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-12-06 00:00:00 -0800</published>
				<link>http://schamberlain.github.com/2012/12/taxize/</link>
			</item>
		
			<item>
				<title>Displaying Your Data in Google Earth Using R2G2</title>
				<description>&lt;p&gt;Have you ever wanted to easily visualize your ecology data in &lt;a href=&quot;http://earth.google.com&quot;&gt;Google Earth&lt;/a&gt;?  &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt; is a new package for R, available via &lt;a href=&quot;http://cran.r-project.org/&quot;&gt;R CRAN&lt;/a&gt; and formally described in &lt;a href=&quot;http://onlinelibrary.wiley.com/doi/10.1111/1755-0998.12012/abstract&quot;&gt;this Molecular Ecology Resources article&lt;/a&gt;, which provides a user-friendly bridge between R and the Google Earth interface.  Here, we will provide a brief introduction to the package, including a short tutorial, and then encourage you to try it out with your own data!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://barkerlab.net/nils.html&quot;&gt;Nils Arrigo&lt;/a&gt;, with some help from &lt;a href=&quot;http://portal.environment.arizona.edu/students/profiles/loren-albert&quot;&gt;Loren Albert&lt;/a&gt;, &lt;a href=&quot;http://barkerlab.net/mike.html&quot;&gt;Mike Barker&lt;/a&gt;, and Pascal Mickelson (one of the contributors to &lt;a href=&quot;http://schamberlain.github.com/about.html&quot;&gt;Recology&lt;/a&gt;), has created a set of R tools to generate KML files to view data with geographic components.  Instead of just telling you what the tools can do, though, we will show you a couple of examples using publically available data.  Note: a number of individual files are linked to throughout the tutorial below, but just in case you would rather download all the tutorial files in one go, have at it (&lt;a href=&quot;/img/R2G2tutorial/R2G2tutorial.zip&quot;&gt;tutorial zip file&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Among the basic tools in &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt; is the ability to place features—like dots, shapes, or images (including plots you produced in R)— that represent discrete observations at specific geographical locations.  For example, in the figure below, we show the migratory path of a particular turkey vulture in autumn of three successive years (red = 2009; blue = 2010; green = 2011).&lt;/p&gt;

&lt;div align=&quot;center&quot;&gt;
&lt;img src=&quot;/img/R2G2tutorial/Vulture_Path.jpg&quot; alt=&quot;Google Earth image with three successive years of a particular turkey vulture's migration&quot; width=&quot;800&quot;&gt;&lt;br&gt;
&lt;small&gt;Google Earth imagery showing migratory path of a particular turkey vulture in 2009, 2010, and 2011.&lt;/small&gt;
&lt;/div&gt;


&lt;p&gt;&lt;/p&gt;

&lt;p&gt;We use the &lt;em&gt;PolyLines2GE&lt;/em&gt; function that is part of &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt; to create line segments between the geographical coordinates which have been obtained from a turkey vulture tagged with a transponder (data accessed via the &lt;a href=&quot;http://movebank.org/&quot;&gt;Movebank Data Repository&lt;/a&gt; and is from the &lt;a href=&quot;http://movebank.org/movebank/#page%3Dstudies%2Cpath%3Dstudy481458&quot;&gt;Turkey Vulture Acopian Center USA GPS&lt;/a&gt;).  The &lt;em&gt;PolyLines2GE&lt;/em&gt; function looks like the following:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;PolyLines2GE&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;coords &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vulture_path&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
            nesting &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vulture_path&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
            colors &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;auto&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            goo &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Vulture_Path.kml&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            maxAlt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1e4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            closepoly &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            lwd &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
            extrude &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It expects to receive an array (&quot;coords&quot;) containing latitude and longitude coordinates in decimal degrees. Additionally, each individual coordinate has a flag associated with it (&quot;nesting&quot;) so that each data series can be distinguished.  Illustrating what you need is easier than explaining:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;nesting longitude latitude
1   long1A      lat1A
1   long1B      lat1B
1   long1C      lat1C
2   long2A      lat2A
2   long2B      lat2B
3   long3A      lat3A
3   long3B      lat3B
3   long3C      lat3C
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Feeding the columns of this array to the function results in three differently colored lines:  the first would connect the coordinates 1A-1B-1C, while the second would connect 2A-2B, and the third would connect 3A-3B-3C.  The only other user-defined input that is strictly necessary is the output file name (&quot;Vulture_Path.kml&quot; in this case).  The other options—which allow you control of the appearance of the lines and of the altitude at which your line displays in Google Earth—have reasonable defaults that are well-documented in the function definition itself.  Check out this example in Google Earth &lt;a href=&quot;/img/R2G2tutorial/Vulture_Path.kml&quot;&gt;by downloading the KML file&lt;/a&gt;.  Alternatively, &lt;a href=&quot;/img/R2G2tutorial/Vulture_Path.R&quot;&gt;download the annotated R script&lt;/a&gt; and generate the KML file for yourself.&lt;/p&gt;

&lt;p&gt;Now, let's say you wanted to get a sense of the range and abundance of two congeneric species.  In this second example, we use the &lt;em&gt;Hist2GE&lt;/em&gt; function to create a histogram—overlaid on the surface of the earth—which shows the species distribution of &lt;em&gt;Mimulus lewisii&lt;/em&gt; (red) and &lt;em&gt;Mimulus nasutus&lt;/em&gt; (blue) in North America.&lt;/p&gt;

&lt;div align=&quot;center&quot;&gt;
&lt;img src=&quot;/img/R2G2tutorial/Mimulus_Distribution.jpg&quot; alt=&quot;Google Earth image showing the distribution of Mimulus in North America&quot; width=&quot;800&quot;&gt;&lt;br&gt;
&lt;small&gt;Google Earth imagery showing the species distribution of &lt;em&gt;Mimulus lewisii&lt;/em&gt; and &lt;em&gt;Mimulus nasutus&lt;/em&gt;&lt;/small&gt;
&lt;/div&gt;


&lt;p&gt;&lt;/p&gt;

&lt;p&gt;As you might expect, each polygon represents an occurrence of the species in question, while the height of the polygon represents the abundance of the species at that geographic location.  Species occurring within a particular distance of each other have been grouped together for the histogram.  For this example, we retrieve data from the &lt;a href=&quot;http://data.gbif.org/&quot;&gt;GBIF&lt;/a&gt; database from within R (see the example code for how that is done).  Inputs to the Hist2GE function are:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;Hist2GE&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;coords &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; MyCompleteData&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
        species &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; MyCompleteData&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
        grid &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; grid10000&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
        goo &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Mimulus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
        nedges &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
        orient &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
        maxAlt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1e4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;As in the first example, the function expects to receive an array containing the longitude and latitude (&quot;coords&quot;), a vector distinguishing individual observations (&quot;species&quot;), and an output file name (&quot;goo&quot;).  In this case, however, we also need to specify the size of the grid we will use to group observations together to construct the histogram.  Several pre-defined grid sizes are included in the package to do this grouping; these all cover large geographic areas and therefore must account for the curvature of the earth.  Here is a list of these pre-defined grids:&lt;/p&gt;

&lt;table border=&quot;1&quot;&gt;
    &lt;tr&gt;&lt;th&gt;Grid Name&lt;/th&gt;&lt;th&gt;Approximate Area of Grid Division &lt;/th&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;grid20000&lt;/td&gt;&lt;td&gt;25,500 sq. km&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;grid10000&lt;/td&gt;&lt;td&gt;51,000 sq. km&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;grid5000&lt;/td&gt;&lt;td&gt;102,000 sq. km&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;grid500&lt;/td&gt;&lt;td&gt;1,020,000 sq. km&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;grid50&lt;/td&gt;&lt;td&gt;10,200,000 sq. km&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;


&lt;p&gt;&lt;/p&gt;

&lt;p&gt;For smaller geographic areas (less than 25,000 square kilometers, or an area of about 158 km per side), you can customize the grid size by specifying the bounds of your region of interest in decimal degrees, as well as the coarseness of the grid within that region.  While it is possible to use this custom grid definition for larger sizes, beware that not all areas defined thusly will be of equal size due to the earth's curvature (obviously the bigger you go, the worse it gets...).  Finally, you again have control over the display parameters of the histogram.  In particular, the maximum altitude (&quot;maxAlt&quot;) controls how high the tallest bar in the histogram will go.  Here is &lt;a href=&quot;/img/R2G2tutorial/Mimulus_Distribution.kml&quot;&gt;the resulting KML file&lt;/a&gt;, as well as &lt;a href=&quot;/img/R2G2tutorial/Mimulus_Distribution.R&quot;&gt;the annotated R script&lt;/a&gt; so you can further explore the example.&lt;/p&gt;

&lt;p&gt;More complex visual representations are also possible using &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt;.  For instance, you can also create contour plots or phylogenies overlaid directly on the surface of the earth.  We included a couple examples of this type in &lt;a href=&quot;http://onlinelibrary.wiley.com/doi/10.1111/1755-0998.12012/abstract&quot;&gt;our Molecular Ecology Resources article&lt;/a&gt;, and if the response seems good, we may post a follow up tutorial showing how we went about creating those examples.&lt;/p&gt;

&lt;p&gt;It is our sincere hope that you will use the tools in &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt; to more effectively visualize the geographical aspects of your data.  In particular, we are excited about the potential for incorporating &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt; into data analysis pipelines connecting analysis in R with data visualization and exploration in Google Earth.  Ultimately, the inclusion of KML files as supplementary materials to journal articles should also enrich one's understanding of the data being presented!&lt;/p&gt;

&lt;p&gt;&lt;big&gt;&lt;b&gt;Note:  If you make something cool using &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt;, please post a link to your KML file in the comments; we would love to see!&lt;/b&gt;&lt;/big&gt;&lt;/p&gt;

&lt;p&gt;Citation information for &lt;a href=&quot;http://cran.r-project.org/web/packages/R2G2/index.html&quot;&gt;R2G2&lt;/a&gt;:&lt;br/&gt;
&lt;em&gt;Arrigo, N., Albert, L. P., Mickelson, P. G. and Barker, M. S. (2012), Quantitative visualization of biological data in Google Earth using R2G2, an R CRAN package. Molecular Ecology Resources. doi: 10.1111/1755-0998.12012&lt;/em&gt;&lt;/p&gt;
</description>
				<published>2012-10-24 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/10/R2G2-package/</link>
			</item>
		
			<item>
				<title>Getting taxonomic names downstream</title>
				<description>&lt;p&gt;It can be a pain in the ass to get taxonomic names. For example, I sometimes need to get all the Class names for a set of species.  This is a relatively easy problem using the &lt;a href=&quot;http://www.itis.gov/ws_description.html&quot;&gt;ITIS API&lt;/a&gt; (example below).&lt;/p&gt;

&lt;p&gt;The much harder problem is getting all the taxonomic names downstream. ITIS doesn't provide an API method for this - well, they do (&lt;a href=&quot;http://www.itis.gov/ws_hierApiDescription.html#getHierarchyDn&quot;&gt;&lt;code&gt;getHirerachyDownFromTSN&lt;/code&gt;&lt;/a&gt;), but it only provides direct children (e.g., the genera within a tribe - but it won't give all the species within each genus).&lt;/p&gt;

&lt;p&gt;So in the &lt;code&gt;taxize&lt;/code&gt; package, we wrote a function called &lt;code&gt;downstream&lt;/code&gt;, which allows you to get taxonomic names to any downstream point, e.g.:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;get all Classes within Animalia,&lt;/li&gt;
&lt;li&gt;get all Species within a Family&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;Install packages.  You can get other packages from CRAN, but taxize is only on GitHub for now.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;ritis&amp;#39;, &amp;#39;ropensci&amp;#39;) # uncomment if not already installed&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;taxize_&amp;#39;, &amp;#39;ropensci&amp;#39;) # uncomment if not already&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# installed&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ritis&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxize&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Get upstream taxonomic names.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Search for a TSN by scientific name&lt;/span&gt;
df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; searchbyscientificname&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Tardigrada&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
tsn &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;combinedname &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Tardigrada&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;tsn&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get just one immediate higher taxonomic name&lt;/span&gt;
gethierarchyupfromtsn&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tsn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; tsn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  parentName parentTsn rankName  taxonName    tsn
1   Animalia    202423   Phylum Tardigrada 155166
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get full hierarchy upstream from TSN&lt;/span&gt;
getfullhierarchyfromtsn&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tsn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; tsn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  parentName parentTsn rankName        taxonName    tsn
1                       Kingdom         Animalia 202423
2   Animalia    202423   Phylum       Tardigrada 155166
3 Tardigrada    155166    Class     Eutardigrada 155362
4 Tardigrada    155166    Class Heterotardigrada 155167
5 Tardigrada    155166    Class   Mesotardigrada 155358
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Get taxonomc names downstream.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get genera downstream fromthe Class Bangiophyceae&lt;/span&gt;
downstream&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;846509&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Genus&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;    tsn parentName parentTsn   taxonName rankId rankName
1 11531 Bangiaceae     11530      Bangia    180    Genus
2 11540 Bangiaceae     11530    Porphyra    180    Genus
3 11577 Bangiaceae     11530 Porphyrella    180    Genus
4 11580 Bangiaceae     11530 Conchocelis    180    Genus
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get families downstream from Acridoidea&lt;/span&gt;
downstream&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;650497&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Family&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;      tsn parentName parentTsn      taxonName rankId rankName
1  102195 Acridoidea    650497      Acrididae    140   Family
2  650502 Acridoidea    650497     Romaleidae    140   Family
3  657472 Acridoidea    650497    Charilaidae    140   Family
4  657473 Acridoidea    650497   Lathiceridae    140   Family
5  657474 Acridoidea    650497     Lentulidae    140   Family
6  657475 Acridoidea    650497    Lithidiidae    140   Family
7  657476 Acridoidea    650497   Ommexechidae    140   Family
8  657477 Acridoidea    650497    Pamphagidae    140   Family
9  657478 Acridoidea    650497  Pyrgacrididae    140   Family
10 657479 Acridoidea    650497    Tristiridae    140   Family
11 657492 Acridoidea    650497 Dericorythidae    140   Family
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get species downstream from Ursus&lt;/span&gt;
downstream&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;180541&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Species&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;     tsn parentName parentTsn        taxonName rankId rankName
1 180542      Ursus    180541  Ursus maritimus    220  Species
2 180543      Ursus    180541     Ursus arctos    220  Species
3 180544      Ursus    180541 Ursus americanus    220  Species
4 621850      Ursus    180541 Ursus thibetanus    220  Species
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-10-16-get-taxa-downstream.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-10-16-get-taxa-downstream.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-10-16 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/10/get-taxa-downstream/</link>
			</item>
		
			<item>
				<title>Exploring phylogenetic tree balance metrics</title>
				<description>&lt;p&gt;I need to simulate balanced and unbalanced phylogenetic trees for some research I am doing.  In order to do this, I do rejection sampling: simulate a tree -&gt; measure tree shape -&gt; reject if not balanced or unbalanced &lt;strong&gt;enough&lt;/strong&gt;.  But what is enough?  We need to define some cutoff value to determine what will be our set of balanced and unbalanced trees.&lt;/p&gt;

&lt;h3&gt;A function to calculate shape metrics, and a custom theme for plottingn phylogenies.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;foo &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; metric &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;colless&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;metric &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;colless&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        xx &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; as.treeshape&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# convert to apTreeshape format&lt;/span&gt;
        colless&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xx&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;yule&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# calculate colless&amp;#39; metric&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;metric &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        gammaStat&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt; stop&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;metric should be one of colless or gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

theme_myblank &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    stopifnot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;require&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    theme_blank &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot2&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;theme_blank
    ggplot2&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;theme&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;panel.grid.major &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; panel.grid.minor &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
        panel.background &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; plot.background &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
        axis.title.x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;NA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; axis.title.y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
        axis.text.x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; axis.text.y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; axis.line &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
        axis.ticks &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_blank&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Simulate some trees&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ape&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;phytools&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

numtrees &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# lets simulate 1000 trees&lt;/span&gt;
trees &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; pbtree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; nsim &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; numtrees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ape &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# simulate 500 pure-birth trees with 100 spp each, ape = F makes it run faster&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Calculate Colless' shape metric on each tree&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;apTreeshape&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

colless_df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ldply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; foo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; metric &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;colless&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# calculate metric for each tree&lt;/span&gt;
head&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;       V1
1 -0.1761
2  0.2839
3  0.4639
4  0.9439
5 -0.6961
6 -0.1161
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Calculate the percent of trees that will fall into the cutoff for balanced and unbalanced trees&lt;/span&gt;
col_percent_low &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; round&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;colless_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1 &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;V1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;numtrees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
col_percent_high &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; round&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;colless_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;V1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;numtrees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Create a distribution of the metric values&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

a &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# plot histogram of distribution of values&lt;/span&gt;
    geom_histogram&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    theme_bw&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;base_size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    scale_x_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; breaks&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; linetype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;longdash&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; linetype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;longdash&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    ggtitle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;paste0&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Distribution of Colless&amp;#39; metric for 1000 trees, cutoffs at -0.7 and 0.7 results in\n &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; col_percent_low&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;% (&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numtrees&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;col_percent_low&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;) &amp;#39;balanced&amp;#39; trees (left) and &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; col_percent_low&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;% (&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numtrees&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;col_percent_low&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;) &amp;#39;unbalanced&amp;#39; trees (right)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;  
    labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Colless&amp;#39; Metric Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Number of phylogenetic trees&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    theme&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plot.title  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

a
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/collesshist.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;Create phylogenies representing balanced and unbalanced trees (using the custom theme)&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggphylo&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

b &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggphylo&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;which.min&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; do.plot &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_myblank&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
c &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggphylo&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;which.max&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colless_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; do.plot &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_myblank&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/collessphylog.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;Now, put it all together in one plot using some gridExtra magic.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gridExtra&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

grid.newpage&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
pushViewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;layout &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; grid.layout&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
vpa_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.49&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
vpb_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
vpc_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.82&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpa_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpb_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpc_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/collessall.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;And the same for Gamma stat, which measures the distribution of nodes in time.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;gamma_df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ldply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; foo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; metric&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;gamma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# calculate metric for each tree&lt;/span&gt;
gam_percent_low &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; round&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamma_df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;gamma_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1 &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;V1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;numtrees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
gam_percent_high &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; round&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamma_df&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;gamma_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;V1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;numtrees&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;
a &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamma_df&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# plot histogram of distribution of values&lt;/span&gt;
    geom_histogram&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    theme_bw&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;base_size&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    scale_x_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;breaks&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; linetype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;longdash&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; linetype &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;longdash&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    ggtitle&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;paste0&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Distribution of Gamma metric for 1000 trees, cutoffs at -1 and 1 results in\n &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; gam_percent_low&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;% (&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numtrees&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gam_percent_low&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;) trees with deeper nodes (left) and &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; gam_percent_high&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;% (&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; numtrees&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gam_percent_high&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;) trees with shallower nodes (right)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;  
    labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Gamma Metric Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Number of phylogenetic trees&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
    theme&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plot.title  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; element_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
b &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggphylo&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;which.min&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamma_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; do.plot&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_myblank&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
c &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ggphylo&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;trees&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;which.max&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamma_df&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;V1&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; do.plot&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k-Variable&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theme_myblank&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

grid.newpage&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
pushViewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;layout &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; grid.layout&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
vpa_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.49&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
vpb_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
vpc_ &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; viewport&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.82&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpa_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpb_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
print&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vp &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; vpc_&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/gammaall.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-10-10-phylogenetic-tree-balance.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-10-10-phylogenetic-tree-balance.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-10-10 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/10/phylogenetic-tree-balance/</link>
			</item>
		
			<item>
				<title>GBIF biodiversity data from R - more functions</title>
				<description>&lt;h4&gt;UPDATE: In response to Jarrett's query I laid out a separate use case in which you may want to query by higher taxonomic rankings than species. See below.  In addition, added examples of querying by location in reply to comments by seminym.&lt;/h4&gt;

&lt;hr /&gt;

&lt;p&gt;We have been working on an R package to get GBIF data from R, with the stable version available through CRAN &lt;a href=&quot;URL&quot;&gt;here&lt;/a&gt;, and the development version available on GitHub &lt;a href=&quot;http://github.com/rgbif&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We had a Google Summer of code stuent work on the package this summer - you can see his work on the package over at his GitHub page &lt;a href=&quot;&quot;&gt;here&lt;/a&gt;.  We have added some new functionality since his work, and would like to show it off.&lt;/p&gt;

&lt;h3&gt;Lets install rgbif first.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;rgbif&amp;#39;, &amp;#39;ropensci&amp;#39;) # uncomment if not already installed&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rgbif&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;plyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;XML&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;httr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;maps&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Get taxonomic information on a specific taxon or taxa in GBIF by their taxon concept keys.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;keys &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; taxonsearch&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;scientificname &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Puma concolor&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# many matches to this search&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt; [1] &amp;quot;51780668&amp;quot; &amp;quot;51758018&amp;quot; &amp;quot;50010499&amp;quot; &amp;quot;51773067&amp;quot; &amp;quot;51078815&amp;quot; &amp;quot;51798065&amp;quot;
 [7] &amp;quot;51088007&amp;quot; &amp;quot;50410780&amp;quot; &amp;quot;50305290&amp;quot; &amp;quot;51791438&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;taxonget&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;keys&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# let&amp;#39;s get the first one - the first row in the data.frame is the one we searched for (51780668)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;[[1]]
                    sciname taxonconceptkeys       rank
1             Puma concolor         51780668    species
2                      Puma         51780667      genus
3                   Felidae         51780651     family
4                 Carnivora         51780613      order
5                  Mammalia         51780547      class
6                  Chordata         51775774     phylum
7                  Animalia         51775773    kingdom
8 Puma concolor californica         51780669 subspecies
9   Puma concolor improcera         51780670 subspecies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;The &lt;code&gt;occurrencedensity&lt;/code&gt; function was renamed to &lt;code&gt;densitylist&lt;/code&gt; because it is in the &lt;code&gt;density&lt;/code&gt; API service, not the &lt;code&gt;occurrence&lt;/code&gt; API service.  You can use &lt;code&gt;densitylist&lt;/code&gt; to get a data.frame of total occurrence counts by one-degree cell for a single taxon, country, dataset, data publisher or data network.  Just a quick reminder of what the function can do:&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;head&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;densitylist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CA&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  cellid minLatitude maxLatitude minLongitude maxLongitude count
1  46913          40          41          -67          -66    44
2  46914          40          41          -66          -65   907
3  46915          40          41          -65          -64   510
4  46916          40          41          -64          -63   645
5  46917          40          41          -63          -62    56
6  46918          40          41          -62          -61   143
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Using a related function, &lt;code&gt;density_spplist&lt;/code&gt;, you can get a species list by one-degree cell as well.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get a species list by cell, choosing one at random&lt;/span&gt;
density_spplist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CO&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; spplist &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;random&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt; [1] &amp;quot;Abarema laeta (Benth.) Barneby &amp;amp; J.W.Grimes&amp;quot;
 [2] &amp;quot;Abuta grandifolia (Mart.) Sandwith&amp;quot;         
 [3] &amp;quot;Acalypha cuneata Poepp.&amp;quot;                    
 [4] &amp;quot;Acalypha diversifolia Jacq.&amp;quot;                
 [5] &amp;quot;Acalypha macrostachya Jacq.&amp;quot;                
 [6] &amp;quot;Acalypha stachyura Pax&amp;quot;                     
 [7] &amp;quot;Acanthoscelio acutus&amp;quot;                       
 [8] &amp;quot;Accipiter collaris&amp;quot;                         
 [9] &amp;quot;Actitis macularia&amp;quot;                          
[10] &amp;quot;Adelobotrys klugii Wurdack&amp;quot;                 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# density_spplist(originisocountrycode = &amp;#39;CO&amp;#39;, spplist = &amp;#39;r&amp;#39;) # can&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# abbreviate the `spplist` argument&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get a species list by cell, choosing the one with the greatest no. of&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# records&lt;/span&gt;
density_spplist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CO&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; spplist &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;great&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# great is abbreviated from `greatest`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt; [1] &amp;quot;Acanthaceae Juss.&amp;quot;                
 [2] &amp;quot;Accipitridae sp.&amp;quot;                 
 [3] &amp;quot;Accipitriformes/Falconiformes sp.&amp;quot;
 [4] &amp;quot;Apodidae sp.&amp;quot;                     
 [5] &amp;quot;Apodidae sp. (large swift sp.)&amp;quot;   
 [6] &amp;quot;Apodidae sp. (small swift sp.)&amp;quot;   
 [7] &amp;quot;Arctiinae&amp;quot;                        
 [8] &amp;quot;Asteraceae Bercht. &amp;amp; J. Presl&amp;quot;    
 [9] &amp;quot;Asteraceae sp. 1&amp;quot;                 
[10] &amp;quot;Asteraceae sp. 6&amp;quot;                 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Can also get a data.frame with counts instead of the species list&lt;/span&gt;
density_spplist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CO&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; spplist &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;great&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; listcount &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;counts&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;                              names_ count
1                  Acanthaceae Juss.     2
2                   Accipitridae sp.     6
3  Accipitriformes/Falconiformes sp.     2
4                       Apodidae sp.     5
5     Apodidae sp. (large swift sp.)     8
6     Apodidae sp. (small swift sp.)     5
7                          Arctiinae     7
8      Asteraceae Bercht. &amp;amp; J. Presl     2
9                   Asteraceae sp. 1     6
10                  Asteraceae sp. 6    10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;You can now map point results, from fxns &lt;code&gt;occurrencelist&lt;/code&gt; and those from &lt;code&gt;densitylist&lt;/code&gt;, which plots them as points or as tiles, respectively.  Point map, using output from occurrencelist.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; occurrencelist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;scientificname &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Puma concolor&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; coordinatestatus &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    maxresults &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; latlongdf &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;input &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# make a map, plotting on world map&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/gbifmap1.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;Point map, using output from occurrencelist, with many species plotted as different colors&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;splist &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Accipiter erythronemius&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Junco hyemalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Aix sponsa&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Buteo regalis&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lapply&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;splist&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; occurrencelist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; coordinatestatus &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maxresults &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    latlongdf &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/gbifmap2.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;Tile map, using output from densitylist, using results in Canada only.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;out2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; densitylist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CA&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# data for Canada&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# on world map&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/gbifmap31.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; region &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Canada&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# on Canada map&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/gbifmap32.png&quot; alt=&quot;NA&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;We can also query by higher taxonomic rankings, and map all lower species within that ranking. Above we queried by scientificname, but we can also query by higher taxonomy. 7071443 is the taxonconceptkey for 'Bacillariophyceae', a Class which includes many lower species.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; densitylist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;taxonconceptKey &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;7071443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/algae.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;seminym asked about querying by area. You can query by area, though slightly differently for occurrencelist and densitylist functions. For occurrencelist you can search using min and max lat and long values (and min an max altitude, pretty cool, eh).&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get occurrences or density by area, using min/max lat/long coordinates&lt;/span&gt;
out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; occurrencelist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;minlatitude &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maxlatitude &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; minlongitude &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    maxlongitude &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-95&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; coordinatestatus &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; maxresults &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; latlongdf &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k-Variable&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Using `geom_point`&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;texas&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/byarea_occurr1.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Using geom_jitter to move the points apart from one another&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;texas&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geom_jitter&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position_jitter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/byarea_occurr2.png&quot; alt=&quot;NA&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# And move points a lot&lt;/span&gt;
gbifmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;state&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;texas&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; geom_jitter&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; position_jitter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;width &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/byarea_occurr3.png&quot; alt=&quot;NA&quot; /&gt;&lt;/p&gt;

&lt;h3&gt;And you can query by area in &lt;code&gt;densitylist&lt;/code&gt; by specifying a place using the &lt;code&gt;originisocountrycode&lt;/code&gt; argument (as done in an above example).  Just showing the head of the data.frame here.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Get density by place, note that you can&amp;#39;t use the lat and long arguments&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# in densitylist&lt;/span&gt;
head&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;densitylist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;originisocountrycode &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;CA&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;  cellid minLatitude maxLatitude minLongitude maxLongitude count
1  46913          40          41          -67          -66    44
2  46914          40          41          -66          -65   907
3  46915          40          41          -65          -64   510
4  46916          40          41          -64          -63   645
5  46917          40          41          -63          -62    56
6  46918          40          41          -62          -61   143
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-10-08-rgbif-newfxns.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-10-08-rgbif-newfxns.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-10-08 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/10/rgbif-newfxns/</link>
			</item>
		
			<item>
				<title>Vertnet - getting vertebrate museum record data and a quick map</title>
				<description>&lt;p&gt;We (&lt;a href=&quot;http://ropensci.org/&quot;&gt;rOpenSci&lt;/a&gt;) started a repo to wrap the API for &lt;a href=&quot;http://vertnet.org/index.php&quot;&gt;VertNet&lt;/a&gt;, an open access online database of vertebrate specimen records across many collection holders. Find the open source code &lt;a href=&quot;https://github.com/ropensci/rvertnet&quot;&gt;here&lt;/a&gt; - please contribute if you are so inclined.  We had a great Google Summer of Code student, &lt;a href=&quot;http://vijaybarve.wordpress.com/&quot;&gt;Vijay Barve&lt;/a&gt; contributing to the repo this summer, so it is getting close to being CRAN-able.&lt;/p&gt;

&lt;p&gt;Most of the functions in the repo get you the raw data, but there were no functions to visualize the data.  Since much of the data records of latitude and longitude data, maps are a natural visualization to use.&lt;/p&gt;

&lt;p&gt;What follows is a quick example of using the basic &lt;code&gt;vertmap&lt;/code&gt; function.&lt;/p&gt;

&lt;h3&gt;First, let's install &lt;code&gt;rvertnet&lt;/code&gt;&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# install_github(&amp;#39;rvertnet&amp;#39;, &amp;#39;ropensci&amp;#39;) # uncomment if not installed&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# already&lt;/span&gt;
library&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rvertnet&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;First, let's get some data using &lt;code&gt;vertoccurrence&lt;/code&gt;&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;out &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; vertoccurrence&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;q &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;larva&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; num &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# get records on keyword &amp;#39;larva&amp;#39;, limit to 100&lt;/span&gt;
nrow&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# how many rows?&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;




&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;text&quot;&gt;[1] 100
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Now map it using &lt;code&gt;vertmap&lt;/code&gt;.  This is a very basic function: it simply cleans up the input data.frame, removing rows without lat/long data, and providing warnings when the input data.frame is not in the correct format.  &lt;code&gt;vertmap&lt;/code&gt; uses the &lt;code&gt;ggplot2&lt;/code&gt; framework for the map.  If you want to make you own map please do so -  this is just a simple fxn to get you started if you want to take a quick look at the data.&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;r&quot;&gt;vertmap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;input &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; out&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# make a map using vertmap&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img src=&quot;/img/vertmap.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-09-19-rvertnet.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-09-19-rvertnet.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;, and nice knitr highlighting/etc. in in &lt;a href=&quot;http://rstudio.org/&quot;&gt;RStudio&lt;/a&gt;.&lt;/h4&gt;
</description>
				<published>2012-09-19 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/09/rvertnet/</link>
			</item>
		
			<item>
				<title>Getting data from figures in published papers</title>
				<description>&lt;h2&gt;The problem:&lt;/h2&gt;

&lt;p&gt;There are a lot of figures in published papers in the scholarly literature, like the below, from (Attwood &lt;em&gt;et. al.&lt;/em&gt; 2012)):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/getfig2.png&quot; alt=&quot;alt text&quot; /&gt;&lt;/p&gt;

&lt;p&gt;At some point, a scientist wants to ask a question for which they can synthesize the knowledge on that question by collecting data from the published literature.  This often requires something like the following workflow:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Search for relevant papers (e.g., via Google Scholar).&lt;/li&gt;
&lt;li&gt;Collect the papers.&lt;/li&gt;
&lt;li&gt;Decide which are appropriate for inclusion.&lt;/li&gt;
&lt;li&gt;Collect data from the figures using software on a native application.  Examples include &lt;a href=&quot;http://www.arizona-software.ch/graphclick/&quot;&gt;GraphClick&lt;/a&gt; and &lt;a href=&quot;http://rsbweb.nih.gov/ij/&quot;&gt;ImageJ&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Proof data.&lt;/li&gt;
&lt;li&gt;Analyze data &amp;amp; publish paper.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This workflow needs revamping, particularly in step number 3 - collecting the data.  This data remains private, moving from one closed source (original publication) to another (personal computer).  We can surely do better.&lt;/p&gt;

&lt;h2&gt;A solution&lt;/h2&gt;

&lt;p&gt;The data collection process (Step 3 above) can make use of modern technology, and be based in the browser. Some benefits of a browser based data collection approach:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Cross-platform: a data digitization program that lives in the browser can be more easily cross-platform (Linux/Mac/Windows) than a native app.&lt;/li&gt;
&lt;li&gt;Linked data: with the increasing abundance of APIs (application programming interfaces), we can link the data going into this app to anything of interest.  This is not so easy in a native app.&lt;/li&gt;
&lt;li&gt;Automatic updates: a web based browser can be updated easily without requiring a user to go get updates.&lt;/li&gt;
&lt;li&gt;User-based: a web based browser can easily integrate secure user login so that users can be associated with data collected, allowing for quantification of user-based error, and eventually user based scores/badges/etc. if so desired.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For those concerned about a browser based approach to data collection from figures, it will likely be possible to make it work offline as well, then send data up to servers when connected to the web again.&lt;/p&gt;

&lt;p&gt;What would be great about having data be public by default is that the work would be reproducible easily, at least on the data side of things. Hopefully the researchers would make all their code available publicly to recreate their analyses.&lt;/p&gt;

&lt;h2&gt;Question: Why would this idea work?&lt;/h2&gt;

&lt;p&gt;Better question: Why wouldn’t it work!&lt;/p&gt;

&lt;p&gt;I think this idea could be awesome.  The reason I think it could be is based on two observations:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;There is a seemingly endless supply of academic papers with figures in them from which data can be extracted.**&lt;/li&gt;
&lt;li&gt;There is increasing use of meta-analysis in science, which is fed by just this kind of data.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;** p.s. in the future, perhaps we will move to all SVG format figures or something even better, in which case data can be extracted from the underlying XML&lt;/p&gt;

&lt;h2&gt;Okay, maybe it's a good idea, but who owns the data in figures in published papers?&lt;/h2&gt;

&lt;p&gt;As far as I know, and I've checked with a few knowledgeable people, no one owns this data. So it's ripe for the digitizing!&lt;/p&gt;

&lt;h2&gt;Open access&lt;/h2&gt;

&lt;p&gt;I want this project to be totally open access (and I hope you do too).  I love models like GitHub where everything is public by default (unless you are an enterprise user, exceptions, exceptions), and I think that is what this requires.  You may be thinking though: &quot;But I am collecting data for my meta-analysis and I don't want to share the data with anyone else&quot;.  My answer: &quot;I understand where you are coming from, but it doesn't seem very likely that someone will be asking the exact same question as you and be looking for the data from the exact same papers&quot;.  There will just be a huge database of data from figures, and all the appropriate metadata of course.  Anyone should be able to use this.&lt;/p&gt;

&lt;h2&gt;APIs&lt;/h2&gt;

&lt;p&gt;It would be great to build this from the start having an API in mind.  That is, how do we need to structure the data to be easily served up in an API to other websites, or pulled down to someone's local machine within Python or R to do data manipulation, analysis, and visualization?  We are going to need a key-value store database, such as MongoDB/CouchDB because ideally at least we would store the data collected, the figure itself, use information, etc.&lt;/p&gt;

&lt;h2&gt;What is being done about this?&lt;/h2&gt;

&lt;p&gt;I was fortunate enough to tag along with &lt;a href=&quot;http://emhart.github.com/&quot;&gt;Ted Hart&lt;/a&gt;, a postdoc at &lt;a href=&quot;PUTINLINKHERE&quot;&gt;UBC&lt;/a&gt;, on a recently submitted NCEAS working group proposal. Who knows if we'll get it, but we are already working on a prototype, so we will hit the ground running if we get funded, and just hit the ground, but walk a bit slower if we don't get the funding.&lt;/p&gt;

&lt;h2&gt;What could this be in the future?&lt;/h2&gt;

&lt;p&gt;At least in my mind, I think of this idea going the direction of gamification, including points, badges, etc., sort of like &lt;a href=&quot;http://fold.it/portal/&quot;&gt;FoldIt&lt;/a&gt; or &lt;a href=&quot;http://www.galaxyzoo.org/&quot;&gt;GalaxyZoo&lt;/a&gt;.  At first we need alpha-, then beta-testers, which I imagine will most likely be academics exracting data for a meta-analysis for example.  But in the future, it would be great to make the interface enjoyable enough to attract non-academics, which could greatly increase the speed of data collection.&lt;/p&gt;

&lt;p&gt;Once there are a lot of people collecting data we can get many data points for every single data point in a graph.  Whereas right now, someone clicks on each data point in a graph one, maybe two times if they are lucky.  In the future, we could have ten different users clicking on each mean and each error bar in each graph.  So exciting!  The following figure illustrates this.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/clicks.png&quot; alt=&quot;center&quot; /&gt;&lt;/p&gt;

&lt;h2&gt;What do you think?&lt;/h2&gt;

&lt;p&gt;Is this idea totally insane?  Is it do-able?  Is it worth doing?&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;Get the .Rmd file used to create this post &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/blob/master/_drafts/2012-09-18-getting-data.Rmd&quot;&gt;at my github account&lt;/a&gt; - or &lt;a href=&quot;https://github.com/SChamberlain/schamberlain.github.com/tree/master/_posts/2012-09-18-getting-data.md&quot;&gt;.md file&lt;/a&gt;.&lt;/h4&gt;

&lt;h4&gt;Written in &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;Markdown&lt;/a&gt;, with help from &lt;a href=&quot;http://yihui.name/knitr/&quot;&gt;knitr&lt;/a&gt;, and nice knitr highlighting/etc. in in &lt;a href=&quot;http://rstudio.org/&quot;&gt;RStudio&lt;/a&gt;.&lt;/h4&gt;

&lt;hr /&gt;

&lt;h4&gt;References&lt;/h4&gt;

&lt;p&gt;Attwood AS, Scott-Samuel NE, Stothart G, Munafò MR and Laks J (2012).
&amp;ldquo;Glass Shape Influences Consumption Rate For Alcoholic Beverages.&amp;rdquo;
&lt;EM&gt;Plos One&lt;/EM&gt;, &lt;B&gt;7&lt;/B&gt;.
&lt;a href=&quot;http://dx.doi.org/10.1371/journal.pone.0043007&quot;&gt;http://dx.doi.org/10.1371/journal.pone.0043007&lt;/a&gt;.

</description>
				<published>2012-09-18 00:00:00 -0700</published>
				<link>http://schamberlain.github.com/2012/09/getting-data/</link>
			</item>
		
	</channel>
</rss>