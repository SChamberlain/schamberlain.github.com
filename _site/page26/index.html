<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <title>
    
    Recology, R/etc.
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">

  <link rel="stylesheet" href="/public/css/bootstrap/css/bootstrap.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon.ico">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0f layout-reverse">

    <header class="masthead">
      <div class="masthead-inner">
        <h1>Recology</h1>
        <!-- <h1> <a href="http://recology.info/">Recology</a></h1> -->
        <p class="lead">R/etc.</p>

        <div class="colophon">
          <ul class="colophon-links">
            <li>
              <a href="/"><i class="fa fa-home fa-lg"></i></a>&nbsp;
              <a href="/about"><i class="fa fa-info-circle fa-lg"></i></a>&nbsp;
              <a href="/archives"><i class="fa fa-archive fa-lg"></i></a>&nbsp;
              <a href="/rresources"><i class="fa fa-book fa-lg"></i></a>&nbsp;
              <a href="http://rforcats.net/" rel><i class="fa fa-graduation-cap fa-lg"></i></a>&nbsp;
              <a href="/feed.xml"><i class="fa fa-rss fa-lg"></i></a>&nbsp;
              <a href="https://twitter.com/recology_"><i class="fa fa-twitter fa-lg"></i></a>&nbsp;
              <a href="/fork"><i class="fa fa-spinner fa-lg"></i></a>
            </li>
          </ul>
          <!-- <small><a href="https://github.com/mdo/hyde">Hyde</a> from <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</small> -->
        </div>
      </div>
    </header>

    <div class="content container">
      <div class="posts">
  <a style="float:right;" href="/archives" data-toggle="tooltip" data-placement="bottom" title="Archives"><i class="fa fa-archive fa-lg"></i></a>
  <a style="float:right;" href="/tags"><i class="fa fa-tags fa-lg"></i></a>&nbsp;
  
  <div class="post">
    <h1>
      <a href="/2012/11/altecology/">
        Altecology, a call to unconference action
      </a>
    </h1>

    <span class="post-date">15 Nov 2012</span>

    Note: This post is cross-posted on Sandra Chung's blog [here](http://sandrachung.com/).

*********

### The rise of the unconference
The Ecological Society of America meeting is holding its [98th annual meeting](http://www.esa.org/minneapolis/) next year in Minneapolis, MN. Several thousand students and professionals in ecological science and education will gather to hear and read the latest work and ideas in ecology in the familiar poster and lecture formats that are the core of every major scientific conference. But a subset of these people will get a taste of something a little bit different: an unconference within the conference.

The most important difference between traditional science conferences and the unconference format is that it prioritizes human interaction. Often the best and most important parts of science meetings are the interactions between talks, next to posters, and at the end of the day over drinks. These connections pave the way for collaborations and friendships that nourish our professional and personal lives with shared opportunities, camaraderie and support. 

In recognition of the increasing relative importance of the “meeting” part of a science meeting, the unconference format emphasizes interaction over presentation. It attempts to engage participants to the maximum extent reasonable in discussion and doing. [Science Online](http://scienceonline.com/) is a good example of this unconference format, in which the session topics are typically decided on democratically by the conference attendees (partly before arrival, partly on arrival), and you vote with your feet by going to and leaving sessions as you desire. 

*********

### Ecology is changing
Ecology is now adopting some of the same online and social tools that are already accelerating innovation in computing and other science disciplines. Ecologists, ecology students and educators are asking many of the same basic questions they have always asked: What should we be doing? How do we do it better and faster? Social media, open source software, open science, altmetrics, crowdsourcing, crowdfunding, data visualization, data sharing, alternative peer review, and an increasing emphasis on more and better communication and collaboration are just some of the newer tools being put forth to help address those questions in the 21st century.

Social media is rapidly becoming more common in ecologists’ toolkits to disseminate news of their new papers, communicate about research and research tools, and even filter the deluge of publications. Tools like blogs, Twitter and Facebook are filling the communication gaps between annual meetings and adding a new layer of conversation and connection to conferences and classrooms.

Social media, in turn, is connecting scientists directly to people besides their immediate colleagues who appreciate the impact of their work and want it to continue. The crowdfunding movement - exemplified by Kickstarter - has spurred similar alternative science funding projects such as SciFund. #SciFund project has shown that social media engagement increases donations to crowdfunded research ([interview with Jarrett Byrnes](http://jecology.libsyn.com/interview-with-jarrett-byrnes-on-science-crowdfunding)). 

In addition, we are in the era of big data, and [this includes ecology](http://www.neoninc.org/news/big-data-part-i). To deal with this “data deluge”, ecologists increasingly want to learn how to manage, share, retrieve, use, and visualize data. There are new tools for all of these tasks - we need to aid each other in learning them. Online and offline communities are coalescing around the development and dissemination of these tools for the benefit of ecological science, and they are meeting face-to-face at our ecological unconference.

Science in general is becoming increasingly complex and calling for larger and larger collaborations. This growth in turn is spurring a drive toward more openness and transparency within the culture of science. The more collaborative and complex scientific study becomes, the more scientists depend upon each other to do good work that we can all build upon with confidence. The often unstated assumption about ecology, and all of science, is that research findings are reproducible; but that assumption is quite shaky given the increasing number of retractions (see the [Retraction Watch blog](http://retractionwatch.wordpress.com/)) and findings that much research is not reproducible (see media coverage [here](http://www.nature.com/nature/journal/v483/n7391/full/483531a.html) and [here](http://www.reuters.com/article/2012/03/28/us-science-cancer-idUSBRE82R12P20120328)). 

A recent initiative seeks to facilitate attempts to reproduce research: [The Reproducibility Initiative](https://www.scienceexchange.com/reproducibility). Jarrett Byrnes [spoke at #ESA2012](http://www.slideshare.net/JarrettByrnes/taking-the-ecological-conversation-online) of how transparent, online discourse enhances our ability to discuss and improve our work and the work of our peers, both before and after publication. 

Much of the ecological science community shares one or both of these goals: to do the best possible science, and to do it in a way that is most useful and accessible to colleagues and to society at large. The goal of this year’s ecological unconference is to introduce as many people as possible to resources - both tools and people - that can help all of us achieve those goals, on our own, or together.

One way we as ecologists can quickly make our research more reproducible is the way we write. By simply using tools that make reproducing what we have done easy to do, we can avoid retracted papers, failed drugs, and ruined careers. 

*********

### What are you proposing?
We originally thought about a separate event from ESA itself, modeled after [Science Online](http://scienceonline.com/), incorporating a variety of topics. However, we thought testing the waters for this sort of non-traditional unconference format would be better in 2013. We are gathering ideas from the community (see “How do I make my voice heard?” below). The ideas on the wiki that get the most traction, and have 1-2 champions that are willing to see the idea through and lead the workshop at ESA will be turned in to proposals for ESA workshops. In addition, we will be submitting a proposal for an Ignite session at ESA. To summarise, we will be running:

+ A few workshops (at lunch hours, and half-day). Topics may include:
	+ Data sharing
	+ Data visualization
	+ Data management
	+ Alternatives to academia
	+ Blogging
	+ Social media
	+ Reproducible science writing
+ One Ignite session on “Tools for better/faster science”. See more about Ignite sessions [here](http://www.esa.org/minneapolis/ignite.php).
+ A “tweetup” event to socialize in a more relaxed atmosphere

These will all be loosely aggregated under the [#AltEcology](https://twitter.com/search/realtime?q=%23AltEcology) hashtag.

*********

### How do I make my voice heard?
We have set up a wiki in which anyone can contribute. Please share your ideas and voice your support for existing ones at the wiki [here](http://ecologyunconference.wikispaces.com/).  You can just throw ideas out there, or even propose new workshops and nominate people to lead them. We’re currently moving to transform existing ideas into ESA workshop and Ignite proposals to meet the [November 29 deadline](http://www.esa.org/minneapolis/workshop.php), but we’ll be incorporating input from the wiki right up to the meeting itself in August 2013.

*********

### Get in touch
If you have any questions/comments, let us know in the comments section below, tweet us (Sandra: [@sandramchung](https://twitter.com/sandramchung), Scott: [@recology_](https://twitter.com/recology_)), or email ([Sandra](mailto:sandra.m.chung@gmail.com), [Scott](mailto:myrmecocystus@gmail.com)). 

*********
#### Get the .md file used to create this post [at my github account](https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-11-15-altecology.md).  Written in [Markdown](http://daringfireball.net/projects/markdown/), with help from [knitr](http://yihui.name/knitr/).

  </div>
  
  <div class="post">
    <h1>
      <a href="/2012/10/r2g2-package/">
        Displaying Your Data in Google Earth Using R2G2
      </a>
    </h1>

    <span class="post-date">24 Oct 2012</span>

    Have you ever wanted to easily visualize your ecology data in [Google Earth][googleearth]?  [R2G2][r2g2] is a new package for R, available via [R CRAN][rcran] and formally described in [this Molecular Ecology Resources article][MERarticle], which provides a user-friendly bridge between R and the Google Earth interface.  Here, we will provide a brief introduction to the package, including a short tutorial, and then encourage you to try it out with your own data!

[Nils Arrigo][nils], with some help from [Loren Albert][loren], [Mike Barker][mike], and Pascal Mickelson (one of the contributors to [Recology][recology]), has created a set of R tools to generate KML files to view data with geographic components.  Instead of just telling you what the tools can do, though, we will show you a couple of examples using publically available data.  Note: a number of individual files are linked to throughout the tutorial below, but just in case you would rather download all the tutorial files in one go, have at it ([tutorial zip file][tutorialfile]).

Among the basic tools in [R2G2][r2g2] is the ability to place features—like dots, shapes, or images (including plots you produced in R)— that represent discrete observations at specific geographical locations.  For example, in the figure below, we show the migratory path of a particular turkey vulture in autumn of three successive years (red = 2009; blue = 2010; green = 2011).  


<div align="center">
<img src="/public/img/R2G2tutorial/Vulture_Path.jpg" alt="Google Earth image with three successive years of a particular turkey vulture's migration" width="800"><br>
<small>Google Earth imagery showing migratory path of a particular turkey vulture in 2009, 2010, and 2011.</small>
</div>  


We use the *PolyLines2GE* function that is part of [R2G2][r2g2] to create line segments between the geographical coordinates which have been obtained from a turkey vulture tagged with a transponder (data accessed via the [Movebank Data Repository][movebank] and is from the [Turkey Vulture Acopian Center USA GPS][turkeyvulturestudy]).  The *PolyLines2GE* function looks like the following:  

{% highlight r %}
PolyLines2GE(coords = vulture_path[,2:3],  
			nesting = vulture_path[,1],  
			colors = "auto",  
			goo = "Vulture_Path.kml",  
			maxAlt = 1e4,  
			fill = FALSE,  
			closepoly = FALSE,  
			lwd = 2,  
			extrude = 0)
{% endhighlight %}  

It expects to receive an array ("coords") containing latitude and longitude coordinates in decimal degrees. Additionally, each individual coordinate has a flag associated with it ("nesting") so that each data series can be distinguished.  Illustrating what you need is easier than explaining:
{% highlight text %}
nesting longitude latitude
1	long1A		lat1A
1	long1B		lat1B
1	long1C		lat1C
2	long2A		lat2A
2	long2B		lat2B
3	long3A		lat3A
3	long3B		lat3B
3	long3C		lat3C
{% endhighlight %}
Feeding the columns of this array to the function results in three differently colored lines:  the first would connect the coordinates 1A-1B-1C, while the second would connect 2A-2B, and the third would connect 3A-3B-3C.  The only other user-defined input that is strictly necessary is the output file name ("Vulture_Path.kml" in this case).  The other options—which allow you control of the appearance of the lines and of the altitude at which your line displays in Google Earth—have reasonable defaults that are well-documented in the function definition itself.  Check out this example in Google Earth [by downloading the KML file][vultureKML].  Alternatively, [download the annotated R script][vultureR] and generate the KML file for yourself.

Now, let's say you wanted to get a sense of the range and abundance of two congeneric species.  In this second example, we use the *Hist2GE* function to create a histogram—overlaid on the surface of the earth—which shows the species distribution of *Mimulus lewisii* (red) and *Mimulus nasutus* (blue) in North America.  


<div align="center">
<img src="/public/img/R2G2tutorial/Mimulus_Distribution.jpg" alt="Google Earth image showing the distribution of Mimulus in North America" width="800"><br>
<small>Google Earth imagery showing the species distribution of <em>Mimulus lewisii</em> and <em>Mimulus nasutus</em></small>
</div>  


As you might expect, each polygon represents an occurrence of the species in question, while the height of the polygon represents the abundance of the species at that geographic location.  Species occurring within a particular distance of each other have been grouped together for the histogram.  For this example, we retrieve data from the [GBIF][gbif] database from within R (see the example code for how that is done).  Inputs to the Hist2GE function are:
{% highlight r %}
Hist2GE(coords = MyCompleteData[, 8:7],  
		species = MyCompleteData[, 1],  
		grid = grid10000,  
		goo = "Mimulus",  
		nedges = 6,  
		orient = 45,  
		maxAlt = 1e4)
{% endhighlight %}
As in the first example, the function expects to receive an array containing the longitude and latitude ("coords"), a vector distinguishing individual observations ("species"), and an output file name ("goo").  In this case, however, we also need to specify the size of the grid we will use to group observations together to construct the histogram.  Several pre-defined grid sizes are included in the package to do this grouping; these all cover large geographic areas and therefore must account for the curvature of the earth.  Here is a list of these pre-defined grids:

<table border="1">
    <tr><th>Grid Name</th><th>Approximate Area of Grid Division </th></tr>
    <tr><td>grid20000</td><td>25,500 sq. km</td></tr>
    <tr><td>grid10000</td><td>51,000 sq. km</td></tr>
    <tr><td>grid5000</td><td>102,000 sq. km</td></tr>
    <tr><td>grid500</td><td>1,020,000 sq. km</td></tr>
    <tr><td>grid50</td><td>10,200,000 sq. km</td></tr>
</table>  

For smaller geographic areas (less than 25,000 square kilometers, or an area of about 158 km per side), you can customize the grid size by specifying the bounds of your region of interest in decimal degrees, as well as the coarseness of the grid within that region.  While it is possible to use this custom grid definition for larger sizes, beware that not all areas defined thusly will be of equal size due to the earth's curvature (obviously the bigger you go, the worse it gets...).  Finally, you again have control over the display parameters of the histogram.  In particular, the maximum altitude ("maxAlt") controls how high the tallest bar in the histogram will go.  Here is [the resulting KML file][mimulusKML], as well as [the annotated R script][mimulusR] so you can further explore the example.

More complex visual representations are also possible using [R2G2][r2g2].  For instance, you can also create contour plots or phylogenies overlaid directly on the surface of the earth.  We included a couple examples of this type in [our Molecular Ecology Resources article][MERarticle], and if the response seems good, we may post a follow up tutorial showing how we went about creating those examples.

It is our sincere hope that you will use the tools in [R2G2][r2g2] to more effectively visualize the geographical aspects of your data.  In particular, we are excited about the potential for incorporating [R2G2][r2g2] into data analysis pipelines connecting analysis in R with data visualization and exploration in Google Earth.  Ultimately, the inclusion of KML files as supplementary materials to journal articles should also enrich one's understanding of the data being presented!


<big><b>Note:  If you make something cool using <a href="http://cran.r-project.org/web/packages/R2G2/index.html">R2G2</a>, please post a link to your KML file in the comments; we would love to see!</b></big>


Citation information for [R2G2][r2g2]:  
*Arrigo, N., Albert, L. P., Mickelson, P. G. and Barker, M. S. (2012), Quantitative visualization of biological data in Google Earth using R2G2, an R CRAN package. Molecular Ecology Resources. doi: 10.1111/1755-0998.12012*

[googleearth]: http://earth.google.com
[rcran]: http://cran.r-project.org/
[MERarticle]: http://onlinelibrary.wiley.com/doi/10.1111/1755-0998.12012/abstract
[nils]: http://barkerlab.net/nils.html
[loren]: http://portal.environment.arizona.edu/students/profiles/loren-albert
[mike]: http://barkerlab.net/mike.html
[recology]: http://sckott.github.io/about.html
[gbif]: http://data.gbif.org/
[r2g2]: http://cran.r-project.org/web/packages/R2G2/index.html
[vultureKML]: /public/img/R2G2tutorial/Vulture_Path.kml
[vultureR]: /public/img/R2G2tutorial/Vulture_Path.R
[movebank]: http://movebank.org/
[turkeyvulturestudy]: http://movebank.org/movebank/#page%3Dstudies%2Cpath%3Dstudy481458
[mimulusKML]: /public/img/R2G2tutorial/Mimulus_Distribution.kml
[mimulusR]: /public/img/R2G2tutorial/Mimulus_Distribution.R
[tutorialfile]: /public/img/R2G2tutorial/R2G2tutorial.zip

  </div>
  
  <div class="post">
    <h1>
      <a href="/2012/10/get-taxa-downstream/">
        Getting taxonomic names downstream
      </a>
    </h1>

    <span class="post-date">16 Oct 2012</span>

    It can be a pain in the ass to get taxonomic names. For example, I sometimes need to get all the Class names for a set of species.  This is a relatively easy problem using the [ITIS API](http://www.itis.gov/ws_description.html) (example below).  

The much harder problem is getting all the taxonomic names downstream. ITIS doesn't provide an API method for this - well, they do ([`getHirerachyDownFromTSN`](http://www.itis.gov/ws_hierApiDescription.html#getHierarchyDn)), but it only provides direct children (e.g., the genera within a tribe - but it won't give all the species within each genus).  

So in the `taxize` package, we wrote a function called `downstream`, which allows you to get taxonomic names to any downstream point, e.g.:

+ get all Classes within Animalia,
+ get all Species within a Family
+ etc.

### Install packages.  You can get other packages from CRAN, but taxize is only on GitHub for now. 

{% highlight r linenos %}
# install_github('ritis', 'ropensci') # uncomment if not already installed
# install_github('taxize_', 'ropensci') # uncomment if not already
# installed
library(ritis)
library(taxize)
{% endhighlight %}


### Get upstream taxonomic names.

{% highlight r linenos %}
# Search for a TSN by scientific name
df <- searchbyscientificname("Tardigrada")
tsn <- df[df$combinedname %in% "Tardigrada", "tsn"]

# Get just one immediate higher taxonomic name
gethierarchyupfromtsn(tsn = tsn)
{% endhighlight %}



{% highlight text %}
  parentName parentTsn rankName  taxonName    tsn
1   Animalia    202423   Phylum Tardigrada 155166
{% endhighlight %}



{% highlight r linenos %}

# Get full hierarchy upstream from TSN
getfullhierarchyfromtsn(tsn = tsn)
{% endhighlight %}



{% highlight text %}
  parentName parentTsn rankName        taxonName    tsn
1                       Kingdom         Animalia 202423
2   Animalia    202423   Phylum       Tardigrada 155166
3 Tardigrada    155166    Class     Eutardigrada 155362
4 Tardigrada    155166    Class Heterotardigrada 155167
5 Tardigrada    155166    Class   Mesotardigrada 155358
{% endhighlight %}


### Get taxonomc names downstream.

{% highlight r linenos %}
# Get genera downstream fromthe Class Bangiophyceae
downstream(846509, "Genus")
{% endhighlight %}



{% highlight text %}
    tsn parentName parentTsn   taxonName rankId rankName
1 11531 Bangiaceae     11530      Bangia    180    Genus
2 11540 Bangiaceae     11530    Porphyra    180    Genus
3 11577 Bangiaceae     11530 Porphyrella    180    Genus
4 11580 Bangiaceae     11530 Conchocelis    180    Genus
{% endhighlight %}



{% highlight r linenos %}

# Get families downstream from Acridoidea
downstream(650497, "Family")
{% endhighlight %}



{% highlight text %}
      tsn parentName parentTsn      taxonName rankId rankName
1  102195 Acridoidea    650497      Acrididae    140   Family
2  650502 Acridoidea    650497     Romaleidae    140   Family
3  657472 Acridoidea    650497    Charilaidae    140   Family
4  657473 Acridoidea    650497   Lathiceridae    140   Family
5  657474 Acridoidea    650497     Lentulidae    140   Family
6  657475 Acridoidea    650497    Lithidiidae    140   Family
7  657476 Acridoidea    650497   Ommexechidae    140   Family
8  657477 Acridoidea    650497    Pamphagidae    140   Family
9  657478 Acridoidea    650497  Pyrgacrididae    140   Family
10 657479 Acridoidea    650497    Tristiridae    140   Family
11 657492 Acridoidea    650497 Dericorythidae    140   Family
{% endhighlight %}



{% highlight r linenos %}

# Get species downstream from Ursus
downstream(180541, "Species")
{% endhighlight %}



{% highlight text %}
     tsn parentName parentTsn        taxonName rankId rankName
1 180542      Ursus    180541  Ursus maritimus    220  Species
2 180543      Ursus    180541     Ursus arctos    220  Species
3 180544      Ursus    180541 Ursus americanus    220  Species
4 621850      Ursus    180541 Ursus thibetanus    220  Species
{% endhighlight %}


*********
#### Get the .Rmd file used to create this post [at my github account](https://github.com/sckott/sckott.github.com/tree/master/_drafts/2012-10-16-get-taxa-downstream.Rmd) - or [.md file](https://github.com/sckott/sckott.github.com/tree/master/_posts/2012-10-16-get-taxa-downstream.md).

#### Written in [Markdown](http://daringfireball.net/projects/markdown/), with help from [knitr](http://yihui.name/knitr/).

  </div>
  
</div>

<!-- Pagination links -->
<div class="pagination">
  
    <a href="/page27" class="older">Older</a>
  
  
    
      <a href="/page25" class="newer">Newer</a>
    
  
</div>

    </div>

    <!-- for bootstrap tooltips -->
    <script type="text/javascript">
      $("[data-toggle=\"tooltip\"]").tooltip();
    </script>

  </body>

  <footer>
  <!-- Disqus code -->
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'recology'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>

  <!-- google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-63197374-1', 'auto');
    ga('send', 'pageview');
  </script>
</footer>

</html>
