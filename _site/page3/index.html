<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <title>
    
    Recology, R/etc.
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">

  <link rel="stylesheet" href="/public/css/bootstrap/css/bootstrap.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon.ico">
  <link rel="shortcut icon" href="/public/favicon.ico">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0f layout-reverse">

    <header class="masthead">
      <div class="masthead-inner">
        <h1>Recology</h1>
        <!-- <h1> <a href="http://recology.info/">Recology</a></h1> -->
        <p class="lead">R/etc.</p>

        <div class="colophon">
          <ul class="colophon-links">
            <li>
              <a href="/"><i class="fa fa-home fa-lg"></i></a>&nbsp;
              <a href="/about"><i class="fa fa-info-circle fa-lg"></i></a>&nbsp;
              <a href="/archives"><i class="fa fa-archive fa-lg"></i></a>&nbsp;
              <a href="/rresources"><i class="fa fa-book fa-lg"></i></a>&nbsp;
              <a href="http://rforcats.net/" rel><i class="fa fa-graduation-cap fa-lg"></i></a>&nbsp;
              <a href="/feed.xml"><i class="fa fa-rss fa-lg"></i></a>&nbsp;
              <a href="https://twitter.com/sckottie"><i class="fa fa-twitter fa-lg"></i></a>&nbsp;
              <a href="/fork"><i class="fa fa-spinner fa-lg"></i></a>
            </li>
          </ul>
          <!-- <small><a href="https://github.com/mdo/hyde">Hyde</a> from <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</small> -->
        </div>
      </div>
    </header>

    <div class="content container">
      <div class="posts">
  <a style="float:right;" href="/archives" data-toggle="tooltip" data-placement="bottom" title="Archives"><i class="fa fa-archive fa-lg"></i></a>
  <a style="float:right;" href="/tags"><i class="fa fa-tags fa-lg"></i></a>&nbsp;
  
  <div class="post">
    <h1>
      <a href="/2015/11/crossref-clients/">
        Crossref programmatic clients
      </a>
    </h1>

    <span class="post-date">30 Nov 2015</span>

    <p>I gave two talks recently at the annual <a href="http://www.crossref.org/annualmeeting/agenda.html">Crossref meeting</a>, one of which was a somewhat technical overview of programmatic clients for Crossref APIs. Check out the talk <a href="https://crossref.wistia.com/medias/8rh0jm5eda">here</a>. I talked about the motivation for working with Crossref data by writing code/etc. rather than going the GUI route, then went over the various clients, with brief examples.</p>

<p>We (rOpenSci) have been working on the R client <a href="https://github.com/ropensci/rcrossref">rcrossref</a> for a while now, but I’m also working on the Python and Ruby clients for Crossref. In addition, the Ruby client has a CLI client inside. The Javascript client is worked on independently by <a href="https://science.ai/">ScienceAI</a>.</p>

<p>The R, Ruby, and Python clients are useable but not feature complete yet, and would benefit from lots of users surfacing bugs and highlighting nice to have features.</p>

<p>The main Crossref API used in all the clients is documented at <a href="https://github.com/CrossRef/rest-api-doc/blob/master/rest_api.md">api.crossref.org</a>.</p>

<p>I’ve tried to make the APIs similar-ish across clients. Functions in each client match the main Crossref search API (api.crossref.org) routes:</p>

<ul>
  <li><code class="highlighter-rouge">/works</code></li>
  <li><code class="highlighter-rouge">/members</code></li>
  <li><code class="highlighter-rouge">/funders</code></li>
  <li><code class="highlighter-rouge">/journals</code></li>
  <li><code class="highlighter-rouge">/types</code></li>
  <li><code class="highlighter-rouge">/licenses</code></li>
</ul>

<p>Other methods in all three clients:</p>

<ul>
  <li>Get DOI minting agency
    <ul>
      <li>Uses api.crossref.org API</li>
    </ul>
  </li>
  <li>Get random DOIs
    <ul>
      <li>Uses api.crossref.org API</li>
    </ul>
  </li>
  <li>Content negotiation
    <ul>
      <li>Documented at <a href="http://www.crosscite.org/cn">http://www.crosscite.org/cn</a></li>
    </ul>
  </li>
  <li>Get full text
    <ul>
      <li>other clients in each language will focus on this use case</li>
    </ul>
  </li>
  <li>Get citation count
    <ul>
      <li>Uses service at <a href="http://www.crossref.org/openurl">http://www.crossref.org/openurl</a> - though this functionality may be in the api.crossref.org API at some point</li>
    </ul>
  </li>
</ul>

<p>The following shows how to install, and then examples from each client for a few use cases.</p>

<h2 id="installation">Installation</h2>

<h3 id="python">Python</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>pip install habanero
</code></pre>
</div>

<h3 id="ruby">Ruby</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>gem install serrano
</code></pre>
</div>

<h3 id="r">R</h3>

<p>Inside R:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"rcrossref"</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="javascript">Javascript</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>npm install crossref
</code></pre>
</div>

<p>I won’t do any examples with the js library, as I don’t maintain it.</p>

<h2 id="use-case-get-orcid-ids-for-authors">Use case: get ORCID IDs for authors</h2>

<p>Python</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">habanero</span> <span class="kn">import</span> <span class="n">Crossref</span>
<span class="n">cr</span> <span class="o">=</span> <span class="n">Crossref</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">works</span><span class="p">(</span><span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span><span class="s">'has_orcid'</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span> <span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="n">z</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'ORCID'</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">'author'</span><span class="p">]</span> <span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s">'message'</span><span class="p">][</span><span class="s">'items'</span><span class="p">]</span> <span class="p">]</span>
<span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span> <span class="n">res2</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="s">u'http://orcid.org/0000-0003-4087-8021'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0002-2076-5452'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4087-8021'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0002-2076-5452'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-1710-1580'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-1710-1580'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4637-238X'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4637-238X'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4637-238X'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4637-238X'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-4637-238X'</span><span class="p">,</span>
 <span class="s">u'http://orcid.org/0000-0003-2510-4271'</span><span class="p">]</span>
</code></pre>
</div>

<p>Ruby</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'serrano'</span>
<span class="n">res</span> <span class="o">=</span> <span class="no">Serrano</span><span class="p">.</span><span class="nf">works</span><span class="p">(</span><span class="ss">filter: </span><span class="p">{</span><span class="s1">'has_orcid'</span><span class="p">:</span> <span class="kp">true</span><span class="p">},</span> <span class="ss">limit: </span><span class="mi">10</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">'message'</span><span class="p">][</span><span class="s1">'items'</span><span class="p">].</span><span class="nf">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span> <span class="n">x</span><span class="p">[</span><span class="s1">'author'</span><span class="p">].</span><span class="nf">collect</span> <span class="p">{</span> <span class="o">|</span><span class="n">z</span><span class="o">|</span> <span class="n">z</span><span class="p">[</span><span class="s1">'ORCID'</span><span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
<span class="n">res2</span><span class="p">.</span><span class="nf">flatten</span><span class="p">.</span><span class="nf">compact</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"http://orcid.org/0000-0003-4087-8021"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0002-2076-5452"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4087-8021"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0002-2076-5452"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-1710-1580"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-1710-1580"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span><span class="p">,</span>
 <span class="s2">"http://orcid.org/0000-0003-2510-4271"</span><span class="p">]</span>
</code></pre>
</div>

<p>R</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"rcrossref"</span><span class="p">)</span>
<span class="n">res</span> <span class="o">&lt;-</span> <span class="n">cr_works</span><span class="p">(</span><span class="n">filter</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="n">has_orcid</span><span class="o">=</span><span class="n">TRUE</span><span class="p">),</span> <span class="n">limit</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
<span class="n">orcids</span> <span class="o">&lt;-</span> <span class="n">unlist</span><span class="p">(</span><span class="n">lapply</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">data</span><span class="o">$</span><span class="n">author</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="n">z</span><span class="o">$</span><span class="n">ORCID</span><span class="p">))</span>
<span class="n">Filter</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!</span><span class="n">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">orcids</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code> <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4087-8021"</span>
 <span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0002-2076-5452"</span>
 <span class="p">[</span><span class="m">3</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4087-8021"</span>
 <span class="p">[</span><span class="m">4</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0002-2076-5452"</span>
 <span class="p">[</span><span class="m">5</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-1710-1580"</span>
 <span class="p">[</span><span class="m">6</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-1710-1580"</span>
 <span class="p">[</span><span class="m">7</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
 <span class="p">[</span><span class="m">8</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
 <span class="p">[</span><span class="m">9</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="p">[</span><span class="m">10</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="p">[</span><span class="m">11</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="p">[</span><span class="m">12</span><span class="p">]</span> <span class="s2">"http://orcid.org/0000-0003-2510-4271"</span>
</code></pre>
</div>

<p>CLI</p>

<div class="highlighter-rouge"><pre class="highlight"><code>serrano works --filter<span class="o">=</span>has_orcid:true --json --limit<span class="o">=</span>12 | jq <span class="s1">'.message.items[].author[].ORCID | select(. != null)'</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"http://orcid.org/0000-0003-4087-8021"</span>
<span class="s2">"http://orcid.org/0000-0002-2076-5452"</span>
<span class="s2">"http://orcid.org/0000-0003-4087-8021"</span>
<span class="s2">"http://orcid.org/0000-0002-2076-5452"</span>
<span class="s2">"http://orcid.org/0000-0003-1710-1580"</span>
<span class="s2">"http://orcid.org/0000-0003-1710-1580"</span>
<span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="s2">"http://orcid.org/0000-0003-4637-238X"</span>
<span class="s2">"http://orcid.org/0000-0003-2510-4271"</span>
<span class="s2">"http://orcid.org/0000-0001-9408-8207"</span>
<span class="s2">"http://orcid.org/0000-0002-2076-5452"</span>
</code></pre>
</div>

<h2 id="use-case-content-negotation">Use case: content negotation</h2>

<p>Python</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">habanero</span> <span class="kn">import</span> <span class="n">cn</span>
<span class="n">cn</span><span class="o">.</span><span class="n">content_negotiation</span><span class="p">(</span><span class="n">ids</span> <span class="o">=</span> <span class="s">'10.1126/science.169.3946.635'</span><span class="p">,</span> <span class="n">format</span> <span class="o">=</span> <span class="s">"text"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s">u'Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635</span><span class="se">\xe2\x80\x93</span><span class="s">641. doi:10.1126/science.169.3946.635</span><span class="se">\n</span><span class="s">'</span>
</code></pre>
</div>

<p>Ruby</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'serrano'</span>
<span class="no">Serrano</span><span class="p">.</span><span class="nf">content_negotiation</span><span class="p">(</span><span class="ss">ids: </span><span class="s1">'10.1126/science.169.3946.635'</span><span class="p">,</span> <span class="ss">format: </span><span class="s2">"text"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635</span><span class="se">\xE2\x80\x93</span><span class="s2">641. doi:10.1126/science.169.3946.635</span><span class="se">\n</span><span class="s2">"</span><span class="p">]</span>
</code></pre>
</div>

<p>R</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"rcrossref"</span><span class="p">)</span>
<span class="n">cr_cn</span><span class="p">(</span><span class="n">dois</span><span class="o">=</span><span class="s2">"10.1126/science.169.3946.635"</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s2">"Frank, H. S. (1970). The Structure of Ordinary Water: New data and interpretations are yielding new insights into this fascinating substance. Science, 169(3946), 635–641. doi:10.1126/science.169.3946.635"</span>
</code></pre>
</div>

<p>CLI</p>

<div class="highlighter-rouge"><pre class="highlight"><code>serrano contneg 10.1890/13-0590.1 --format<span class="o">=</span>text
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Murtaugh, P. A. <span class="o">(</span>2014<span class="o">)</span>.  In defense of P values . Ecology, 95<span class="o">(</span>3<span class="o">)</span>, 611–617. doi:10.1890/13-0590.1
</code></pre>
</div>

<h2 id="more">More</h2>

<p>There are definitely issues with data in the Crossref search API, some of which I cover in my talks. However, it is still the best place to go for scholarly metadata.</p>

<p>Let us know of other use cases - there are others not covered here for brevity sake.</p>

<p>There are lots of examples in the docs for each client. If you can think of any doc improvements file an issue.</p>

<p>If you find any bugs, please do file an issue.</p>


  </div>
  
  <div class="post">
    <h1>
      <a href="/2015/11/pygbif/">
        pygbif - GBIF client for Python
      </a>
    </h1>

    <span class="post-date">12 Nov 2015</span>

    <p>I maintain an R client for the GBIF API, at <a href="https://github.com/ropensci/rgbif">rgbif</a>. Been working on it for a few years, and recently been thinking that there should be a nice low level client for Python as well. I didn’t see one searching Github, etc. so I started working on one recently: <a href="https://github.com/sckott/pygbif">pygbif</a></p>

<p>It’s up on <a href="https://pypi.python.org/pypi/pygbif/0.1.1">pypi</a>.</p>

<p>There’s not much in <code class="highlighter-rouge">pygbif</code> yet - I wanted to get something up to start getting some users to more quickly make the library useful to people.</p>

<p>There’s three modules, with a few methods each:</p>

<ul>
  <li>species
    <ul>
      <li><code class="highlighter-rouge">name_backbone()</code></li>
      <li><code class="highlighter-rouge">name_suggest()</code></li>
    </ul>
  </li>
  <li>registry
    <ul>
      <li><code class="highlighter-rouge">nodes()</code></li>
      <li><code class="highlighter-rouge">dataset_metrics()</code></li>
      <li><code class="highlighter-rouge">datasets()</code></li>
    </ul>
  </li>
  <li>occurrences
    <ul>
      <li><code class="highlighter-rouge">search()</code></li>
      <li><code class="highlighter-rouge">get()</code></li>
      <li><code class="highlighter-rouge">get_verbatim()</code></li>
      <li><code class="highlighter-rouge">get_fragment()</code></li>
      <li><code class="highlighter-rouge">count()</code></li>
      <li><code class="highlighter-rouge">count_basisofrecord()</code></li>
      <li><code class="highlighter-rouge">count_year()</code></li>
      <li><code class="highlighter-rouge">count_datasets()</code></li>
      <li><code class="highlighter-rouge">count_countries()</code></li>
      <li><code class="highlighter-rouge">count_publishingcountries()</code></li>
      <li><code class="highlighter-rouge">count_schema()</code></li>
    </ul>
  </li>
</ul>

<p>Here’s a quick intro (<a href="https://github.com/sckott/pygbif/blob/master/demos/pygbif-intro.ipynb">in a Jupyter notebook</a>):</p>

<h3 id="install">Install</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">pip</span> <span class="n">install</span> <span class="n">pygbif</span>
</code></pre>
</div>

<h3 id="registrydatasets">Registry/datasets</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pygbif</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="n">registry</span><span class="o">.</span><span class="n">dataset_metrics</span><span class="p">(</span><span class="n">uuid</span><span class="o">=</span><span class="s">'3f8a1297-3259-4700-91fc-acc4170b27ce'</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="s">u'colCoveragePct'</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span>
 <span class="s">u'colMatchingCount'</span><span class="p">:</span> <span class="mi">24335</span><span class="p">,</span>
 <span class="s">u'countByConstituent'</span><span class="p">:</span> <span class="p">{},</span>
 <span class="s">u'countByIssue'</span><span class="p">:</span> <span class="p">{</span><span class="s">u'BACKBONE_MATCH_FUZZY'</span><span class="p">:</span> <span class="mi">573</span><span class="p">,</span>
  <span class="s">u'BACKBONE_MATCH_NONE'</span><span class="p">:</span> <span class="mi">1306</span><span class="p">,</span>
  <span class="s">u'VERNACULAR_NAME_INVALID'</span><span class="p">:</span> <span class="mi">7777</span><span class="p">},</span>
 <span class="s">u'countByKingdom'</span><span class="p">:</span> <span class="p">{</span><span class="s">u'ANIMALIA'</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
  <span class="s">u'FUNGI'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s">u'INCERTAE_SEDIS'</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
  <span class="s">u'PLANTAE'</span><span class="p">:</span> <span class="mi">10997</span><span class="p">,</span>
  <span class="s">u'PROTOZOA'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
 <span class="o">...</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="taxonomic-names">Taxonomic names</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pygbif</span> <span class="kn">import</span> <span class="n">species</span>
<span class="n">species</span><span class="o">.</span><span class="n">name_suggest</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="s">'Puma concolor'</span><span class="p">,</span> <span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="s">'data'</span><span class="p">:</span> <span class="p">[{</span><span class="s">u'canonicalName'</span><span class="p">:</span> <span class="s">u'Puma concolor'</span><span class="p">,</span>
   <span class="s">u'class'</span><span class="p">:</span> <span class="s">u'Mammalia'</span><span class="p">,</span>
   <span class="s">u'classKey'</span><span class="p">:</span> <span class="mi">359</span><span class="p">,</span>
   <span class="s">u'family'</span><span class="p">:</span> <span class="s">u'Felidae'</span><span class="p">,</span>
   <span class="s">u'familyKey'</span><span class="p">:</span> <span class="mi">9703</span><span class="p">,</span>
   <span class="s">u'genus'</span><span class="p">:</span> <span class="s">u'Puma'</span><span class="p">,</span>
   <span class="s">u'genusKey'</span><span class="p">:</span> <span class="mi">2435098</span><span class="p">,</span>
   <span class="s">u'key'</span><span class="p">:</span> <span class="mi">2435099</span><span class="p">,</span>
   <span class="s">u'kingdom'</span><span class="p">:</span> <span class="s">u'Animalia'</span><span class="p">,</span>
   <span class="s">u'kingdomKey'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="s">u'nubKey'</span><span class="p">:</span> <span class="mi">2435099</span><span class="p">,</span>
   <span class="s">u'order'</span><span class="p">:</span> <span class="s">u'Carnivora'</span><span class="p">,</span>
   <span class="s">u'orderKey'</span><span class="p">:</span> <span class="mi">732</span><span class="p">,</span>
   <span class="s">u'parent'</span><span class="p">:</span> <span class="s">u'Puma'</span><span class="p">,</span>
   <span class="s">u'parentKey'</span><span class="p">:</span> <span class="mi">2435098</span><span class="p">,</span>
   <span class="s">u'phylum'</span><span class="p">:</span> <span class="s">u'Chordata'</span><span class="p">,</span>
   <span class="s">u'phylumKey'</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
   <span class="s">u'rank'</span><span class="p">:</span> <span class="s">u'SPECIES'</span><span class="p">,</span>
   <span class="s">u'species'</span><span class="p">:</span> <span class="s">u'Puma concolor'</span><span class="p">,</span>
   <span class="s">u'speciesKey'</span><span class="p">:</span> <span class="mi">2435099</span><span class="p">}],</span>
 <span class="s">'hierarchy'</span><span class="p">:</span> <span class="p">[{</span><span class="s">u'1'</span><span class="p">:</span> <span class="s">u'Animalia'</span><span class="p">,</span>
   <span class="s">u'2435098'</span><span class="p">:</span> <span class="s">u'Puma'</span><span class="p">,</span>
   <span class="s">u'359'</span><span class="p">:</span> <span class="s">u'Mammalia'</span><span class="p">,</span>
   <span class="s">u'44'</span><span class="p">:</span> <span class="s">u'Chordata'</span><span class="p">,</span>
   <span class="s">u'732'</span><span class="p">:</span> <span class="s">u'Carnivora'</span><span class="p">,</span>
   <span class="s">u'9703'</span><span class="p">:</span> <span class="s">u'Felidae'</span><span class="p">}]}</span>
</code></pre>
</div>

<h3 id="occurrence-data">Occurrence data</h3>

<p>Search</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pygbif</span> <span class="kn">import</span> <span class="n">occurrences</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">occurrences</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">taxonKey</span> <span class="o">=</span> <span class="mi">3329049</span><span class="p">,</span> <span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span> <span class="n">x</span><span class="p">[</span><span class="s">'phylum'</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">[</span><span class="s">'results'</span><span class="p">]</span> <span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">,</span>
 <span class="s">u'Basidiomycota'</span><span class="p">]</span>
</code></pre>
</div>

<p>Fetch specific occurrences</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">occurrences</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="mi">252408386</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="s">u'basisOfRecord'</span><span class="p">:</span> <span class="s">u'OBSERVATION'</span><span class="p">,</span>
 <span class="s">u'catalogNumber'</span><span class="p">:</span> <span class="s">u'70875196'</span><span class="p">,</span>
 <span class="s">u'collectionCode'</span><span class="p">:</span> <span class="s">u'7472'</span><span class="p">,</span>
 <span class="s">u'continent'</span><span class="p">:</span> <span class="s">u'EUROPE'</span><span class="p">,</span>
 <span class="s">u'country'</span><span class="p">:</span> <span class="s">u'United Kingdom'</span><span class="p">,</span>
 <span class="s">u'countryCode'</span><span class="p">:</span> <span class="s">u'GB'</span><span class="p">,</span>
 <span class="s">u'datasetKey'</span><span class="p">:</span> <span class="s">u'26a49731-9457-45b2-9105-1b96063deb26'</span><span class="p">,</span>
 <span class="s">u'day'</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
<span class="o">...</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Occurrence counts API</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">occurrences</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">isGeoreferenced</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="mi">500283031</span>
</code></pre>
</div>

<h3 id="feedback">feedback</h3>

<p>Would love any feedback…</p>


  </div>
  
  <div class="post">
    <h1>
      <a href="/2015/10/noaa-isd/">
        noaa - Integrated Surface Database data
      </a>
    </h1>

    <span class="post-date">21 Oct 2015</span>

    <p>I’ve recently made some improvements to the functions that work with ISD 
(Integrated Surface Database) data.</p>

<p><strong>isd data</strong></p>

<ul>
  <li>The <code class="highlighter-rouge">isd()</code> function now caches more intelligently. We now cache using 
<code class="highlighter-rouge">.rds</code> files via <code class="highlighter-rouge">saveRDS</code>/<code class="highlighter-rouge">readRDS</code>, whereas we used to use <code class="highlighter-rouge">.csv</code> files, 
which take up much more disk space, and we have to worry about not changing 
data formats on reading data back into an R session. This has the downside
that you can’t just go directly to open up a cached file in your favorite 
spreadsheet viewer, but you can do that manually after reading in to R.</li>
  <li>In addition, <code class="highlighter-rouge">isd()</code> now has a function <code class="highlighter-rouge">cleanup</code>, if <code class="highlighter-rouge">TRUE</code> after 
downloading the data file from NOAA’s ftp server and processing, we delete 
the file. That’s fine since we have the cached processed file. But you 
can choose not to cleanup the original data files.</li>
  <li>Data processing in <code class="highlighter-rouge">isd()</code> is improved as well. We convert key variables
to appropriate classes to be more useful.</li>
</ul>

<p><strong>isd stations</strong></p>

<ul>
  <li>In <code class="highlighter-rouge">isd_stations()</code>, there’s now a cached version of the station data in 
the package, or you can get optionally get fresh station data from NOAA’s 
FTP server.</li>
  <li>There’s a new function <code class="highlighter-rouge">isd_stations_search()</code> that uses the station data
to allow you to search for stations via either:
    <ul>
      <li>A bounding box</li>
      <li>Radius froma point</li>
    </ul>
  </li>
</ul>

<h2 id="install">Install</h2>

<p>For examples below, you’ll need the development version:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ropensci/rnoaa"</span><span class="p">)</span>
</code></pre>
</div>

<p>Load <code class="highlighter-rouge">rnoaa</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"rnoaa"</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="isd-stations">ISD stations</h2>

<h3 id="get-stations">Get stations</h3>

<p>There’s a cached version of the station data in the package, or you can get fresh
station data from NOAA’s FTP server.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stations</span> <span class="o">&lt;-</span> <span class="n">isd_stations</span><span class="p">()</span>
<span class="n">head</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span>
<span class="c1">#&gt;   usaf  wban station_name ctry state icao lat lon elev_m    begin      end
#&gt; 1 7005 99999   CWOS 07005                  NA  NA     NA 20120127 20120127
#&gt; 2 7011 99999   CWOS 07011                  NA  NA     NA 20111025 20121129
#&gt; 3 7018 99999   WXPOD 7018                   0   0   7018 20110309 20130730
#&gt; 4 7025 99999   CWOS 07025                  NA  NA     NA 20120127 20120127
#&gt; 5 7026 99999   WXPOD 7026   AF              0   0   7026 20120713 20141120
#&gt; 6 7034 99999   CWOS 07034                  NA  NA     NA 20121024 20121106
</span></code></pre>
</div>

<h3 id="filter-and-visualize-stations">Filter and visualize stations</h3>

<p>In addition to getting the entire station data.frame, you can also search for stations,
either with a bounding box or within a radius from a point. First, the bounding box</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">bbox</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="m">-125.0</span><span class="p">,</span> <span class="m">38.4</span><span class="p">,</span> <span class="m">-121.8</span><span class="p">,</span> <span class="m">40.9</span><span class="p">)</span>
<span class="n">out</span> <span class="o">&lt;-</span> <span class="n">isd_stations_search</span><span class="p">(</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="c1">#&gt;     usaf  wban                          station_name ctry state icao
#&gt; 1 720193 99999 LONNIE POOL FLD / WEAVERVILLE AIRPORT   US    CA KO54
#&gt; 2 724834 99999                        POINT CABRILLO   US    CA     
#&gt; 3 724953 99999                              RIO NIDO   US    CA     
#&gt; 4 724957 23213                 SONOMA COUNTY AIRPORT   US    CA KSTS
#&gt; 5 724957 99999                  C M SCHULZ SONOMA CO   US    CA KSTS
#&gt; 6 724970 99999                  CHICO CALIFORNIA MAP   US    CA  CIC
#&gt;   elev_m    begin      end      lon    lat
#&gt; 1  716.0 20101030 20150831 -122.922 40.747
#&gt; 2   20.0 19810906 19871007 -123.820 39.350
#&gt; 3 -999.0 19891111 19900303 -122.917 38.517
#&gt; 4   34.8 20000101 20150831 -122.810 38.504
#&gt; 5   38.0 19430404 19991231 -122.817 38.517
#&gt; 6   69.0 19420506 19760305 -121.850 39.783
</span></code></pre>
</div>

<p>Where is the bounding box? (you’ll need <a href="https://cran.rstudio.com/web/packages/lawn/">lawn</a>, or you can vizualize some other way)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"lawn"</span><span class="p">)</span>
<span class="n">lawn</span><span class="o">::</span><span class="n">lawn_bbox_polygon</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">view</span>
</code></pre>
</div>

<p><img src="/public/img/2015-10-21-noaa-isd/bbox_area.png" alt="plot1" /></p>

<p>Vizualize station subset - yep, looks right</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"leaflet"</span><span class="p">)</span>
<span class="n">leaflet</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">addTiles</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">addCircles</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/2015-10-21-noaa-isd/bbox_result.png" alt="plot1" /></p>

<p>Next, search with a lat/lon coordinate, with a radius. That is, we search for stations
within X km from the coordinate.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">out</span> <span class="o">&lt;-</span> <span class="n">isd_stations_search</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="m">38.4</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="m">-123</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="m">250</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="c1">#&gt;     usaf  wban             station_name ctry state icao elev_m    begin
#&gt; 1 690070 93217            FRITZSCHE AAF   US    CA KOAR   43.0 19600404
#&gt; 2 720267 23224 AUBURN MUNICIPAL AIRPORT   US    CA KAUN  466.7 20060101
#&gt; 3 720267 99999         AUBURN MUNICIPAL   US    CA KAUN  468.0 20040525
#&gt; 4 720406 99999      GNOSS FIELD AIRPORT   US    CA KDVO    0.6 20071114
#&gt; 5 720576   174       UNIVERSITY AIRPORT   US    CA KEDU   21.0 20130101
#&gt; 6 720576 99999                    DAVIS   US    CA KEDU   21.0 20080721
#&gt;        end      lon    lat
#&gt; 1 19930831 -121.767 36.683
#&gt; 2 20150831 -121.082 38.955
#&gt; 3 20051231 -121.082 38.955
#&gt; 4 20150831 -122.550 38.150
#&gt; 5 20150831 -121.783 38.533
#&gt; 6 20121231 -121.783 38.533
</span></code></pre>
</div>

<p>Again, compare search area to stations found</p>

<p><em>search area</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">pt</span> <span class="o">&lt;-</span> <span class="n">lawn</span><span class="o">::</span><span class="n">lawn_point</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="m">-123</span><span class="p">,</span> <span class="m">38.4</span><span class="p">))</span>
<span class="n">lawn</span><span class="o">::</span><span class="n">lawn_buffer</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="m">250</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">view</span>
</code></pre>
</div>

<p><img src="/public/img/2015-10-21-noaa-isd/circle_radius.png" alt="plot1" /></p>

<p><em>stations found</em></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">leaflet</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">out</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">addTiles</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="n">addCircles</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="/public/img/2015-10-21-noaa-isd/lastplot.png" alt="plot1" /></p>

<h2 id="isd-data">ISD data</h2>

<h3 id="get-isd-data">Get ISD data</h3>

<p>Here, I get data for four stations.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">res1</span> <span class="o">&lt;-</span> <span class="n">isd</span><span class="p">(</span><span class="n">usaf</span><span class="o">=</span><span class="s2">"011690"</span><span class="p">,</span> <span class="n">wban</span><span class="o">=</span><span class="s2">"99999"</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="m">1993</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">&lt;-</span> <span class="n">isd</span><span class="p">(</span><span class="n">usaf</span><span class="o">=</span><span class="s2">"172007"</span><span class="p">,</span> <span class="n">wban</span><span class="o">=</span><span class="s2">"99999"</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="m">2015</span><span class="p">)</span>
<span class="n">res3</span> <span class="o">&lt;-</span> <span class="n">isd</span><span class="p">(</span><span class="n">usaf</span><span class="o">=</span><span class="s2">"702700"</span><span class="p">,</span> <span class="n">wban</span><span class="o">=</span><span class="s2">"00489"</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="m">2015</span><span class="p">)</span>
<span class="n">res4</span> <span class="o">&lt;-</span> <span class="n">isd</span><span class="p">(</span><span class="n">usaf</span><span class="o">=</span><span class="s2">"109711"</span><span class="p">,</span> <span class="n">wban</span><span class="o">=</span><span class="m">99999</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="m">1970</span><span class="p">)</span>
</code></pre>
</div>

<p>Then, combine data, with <code class="highlighter-rouge">rnoaa:::rbind.isd()</code></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">res_all</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span> <span class="n">res2</span><span class="p">,</span> <span class="n">res3</span><span class="p">,</span> <span class="n">res4</span><span class="p">)</span>
</code></pre>
</div>

<p>Add date time</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"lubridate"</span><span class="p">)</span>
<span class="n">res_all</span><span class="o">$</span><span class="n">date_time</span> <span class="o">&lt;-</span> <span class="n">ymd_hm</span><span class="p">(</span>
  <span class="n">sprintf</span><span class="p">(</span><span class="s2">"%s %s"</span><span class="p">,</span> <span class="n">as.character</span><span class="p">(</span><span class="n">res_all</span><span class="o">$</span><span class="n">date</span><span class="p">),</span> <span class="n">res_all</span><span class="o">$</span><span class="n">time</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
</div>

<p>Remove 999’s (NOAA’s way to indicate missing/no data)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"dplyr"</span><span class="p">)</span>
<span class="n">res_all</span> <span class="o">&lt;-</span> <span class="n">res_all</span> <span class="o">%&gt;%</span> <span class="n">filter</span><span class="p">(</span><span class="n">temperature</span> <span class="o">&lt;</span> <span class="m">900</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="visualize-isd-data">Visualize ISD data</h3>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"ggplot2"</span><span class="p">)</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">res_all</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">date_time</span><span class="p">,</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">+</span>
  <span class="n">geom_line</span><span class="p">()</span> <span class="o">+</span> 
  <span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">usaf_station</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s2">"free_x"</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="/public/img/2015-10-21-noaa-isd/unnamed-chunk-12-1.png" alt="img" /></p>

  </div>
  
</div>

<!-- Pagination links -->
<div class="pagination">
  
    <a href="/page4" class="older">Older</a>
  
  
    
      <a href="/page2" class="newer">Newer</a>
    
  
</div>

    </div>

    <!-- for bootstrap tooltips -->
    <script type="text/javascript">
      $("[data-toggle=\"tooltip\"]").tooltip();
    </script>

  </body>

  <footer>
  <!-- Disqus code -->
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'recology'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
  </script>

  <!-- google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-63197374-1', 'auto');
    ga('send', 'pageview');
  </script>
</footer>

</html>
