<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Richard Huang - Richard Huang's Website</title>
    <meta name="author" content="Richard Huang" />
    <meta name="google-site-verification" content="KDVRO6hdZ0Vww31dac2Yomyd7xjmMMFEZw2Fzq5acuY" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/screen.css">
    <link href="http://feeds.feedburner.com/richard-huang" rel="alternate" title="RSS" type="application/rss+xml" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/jquery.github_v2.js"></script>
  </head>

  <body>
    <div id="header" class="section">
      <div class="wrapper">
        <strong id="blog-title">
          <a href="/" rel="home">Richard Huang's Website</a>
        </strong>
        <p id="blog-description"></p>
        <div id="navigation">
          <ul class="nav clearfix">
            <li class="first-child"><a href="/blog.html">Blog</a></li>
            <li><a href="/projects.html">Projects</a></li>
            <li><a href="/about.html">About</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div id="main" class="section">
      <div class="wrapper">
        <div id="content">
          <!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  <a class="addthis_button_tweet"></a>
  <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
  <a class="addthis_counter addthis_pill_style"></a>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=flyerhzm"></script>
<!-- AddThis Button END -->

  <div class="full">
    <h1 class="entry-title">
      <a href="/2010/04/18/zhejiang-university-alumni-fun-games/" title="浙大校友趣味运动会" rel="bookmark">浙大校友趣味运动会</a>
    </h1>
    <div class="entry-content full-content">
      <p>下午参加了浙大校友趣味运动会，在华师大。</p>

<p>上半场是组队活动，有跳长绳、拔河和四人五足活动。下半场是羽毛球比赛。我主要是参加了羽毛球比赛，一开始进行25分的淘汰赛，连赢了两盘，不过体力已经成为问题。进入冠军循环赛，才用11分3局2胜，真是累得一塌糊涂，第一个对手非常擅长打高吊球，基本被压在后场，僵持几个回合就比较累了，一急就想劈杀，虽然有几个扣死了，不过大多都是被救回，或者下网，输得比较郁闷，没什么办法。第二个对手旗鼓相当吧，不过还是输了，反应和移动都下降不少，体力成了制约发挥的最大障碍。</p>

<p>回来的路上洗了个澡，已经感觉右边大腿比较酸，右手胳膊也有点太不起来了，估计明天得单手敲代码了。</p>

<p>听说浙大校友每周都会在华师大打球的，以后可以经常去玩玩。</p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Life" title="Life" rel="category tag">Life</a>
      
    </p>
    <p class="comments-link">
      <a href='/2010/04/18/zhejiang-university-alumni-fun-games/#disqus_thread'>Comments</a>
    </p>
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="Sun Apr 18 00:00:00 -0700 2010">18 Apr 2010</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2010/04/03/css-sprite-best-practices-english-version/" title="css sprite best practices" rel="bookmark">css sprite best practices</a>
    </h1>
    <div class="entry-content full-content">
      <p><a href="/2010/04/02/css-sprite-best-practices-chinese-version">css sprite最佳实践（中文版）</a></p>

<p>(Updated on 2010-4-4, thank <a href="http://scottballantyne.com/">Scott Ballantyne</a> )</p>

<p>The advantage of using the css sprite is to reduce a large number of http requests, so it makes the web page loaded much faster. I often find it it painful for me to compose a lot of images into one css sprite image and measure the x and y positions for each image.</p>

<p>Last year, I wrote a <a href="http://github.com/flyerhzm/css_sprite">css_sprite</a>  gem, but to use it you need to define all the images you want to do the css sprite in the configuration file, and it is not easy to use. Because of this, recently I rewrote the css_sprite gem, it is not necessary to use configuration file any more by default, the new css_sprite gem follows the idea of Convention Over Configuration. Now the css_sprite gem can do the css sprite automatically.</p>

<p>First, let's look at the convention of the directory structrue.</p>

<p><img src="http://lh6.ggpht.com/_qSmJ0dW70FE/TGdIAsGI6_I/AAAAAAAAATo/3Xhs9JzvDAQ/css_sprite_preview.png" alt="" /></p>

<p>The blue parts on the above image are the css_sprite directories according to convention. That means the directory whose name is css_sprite or css_sprite suffixed (e.g. another_css_sprite) needs to do the css sprite.</p>

<p>The green parts are images that need to be tranformed into the css sprite. Once you add images to the css_sprite directory or remove images, the css sprite operation will be automatically executed.</p>

<p>The red parts are automatically generated files. For each css_sprite directory, there is a css sprite image generated, combined by all the images under the css_sprite directory, and there is also a css or sass file generated according to the css_sprite image.</p>

<p>What about the generated css file?</p>

<div class="highlight"><pre><code class="css"><span class="nc">.twitter_icon</span><span class="o">,</span> <span class="nc">.facebook_icon</span><span class="o">,</span> <span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="sx">url(&#39;/images/css_sprite.png?1270170265&#39;)</span> <span class="k">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.twitter_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">0px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.facebook_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-19px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.login_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-38px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.logout_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-79px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>That means, the generated css file follows the naming convention: <em>one image under the css_sprite directory corresponds to one class in the generated css file, the name of class is just the same as the name of image.</em> The advantage of this is that developers only need to know what images are under css_sprite directory, then they can use the corresponding class names to display these images on the html page.</p>

<p>One difficulty that you may encounter is adding styles to a class that is being used by css sprite. Below is a description of how you might handle such an issue.</p>

<p>1. some related classes have some common styles. e.g. to buttons, you may apply them on input or a elements, in common you need to hide the text on input and a elements, hide the border and so on. So you should generate the common styles for these related classes. For example</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">text-indent</span><span class="o">:</span> <span class="m">-9999px</span><span class="p">;</span>
  <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
  <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="err">#</span> <span class="n">for</span> <span class="n">ie</span>
  <span class="k">line-height</span><span class="o">:</span> <span class="m">15px</span><span class="p">;</span> <span class="err">#</span> <span class="n">for</span> <span class="n">ie</span>
  <span class="k">border</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>These styles should be added to the automatically generated css file accroding to user's customization. What customizations I always use are icon, logo, button and bg (abbr. for background).</p>

<p>2. the style for some specified class, e.g. define margin or float for login_button</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span> <span class="p">{</span>
  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">10px</span><span class="p">;</span>
  <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>These styles should be written in the user-defined css file, not the automatically generated css file.</p>

<p>Follow these rules, what you need to do is to put a new image into the css_sprite directory, then use the corresponding class name to display the image on html page. Generating css sprite image and css files are done automatically. Of course when I remove an image from the css_sprite directory, it is also removed from css_sprite image and css.</p>

<p>These are css sprite best practice I follow. Now it's time to see how to implement these in a rails application.</p>

<p>1. Install my css_sprite gem/plugin</p>

<div class="highlight"><pre><code class="bash">sudo gem install css_sprite
</code></pre>
</div>


<p>Or</p>

<div class="highlight"><pre><code class="bash">script/plugin install git://github.com/flyerhzm/css_sprite.git
</code></pre>
</div>


<p>Notice, css_sprite gem depends on the rmagick gem, so please make sure RMagick is successfully installed on your system.</p>

<p>Then add css_sprite gem in the environment.rb or Gemfile</p>

<p>2. Next make a directory whose name is css_sprite or ends with css_sprite (e.g. another_css_sprite) under public/images directory</p>

<p>3. If you install the css_sprite as a gem, you should add css_sprite task in Rakefile</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">&#39;css_sprite&#39;</span>
</code></pre>
</div>


<p>If you install it as a plugin, you can skip this step</p>

<p>4. Let's start the css sprite automation</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:start
</code></pre>
</div>


<p>5. Put the images which need to do the css sprite under the css_sprite directory, then you will see the automatically generated css sprite image and css files. Now you can use the corresponding class name to display image on html. And don't forget include the stylesheet</p>

<div class="highlight"><pre><code class="rhtml"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s1">&#39;css_sprite&#39;</span> <span class="cp">%&gt;</span>
</code></pre>
</div>


<p>Do you feel the you are saved from the dull css sprite job? Here are some additional tasks.</p>

<p>If you want to stop the css sprite automation, run</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:stop
</code></pre>
</div>


<p>If you want to restart the css sprite automation, run</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:restart
</code></pre>
</div>


<p>If you only want to run the css_sprite manually instead of automation, run</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:build
</code></pre>
</div>


<p>These are the default processes without configuration. If you want to use sass or you want to define common styles for some related classes, you need to define config/css_sprite.yml file</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">suffix</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">button</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">text-indent: -9999px;</span>
    <span class="no">display: block;</span>
    <span class="no">cursor: pointer;</span>
    <span class="no">font-size: 0;</span>
    <span class="no">line-height: 15px;</span>
    <span class="no">border: 0;</span>
    <span class="no">outline: 0;</span>
</code></pre>
</div>


<p>The effect of the above configuration file is to generate some common styles for all the images whose filename is button suffixed.</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">engine</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sass</span>
<span class="l-Scalar-Plain">suffix</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">button</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">text-indent: -9999px</span>
    <span class="no">display: block</span>
    <span class="no">cursor: pointer</span>
    <span class="no">font-size: 0</span>
    <span class="no">line-height: 15px</span>
    <span class="no">border: 0</span>
    <span class="no">outline: 0</span>
</code></pre>
</div>


<p>The effect of the above configuration file is to generate a sass file, and generate some common styles for all the images whose filename is button suffixed. Please check the difference of the two configuration files, the content followed button: are copied to the automatically generated css or sass file. So please input the content according to the syntax of css or sass.</p>

<p>Notice, once you changed the configuration file, please make sure stop and start the css_sprite to take effects.</p>

<p>Finally, let's look at the automatically generated css file.</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">text-indent</span><span class="o">:</span> <span class="m">-9999px</span><span class="p">;</span>
  <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
  <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="k">line-height</span><span class="o">:</span> <span class="m">15px</span><span class="p">;</span>
  <span class="k">border</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.twitter_icon</span><span class="o">,</span> <span class="nc">.facebook_icon</span><span class="o">,</span> <span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="sx">url(&#39;/images/css_sprite.png?1270170265&#39;)</span> <span class="k">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.twitter_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">0px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.facebook_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-19px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.login_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-38px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.logout_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-79px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>Don't hesitate to use the css_sprite to speed up your productivity, <a href="http://github.com/flyerhzm/css_sprite">http://github.com/flyerhzm/css_sprite</a></p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Rails" title="Rails" rel="category tag">Rails</a>
      
      <a href="/categories/css" title="css" rel="category tag">css</a>
      
      <a href="/categories/RubyGems" title="RubyGems" rel="category tag">RubyGems</a>
      
    </p>
    <p class="comments-link">
      <a href='/2010/04/03/css-sprite-best-practices-english-version/#disqus_thread'>Comments</a>
    </p>
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="Sat Apr 03 00:00:00 -0700 2010">03 Apr 2010</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2010/04/02/css-sprite-best-practices-chinese-version/" title="css sprite最佳实践" rel="bookmark">css sprite最佳实践</a>
    </h1>
    <div class="entry-content full-content">
      <p><a href="/2010/04/03/css-sprite-best-practices-english-version">css sprite best practices (english version)</a></p>

<p>应用css sprite的好处在于可以大量减少http请求数，从而达到更快加载页面的效果。</p>

<p>但是对于像我这样的懒人，你让我每次都一个一个把图片copy到一个css_sprite图片里，还得量一下这个每个图片对应的x和y坐标，实在是一种折磨。</p>

<p>去年我就写了一个<a href="http://github.com/flyerhzm/css_sprite">css_sprite</a>的插件，但是由于需要在配置文件中定义所有需要组合在一起的图片，用起来还是很麻烦，不够傻瓜化。最近我把css_sprite插件重写了一遍，默认不需要使用配置文件，遵循rails的Convention Over Configuration的思想，可以做到全自动的css sprite操作。</p>

<p>首先，让我们看看目录结构的Convention是如何定义的</p>

<p><img src="http://lh6.ggpht.com/_qSmJ0dW70FE/TGdIAsGI6_I/AAAAAAAAATo/3Xhs9JzvDAQ/css_sprite_preview.png" alt="" /></p>

<p>上图中蓝色部分就是Convention的css sprite目录，也就是在public/images目录下面的css_sprite目录或者以css_sprite结尾的目录（比如another_css_sprite)，需要执行css_sprite操作。</p>

<p>绿色部分则是需要被css sprite的图片，你可以动态的在css sprite目录下面增加或删除图片，css sprite操作就会被自动触发。</p>

<p>而红色部分都是自动生成的，每个对应的css sprite目录，都会生成一个css sprite图片（图片内容为该css sprite目录下的所有图片组合），生成一个css sprite的css文件或者sass文件。</p>

<p>那么生成的css文件是怎么样的呢</p>

<div class="highlight"><pre><code class="css"><span class="nc">.twitter_icon</span><span class="o">,</span> <span class="nc">.facebook_icon</span><span class="o">,</span> <span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="sx">url(&#39;/images/css_sprite.png?1270170265&#39;)</span> <span class="k">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.twitter_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">0px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.facebook_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-19px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.login_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-38px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.logout_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-79px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>也就是说，它生成的css文件遵循如下一个命名规范：<em>一个css sprite目录下的图片对应css里的一个class，图片的名字就是class的名字。</em>这样的好处在于开发人员只需要知道css sprite目录下面有哪些图片，他就可以在html页面上面使用哪些class名字来显示这些图片，而且当css_sprite的算法发生变化的时候也不会对页面显示产生任何影响。</p>

<p>实际使用当中你可能会碰到这样的问题：你除了要使用这些css_sprite生成的class名来显示图片，还需要为它们定义额外的style，而这个可以分为两部分：</p>

<p>1. 一些相关的class有许多共同的style，比如对于button来说，你会把它应用到input或这a上面，一般就需要隐藏input或a标签上面的文字，需要去掉边框等等，所以你需要为这些相关的class生成共同的style，比如</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">text-indent</span><span class="o">:</span> <span class="m">-9999px</span><span class="p">;</span>
  <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
  <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="err">#</span> <span class="n">for</span> <span class="n">ie</span>
  <span class="k">line-height</span><span class="o">:</span> <span class="m">15px</span><span class="p">;</span> <span class="err">#</span> <span class="n">for</span> <span class="n">ie</span>
  <span class="k">border</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>这些style应该根据用户的定制加入到自动生成的css文件中去。</p>

<p>2. 某个具体class应用的style，比如login_button需要定义margin或float</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span> <span class="p">{</span>
  <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">10px</span><span class="p">;</span>
  <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>这些style应该写在用户自己的css文件中，而不应该加入到自动生成的css文件中去。</p>

<p>遵循以上的规则，我需要做的事情就是把一个新的图片扔到css_sprite目录下，然后在页面上使用这个图片对应的class name来显示这个图片，其它的事情（生成css sprite图片和css）都应该是自动完成的，当然当我把一个图片从css_sprite目录下面移除的时候，它也会自动从css_sprite图片和css中移除。听起来很不错吧！</p>

<p>上面就是我定义的css_sprite最佳实践，理论还不错，下面看看在rails项目中是如何使用的？</p>

<p>1. 当然是安装我的css_sprite的gem/plugin</p>

<div class="highlight"><pre><code class="bash">sudo gem install css_sprite
</code></pre>
</div>


<p>或者</p>

<div class="highlight"><pre><code class="bash">script/plugin install git://github.com/flyerhzm/css_sprite.git
</code></pre>
</div>


<p>注意，css_sprite依赖于rmagick gem，所以先请确保RMagick已经在你的系统中成功安装。</p>

<p>然后就是在environment.rb文件或者Gemfile文件中增加css_sprite gem</p>

<p>2. 在public/images目录下面生成css_sprite目录或者以css_sprite结尾的的目录（如：another_css_sprite)</p>

<p>3. 如果你是通过gem安装的css_sprite，那么需要在Rakefile中引用css_sprite的task</p>

<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s1">&#39;css_sprite&#39;</span>
</code></pre>
</div>


<p>如果你是通过plugin安装的，可以跳过这一步</p>

<p>4. 开始css sprite自动化之旅</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:start
</code></pre>
</div>


<p>5. 把需要做css sprite操作的图片都放入css_sprite目录下面，然后你会看到自动生成的css_sprite图片和css文件，现在你就可以在html页面上引用图片对应的class名字来显示图片咯。对了，别忘了引用生成的css文件哦</p>

<div class="highlight"><pre><code class="rhtml"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s1">&#39;css_sprite&#39;</span> <span class="cp">%&gt;</span>
</code></pre>
</div>


<p>是不是感觉从机械的css_sprite工作中解脱出来了呀。下面再介绍些额外的tasks</p>

<p>如果你想结束css_sprite自动化之旅，执行</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:stop
</code></pre>
</div>


<p>如果你想重新开始css_sprite自动化之旅，执行</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:restart
</code></pre>
</div>


<p>如果你不需要css_sprite自动化执行，而只想手动执行css_sprite操作，执行</p>

<div class="highlight"><pre><code class="bash">rake css_sprite:build
</code></pre>
</div>


<p>上面这些流程都是在没有配置的默认情况下完成的，如果你需要使用sass，或者你需要为某些相关的class定义共同的style，只需要定义config/css_sprite.yml配置文件即可</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">suffix</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">button</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">text-indent: -9999px;</span>
    <span class="no">display: block;</span>
    <span class="no">cursor: pointer;</span>
    <span class="no">font-size: 0;</span>
    <span class="no">line-height: 15px;</span>
    <span class="no">border: 0;</span>
    <span class="no">outline: 0;</span>
</code></pre>
</div>


<p>上面这个配置文件的作用是为所有的文件名以button结尾的图片，生成一段共同的style。</p>

<div class="highlight"><pre><code class="yaml"><span class="l-Scalar-Plain">engine</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sass</span>
<span class="l-Scalar-Plain">suffix</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">button</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">text-indent: -9999px</span>
    <span class="no">display: block</span>
    <span class="no">cursor: pointer</span>
    <span class="no">font-size: 0</span>
    <span class="no">line-height: 15px</span>
    <span class="no">border: 0</span>
    <span class="no">outline: 0</span>
</code></pre>
</div>


<p>上面这段配置文件的作用是指定css_sprite自动生成sass文件，同时为所有的文件名以button结尾的图片，生成一段共同的style。注意两段配置文件的不同，button下面的内容都会完整的复制到自动生成的css或sass文件，所以你需要根据css和sass的语法来填入。</p>

<p>注意：当修改了配置文件，需要stop再start css_sprite才能生效。</p>

<p>最后，来我们来看一段自动生成的css文件吧</p>

<div class="highlight"><pre><code class="css"><span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">text-indent</span><span class="o">:</span> <span class="m">-9999px</span><span class="p">;</span>
  <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
  <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="k">line-height</span><span class="o">:</span> <span class="m">15px</span><span class="p">;</span>
  <span class="k">border</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.twitter_icon</span><span class="o">,</span> <span class="nc">.facebook_icon</span><span class="o">,</span> <span class="nc">.login_button</span><span class="o">,</span> <span class="nc">.logout_button</span> <span class="p">{</span>
  <span class="k">background</span><span class="o">:</span> <span class="sx">url(&#39;/images/css_sprite.png?1270170265&#39;)</span> <span class="k">no-repeat</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.twitter_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">0px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.facebook_icon</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-19px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.login_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-38px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.logout_button</span> <span class="p">{</span> <span class="k">background-position</span><span class="o">:</span> <span class="m">0px</span> <span class="m">-79px</span><span class="p">;</span> <span class="k">width</span><span class="o">:</span> <span class="m">103px</span><span class="p">;</span> <span class="k">height</span><span class="o">:</span> <span class="m">36px</span><span class="p">;</span> <span class="p">}</span>
</code></pre>
</div>


<p>还等什么，赶紧来使用css_sprite来加快你的工作效率吧：<a href="http://github.com/flyerhzm/css_sprite">http://github.com/flyerhzm/css_sprite</a></p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Rails" title="Rails" rel="category tag">Rails</a>
      
      <a href="/categories/RubyGems" title="RubyGems" rel="category tag">RubyGems</a>
      
      <a href="/categories/css" title="css" rel="category tag">css</a>
      
    </p>
    <p class="comments-link">
      <a href='/2010/04/02/css-sprite-best-practices-chinese-version/#disqus_thread'>Comments</a>
    </p>
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="Fri Apr 02 00:00:00 -0700 2010">02 Apr 2010</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2010/03/31/manner-similar-to-facebook-connect-verification-twitter-oauth/" title="类似facebook connect的方式验证twitter oauth" rel="bookmark">类似facebook connect的方式验证twitter oauth</a>
    </h1>
    <div class="entry-content full-content">
      <p>最近一个项目需要实现类似与uservoice一样的widget，也就是把一段javascript放到任何的网站上，然后动态生成一个iframe来显示我们网站的内容。但是碰到一个问题，在这个widget内需要允许用户使用twiiter oauth的方式登录，但是twitter oauth认证之后会使用window.top来redirect你的页面，这样会重置我们的widget，这显然是对用户很不友好的。同时，我发现facebook connect的方式可以很好的应用在我们的widget上面，因为它不会重新刷新页面。于是我想能不能用类似与facebook connet的方式，弹出一个页面来做twitter oauth的身份验证呢？显然，这是可行的。</p>

<p>其实很简单的，就是弹出一个页面，在那个页面上做twitter oauth的身份认证，在返回的时候记录session，同时关闭弹出的页面，javascript的代码如下</p>

<div class="highlight"><pre><code class="javascript"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">TwitterConnect</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">TwitterConnect</span> <span class="o">=</span> <span class="p">{};</span>
<span class="p">}</span>
<span class="nx">TwitterConnect</span><span class="p">.</span><span class="nx">Twitter</span> <span class="o">=</span> <span class="k">new</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">setOauthUrl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">oauth_url</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">setCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">startTwitterConnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">popupParams</span> <span class="o">=</span> <span class="s1">&#39;location=0,status=0,width=800,height=400&#39;</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">_twitterWindow</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">oauth_url</span><span class="p">,</span> <span class="s1">&#39;twitterConnectWindow&#39;</span><span class="p">,</span> <span class="nx">popupParams</span><span class="p">);</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">_twitterInterval</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">completeTwitterConnect</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">completeTwitterConnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_twitterWindow</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">clearInterval</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_twitterInterval</span><span class="p">);</span>
      <span class="nb">eval</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">callback</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">_loadTwitterConnect</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span> <span class="o">==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">hasClassName</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;(?:^|\\s)&quot;</span> <span class="o">+</span> <span class="nx">className</span> <span class="o">+</span> <span class="s2">&quot;(?:$|\\s)&quot;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">allElements</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>

      <span class="kd">var</span> <span class="nx">element</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">allElements</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">elementClass</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">elementClass</span> <span class="o">&amp;&amp;</span> <span class="nx">elementClass</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">className</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">hasClassName</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">elementClass</span><span class="p">))</span>
          <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">results</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">oauths</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">&#39;twitter_oauth&#39;</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">oauths</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="nx">oauths</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">oauth</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">TwitterConnect</span><span class="p">.</span><span class="nx">Twitter</span><span class="p">.</span><span class="nx">setOauthUrl</span><span class="p">(</span><span class="nx">oauth</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">));</span>
      <span class="nx">TwitterConnect</span><span class="p">.</span><span class="nx">Twitter</span><span class="p">.</span><span class="nx">setCallback</span><span class="p">(</span><span class="nx">oauth</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;onlogin&#39;</span><span class="p">));</span>
      <span class="nx">TwitterConnect</span><span class="p">.</span><span class="nx">Twitter</span><span class="p">.</span><span class="nx">startTwitterConnect</span><span class="p">();</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">_loadSuper</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="p">;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">!=</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">_loadTwitterConnect</span> <span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">_loadSuper</span><span class="p">();</span> <span class="nx">_loadTwitterConnect</span><span class="p">();</span> <span class="p">};</span>
</code></pre>
</div>


<p>twitter oauth的链接需要这样写</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;twitter_button twitter_oauth&quot;</span> <span class="na">onlogin=</span><span class="s">&quot;window.location.href = &#39;/tweets&#39;&quot;</span> <span class="na">href=</span><span class="s">&quot;/oauth&quot;</span><span class="nt">&gt;</span>Sign in with Twitter<span class="nt">&lt;/a&gt;</span>
</code></pre>
</div>


<p>controller端的代码见<a href="http://www.huangzhimin.com/entries/171-oauth-for-twitter">http://www.huangzhimin.com/entries/171-oauth-for-twitter</a></p>

<p>这段javascript代码的作用是查找所有class为twiiter_oauth的链接，点击这个链接的时候进入oauth action，然后转发到twitter oauth的authorize_url，用户验证通过并返回之后，进入callback action，callback记录用户的session之后，返回一段self.close()的javascript关闭弹出页面，然后再执行twitter oauth链接的onlogin代码，这里的onlogin的跳转到'/tweets'页面。</p>

<p>用户使用起来就和facebook connect很像，所以我给它起名为twitter connect，并且发布到了github上面，项目地址如下：<a href="http://github.com/flyerhzm/twitter_connect">http://github.com/flyerhzm/twitter_connect</a>，用起来很方便的哦。</p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Rails" title="Rails" rel="category tag">Rails</a>
      
      <a href="/categories/Twitter" title="Twitter" rel="category tag">Twitter</a>
      
      <a href="/categories/javascript" title="javascript" rel="category tag">javascript</a>
      
    </p>
    <p class="comments-link">
      <a href='/2010/03/31/manner-similar-to-facebook-connect-verification-twitter-oauth/#disqus_thread'>Comments</a>
    </p>
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="Wed Mar 31 00:00:00 -0700 2010">31 Mar 2010</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>

  <div class="full">
    <h1 class="entry-title">
      <a href="/2010/03/24/pdf-generated-using-the-princely/" title="使用princely生成pdf" rel="bookmark">使用princely生成pdf</a>
    </h1>
    <div class="entry-content full-content">
      <p>Prince是一个将html和xml转换为pdf的程序，最突出的特点是prince能够根据css来格式化转换之后的pdf，这实在是太适合web程序员了。princely是一个基于prince的rails插件，使用起来也非常方便。</p>

<p>首先，下载<a href="http://www.princexml.com/download/">prince</a>并按照文档进行安装。</p>

<p>其次，安装princely</p>

<div class="highlight"><pre><code class="bash">sudo gem install princely
</code></pre>
</div>


<p>接着就是在rails项目中生成pdf并供用户下载。定义一个名字叫download的action</p>

<div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">download</span>
  <span class="c1"># any logic</span>

  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
    <span class="nb">format</span><span class="o">.</span><span class="n">html</span>
    <span class="nb">format</span><span class="o">.</span><span class="n">pdf</span> <span class="k">do</span>
      <span class="n">render</span> <span class="ss">:pdf</span> <span class="o">=&gt;</span> <span class="s2">&quot;pdf_file_name&quot;</span><span class="p">,</span>
             <span class="ss">:stylesheets</span> <span class="o">=&gt;</span> <span class="s2">&quot;pdf_css&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


<p>然后就是定义download.pdf.erb文件，它就和平时定义html.erb是一样的，样式由pdf_css.css决定。</p>

<p>这样，当用户点击一个链接进入这个download action，服务器就会在后台生成pdf，并发送response给用户，用户的浏览器就弹出下载的对话框。很简单吧</p>

      <div class="clear"></div>
    </div>
    <p class="alt-font tight">
      Posted in&nbsp;
      
      <a href="/categories/Rails" title="Rails" rel="category tag">Rails</a>
      
      <a href="/categories/Ruby" title="Ruby" rel="category tag">Ruby</a>
      
    </p>
    <p class="comments-link">
      <a href='/2010/03/24/pdf-generated-using-the-princely/#disqus_thread'>Comments</a>
    </p>
    <p class="by-line">
      <span class="date full-date">
        <abbr class="published" title="Wed Mar 24 00:00:00 -0700 2010">24 Mar 2010</abbr>
      </span>
    </p>
    <div class="clear"></div>
  </div>
  <div class="rule"><hr/></div>


<div class="pagination">
  <span class="previous">
    
      
      <a href="/page6/" title="Previous Page">&laquo; Previous</a>
      
    
  </span>
  <span class="next">
    
    <a href="/page8/" title="Next Page">Next &raquo;</a>
    
  </span>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=flyerhzm"></script>

        </div>
        <div id="sidebar">
          <div id="carrington-subscribe" class="widget">
            <h2 class="widget-title">Subscribe</h2>
            <a class="feed alignright" title="RSS 2.0 feed for posts" rel="alternate" href="http://feeds.feedburner.com/richard-huang">
              <img src="/images/rss-button.gif" alt="latest posts" title="latest posts">
            </a>
          </div>
          <div id="carrington-about" class="widget">
            <div class="about">
              <h2 class="widget-title">About</h2>
              <p>My name is Richard Huang, a Rubyist and open source advocate.</p>
              <a class="more" href="/about.html">more →</a>
            </div>
          </div>
          <div id="carrington-speaker" class="widget">
            <img src="/images/160x160speaker.png">
          </div>
          <div id="primary-sidebar">
            <div class="widget">
              <h2 class="widget-title">Categories</h2>
              <ul>
                
                <li><a href="/categories/jekyll">jekyll (1)</a></li>
                
                <li><a href="/categories/mongodb">mongodb (2)</a></li>
                
                <li><a href="/categories/GAE">GAE (1)</a></li>
                
                <li><a href="/categories/Linux">Linux (4)</a></li>
                
                <li><a href="/categories/html">html (2)</a></li>
                
                <li><a href="/categories/Java Web">Java Web (3)</a></li>
                
                <li><a href="/categories/Resque">Resque (1)</a></li>
                
                <li><a href="/categories/Rack">Rack (1)</a></li>
                
                <li><a href="/categories/RubyGems">RubyGems (7)</a></li>
                
                <li><a href="/categories/rake">rake (1)</a></li>
                
                <li><a href="/categories/php">php (2)</a></li>
                
                <li><a href="/categories/disqus">disqus (1)</a></li>
                
                <li><a href="/categories/Less">Less (1)</a></li>
                
                <li><a href="/categories/ActiveRecord">ActiveRecord (5)</a></li>
                
                <li><a href="/categories/Rails">Rails (35)</a></li>
                
                <li><a href="/categories/css">css (9)</a></li>
                
                <li><a href="/categories/sql">sql (1)</a></li>
                
                <li><a href="/categories/maven">maven (1)</a></li>
                
                <li><a href="/categories/Vim">Vim (1)</a></li>
                
                <li><a href="/categories/Ruby">Ruby (33)</a></li>
                
                <li><a href="/categories/Presentation">Presentation (7)</a></li>
                
                <li><a href="/categories/contact-list">contact-list (6)</a></li>
                
                <li><a href="/categories/Java">Java (9)</a></li>
                
                <li><a href="/categories/Github">Github (1)</a></li>
                
                <li><a href="/categories/flex">flex (4)</a></li>
                
                <li><a href="/categories/Rails Plugins">Rails Plugins (12)</a></li>
                
                <li><a href="/categories/passenger">passenger (1)</a></li>
                
                <li><a href="/categories/Sinatra">Sinatra (1)</a></li>
                
                <li><a href="/categories/Nginx">Nginx (2)</a></li>
                
                <li><a href="/categories/Facebook">Facebook (2)</a></li>
                
                <li><a href="/categories/Android">Android (2)</a></li>
                
                <li><a href="/categories/Rspec">Rspec (3)</a></li>
                
                <li><a href="/categories/javascript">javascript (4)</a></li>
                
                <li><a href="/categories/Life">Life (19)</a></li>
                
                <li><a href="/categories/git">git (1)</a></li>
                
                <li><a href="/categories/Seo">Seo (1)</a></li>
                
                <li><a href="/categories/Git">Git (4)</a></li>
                
                <li><a href="/categories/Ldap">Ldap (1)</a></li>
                
                <li><a href="/categories/mongoid">mongoid (7)</a></li>
                
                <li><a href="/categories/webrick">webrick (3)</a></li>
                
                <li><a href="/categories/msn">msn (1)</a></li>
                
                <li><a href="/categories/Capistrano">Capistrano (3)</a></li>
                
                <li><a href="/categories/redis">redis (1)</a></li>
                
                <li><a href="/categories/uml">uml (1)</a></li>
                
                <li><a href="/categories/Hostmonster">Hostmonster (5)</a></li>
                
                <li><a href="/categories/jquery">jquery (1)</a></li>
                
                <li><a href="/categories/Twitter">Twitter (2)</a></li>
                
                <li><a href="/categories/HTTP">HTTP (4)</a></li>
                
              </ul>
            </div>
          </div>
          <div id="secondary-sidebar">
            <div class="widget">
              <h2 class="widget-title">Recent Posts</h2>
              <ul>
                
                <li>
                  <a href="/2011/12/13/rake-arguments/" title="rake arguments" rel="bookmark">rake arguments</a>
                </li>
                
                <li>
                  <a href="/2011/12/12/passenger-with-redis/" title="passenger with redis" rel="bookmark">passenger with redis</a>
                </li>
                
                <li>
                  <a href="/2011/11/14/avoid-committing-git-conflicts/" title="avoid committing git conflicts" rel="bookmark">avoid committing git conflicts</a>
                </li>
                
                <li>
                  <a href="/2011/11/06/after_commit/" title="after_commit" rel="bookmark">after_commit</a>
                </li>
                
                <li>
                  <a href="/2011/10/31/reset_counter-in-rails/" title="reset_counter in rails" rel="bookmark">reset_counter in rails</a>
                </li>
                
                <li>
                  <a href="/2011/10/21/rspec-filter/" title="use rspec filter to speed up tests" rel="bookmark">use rspec filter to speed up tests</a>
                </li>
                
                <li>
                  <a href="/2011/07/17/rubykaigi-presentation/" title="rubykaigi presentation" rel="bookmark">rubykaigi presentation</a>
                </li>
                
                <li>
                  <a href="/2011/03/27/beijing-ruby-event/" title="beijing ruby线下活动" rel="bookmark">beijing ruby线下活动</a>
                </li>
                
                <li>
                  <a href="/2011/03/22/upgrade-mongoid-multiple-database/" title="Upgrade Mongoid - Multiple databases" rel="bookmark">Upgrade Mongoid - Multiple databases</a>
                </li>
                
                <li>
                  <a href="/2011/03/21/upgrade-mongoid-update_attribute/" title="Upgrade Mongoid - update_attribute" rel="bookmark">Upgrade Mongoid - update_attribute</a>
                </li>
                
              </ul>
              <div class="clear"></div>
            </div>
            <div class="widget">
              <h2 class="widget-title">Archives</h2>
              <ul>
                
                <li>
                  <a href="/2011/12">December 2011</a> (2 posts)
                </li>
                
                <li>
                  <a href="/2011/11">November 2011</a> (2 posts)
                </li>
                
                <li>
                  <a href="/2011/10">October 2011</a> (2 posts)
                </li>
                
                <li>
                  <a href="/2011/07">July 2011</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2011/03">March 2011</a> (5 posts)
                </li>
                
                <li>
                  <a href="/2011/01">January 2011</a> (6 posts)
                </li>
                
                <li>
                  <a href="/2010/12">December 2010</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2010/08">August 2010</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2010/07">July 2010</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2010/06">June 2010</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2010/05">May 2010</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2010/04">April 2010</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2010/03">March 2010</a> (6 posts)
                </li>
                
                <li>
                  <a href="/2010/02">February 2010</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2010/01">January 2010</a> (5 posts)
                </li>
                
                <li>
                  <a href="/2009/12">December 2009</a> (7 posts)
                </li>
                
                <li>
                  <a href="/2009/11">November 2009</a> (5 posts)
                </li>
                
                <li>
                  <a href="/2009/10">October 2009</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2009/09">September 2009</a> (11 posts)
                </li>
                
                <li>
                  <a href="/2009/08">August 2009</a> (13 posts)
                </li>
                
                <li>
                  <a href="/2009/07">July 2009</a> (8 posts)
                </li>
                
                <li>
                  <a href="/2009/06">June 2009</a> (9 posts)
                </li>
                
                <li>
                  <a href="/2009/05">May 2009</a> (7 posts)
                </li>
                
                <li>
                  <a href="/2009/04">April 2009</a> (7 posts)
                </li>
                
                <li>
                  <a href="/2009/01">January 2009</a> (2 posts)
                </li>
                
                <li>
                  <a href="/2008/12">December 2008</a> (3 posts)
                </li>
                
                <li>
                  <a href="/2008/11">November 2008</a> (4 posts)
                </li>
                
                <li>
                  <a href="/2008/08">August 2008</a> (5 posts)
                </li>
                
                <li>
                  <a href="/2008/07">July 2008</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2008/06">June 2008</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2008/04">April 2008</a> (1 posts)
                </li>
                
                <li>
                  <a href="/2008/03">March 2008</a> (6 posts)
                </li>
                
                <li>
                  <a href="/2008/02">February 2008</a> (2 posts)
                </li>
                
              </ul>
              <div class="clear"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="footer" class="section">
      <div class="wrapper">
        <a id="generator-link">
          Proudly powered by
          <a href="https://github.com/mojombo/jekyll" rel="generator">Jekyll</a>
          and
          <a href="http://carringtontheme.com" title="Carrington theme for WordPress">Carrington</a>
      </div>
      <div id="developer-link">
      </div>
    </div>
    <a href="http://github.com/flyerhzm"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://assets2.github.com/img/e6bef7a091f5f3138b8cd40bc3e114258dd68ddf?repo=&url=http%3A%2F%2Fs3.amazonaws.com%2Fgithub%2Fribbons%2Fforkme_right_red_aa0000.png&path=" alt="Fork me on GitHub"></a>
    <script type="text/javascript">
      var disqus_shortname = 'richard-huang';

      (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
      }());
    </script>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-8561975-1");
        pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
